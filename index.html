<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²Œì„ ê¸°íšì í¬íŠ¸í´ë¦¬ì˜¤</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* ë©”ì¸ ë ˆì´ì•„ì›ƒ ìƒ‰ìƒ */
            --bg-profile: #F5F1E9;
            --bg-main: #FAF9F6;
            --bg-history: #EDF0F2;
            
            --bg-card: #ffffff;
            --bg-section: #fafafa;
            
            /* íŒŒìŠ¤í…” ìƒ‰ìƒ */
            --pastel-gold: #e8d5a3;
            --pastel-gold-light: #f5e6c3;
            --pastel-gold-dark: #c9a86c;
            --pastel-blue: #a8c5e2;
            --pastel-blue-light: #c5daef;
            --pastel-blue-dark: #7ba3c9;
            --pastel-red: #e8a8a8;
            --pastel-red-light: #f2c5c5;
            --pastel-red-dark: #c98a8a;
            --pastel-green: #a8d8b4;
            --pastel-green-light: #c5e8ce;
            --pastel-green-dark: #7cb88e;
            --pastel-purple: #c5a8d8;
            --pastel-purple-light: #dac5e8;
            --pastel-purple-dark: #a87bc2;
            --pastel-pink: #e8b8c8;
            --pastel-mint: #a8d8d8;
            
            /* í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
            --text-dark: #4a4a4a;
            --text-mid: #6a6a6a;
            --text-light: #9a9a9a;
            
            /* êµ¬ë¶„ì„  ìƒ‰ìƒ */
            --border-light: #e8e8e8;
            --border-mid: #d0d0d0;
            --border-dark: #3a3a3a;
            --section-divider: #2a2a2a;
            
            --shadow-soft: rgba(0, 0, 0, 0.06);
            --shadow-mid: rgba(0, 0, 0, 0.1);
            
            /* ë ˆì´ì•„ì›ƒ í¬ê¸° */
            --profile-width: 280px;
            --history-width: 260px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: var(--bg-main);
            height: 100vh;
            color: var(--text-dark);
            line-height: 1.6;
            overflow: hidden;
        }

        /* ============ ìƒë‹¨ ë°” ============ */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 50px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: flex-end;
            align-items: center;
            padding: 0 24px;
            z-index: 100;
            box-shadow: 0 2px 10px var(--shadow-soft);
        }

        .login-btn, .logout-btn, .settings-btn {
            padding: 8px 18px;
            border: 1px solid var(--border-light);
            border-radius: 20px;
            background: var(--bg-section);
            color: var(--text-mid);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            margin-left: 10px;
        }

        .login-btn:hover, .settings-btn:hover { 
            border-color: var(--pastel-gold); 
            background: var(--pastel-gold-light); 
        }

        .logout-btn:hover { 
            border-color: var(--pastel-red); 
            background: var(--pastel-red-light); 
        }

        .logged-in-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--pastel-green-dark);
            font-size: 0.85rem;
            margin-right: 10px;
        }

        .logged-in-indicator::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--pastel-green);
            border-radius: 50%;
        }

        .site-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--pastel-gold-dark);
            margin-right: auto;
            cursor: default;
            letter-spacing: 1px;
        }

        .site-title:hover {
            opacity: 0.8;
        }

        /* ============ ë©”ì¸ ë ˆì´ì•„ì›ƒ (3ë‹¨) ============ */
        .main-layout {
            display: flex;
            height: calc(100vh - 50px);
            margin-top: 50px;
        }

        /* ============ ì¢Œì¸¡ í”„ë¡œí•„ íŒ¨ë„ ============ */
        .profile-panel {
            width: var(--profile-width);
            min-width: var(--profile-width);
            background: var(--bg-profile);
            border-right: 1px solid var(--border-light);
            overflow-y: auto;
            padding: 24px 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .profile-image-container {
            width: 140px;
            height: 140px;
            margin: 0 auto;
            border-radius: 50%;
            overflow: hidden;
            background: var(--bg-card);
            border: 4px solid var(--pastel-gold-light);
            box-shadow: 0 4px 15px var(--shadow-mid);
            position: relative;
            cursor: default;
        }

        .profile-image-container.editable {
            cursor: pointer;
        }

        .profile-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .profile-emoji {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 4rem;
            background: linear-gradient(135deg, var(--pastel-gold-light), var(--pastel-gold));
        }

        .profile-edit-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0,0,0,0.6);
            color: white;
            text-align: center;
            padding: 8px;
            font-size: 0.75rem;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .profile-image-container.editable:hover .profile-edit-overlay {
            opacity: 1;
        }

        .profile-info {
            text-align: center;
        }

        .profile-name {
            font-family: 'Cinzel', serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--pastel-gold-dark);
            margin-bottom: 4px;
        }

        .profile-role {
            font-size: 0.9rem;
            color: var(--text-mid);
            letter-spacing: 1px;
        }

        .profile-divider {
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--border-mid), transparent);
            margin: 10px 0;
        }

        .profile-section {
            background: rgba(255,255,255,0.5);
            border-radius: 12px;
            padding: 16px;
        }

        .profile-section-title {
            font-size: 0.75rem;
            font-weight: 600;
            color: var(--text-light);
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .profile-item {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            padding: 8px 0;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            font-size: 0.85rem;
        }

        .profile-item:last-child {
            border-bottom: none;
        }

        .profile-item-icon {
            font-size: 1rem;
            width: 24px;
            text-align: center;
            flex-shrink: 0;
        }

        .profile-item-content {
            flex: 1;
        }

        .profile-item-label {
            font-size: 0.7rem;
            color: var(--text-light);
            margin-bottom: 2px;
        }

        .profile-item-value {
            color: var(--text-dark);
            word-break: break-all;
        }

        .profile-item-value a {
            color: var(--pastel-blue-dark);
            text-decoration: none;
        }

        .profile-item-value a:hover {
            text-decoration: underline;
        }

        .contact-editable {
            position: relative;
            cursor: default;
            transition: background 0.2s;
            border-radius: 8px;
            margin: 0 -8px;
            padding: 8px !important;
        }

        .contact-editable:hover {
            background: rgba(255,255,255,0.8);
        }

        .contact-edit-icon {
            display: none;
            font-size: 0.8rem;
            opacity: 0.5;
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
        }

        .contact-editable:hover .contact-edit-icon {
            display: block;
        }

        .contact-add-btn {
            width: 100%;
            margin-top: 10px;
            padding: 8px 12px;
            font-size: 0.8rem;
            background: rgba(255,255,255,0.5);
            border: 1px dashed var(--border-mid);
            border-radius: 8px;
            color: var(--text-mid);
            cursor: pointer;
            transition: all 0.2s;
        }

        .contact-add-btn:hover {
            background: rgba(255,255,255,0.8);
            border-color: var(--pastel-gold);
            color: var(--text-dark);
        }

        .contact-delete-btn {
            position: absolute;
            right: 28px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
            font-size: 0.8rem;
            opacity: 0.5;
            cursor: pointer;
        }

        .contact-editable:hover .contact-delete-btn {
            display: block;
        }

        .contact-delete-btn:hover {
            opacity: 1;
            color: var(--pastel-red-dark);
        }

        .icon-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px;
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            margin-top: 8px;
        }

        .icon-option {
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .icon-option:hover {
            background: var(--pastel-gold-light);
        }

        .icon-option.selected {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .intro-text-box {
            background: rgba(255,255,255,0.7);
            border-radius: 12px;
            padding: 16px;
            font-size: 0.85rem;
            color: var(--text-mid);
            line-height: 1.7;
            cursor: default;
            position: relative;
        }

        .intro-text-box.editable {
            cursor: pointer;
        }

        .intro-text-box.editable:hover {
            background: rgba(255,255,255,0.9);
        }

        .intro-edit-hint {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.75rem;
            opacity: 0;
            transition: opacity 0.2s;
            pointer-events: none;
        }

        .intro-text-box.editable:hover .intro-edit-hint {
            opacity: 1;
        }

        .profile-edit-btn {
            width: 100%;
            padding: 12px;
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            color: var(--text-mid);
            display: none;
            transition: all 0.2s;
        }

        .profile-edit-btn.show {
            display: block;
        }

        .profile-edit-btn:hover {
            background: var(--pastel-gold-light);
            border-color: var(--pastel-gold);
        }

        /* ============ ì¤‘ì•™ ë©”ì¸ ì»¨í…ì¸  ============ */
        .main-content {
            flex: 1;
            background: var(--bg-main);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* ì„¹ì…˜ ë„¤ë¹„ê²Œì´ì…˜ ë°” */
        .section-nav {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 24px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-light);
            overflow-x: auto;
            flex-shrink: 0;
        }

        .section-nav::-webkit-scrollbar {
            height: 4px;
        }

        .section-nav::-webkit-scrollbar-thumb {
            background: var(--border-mid);
            border-radius: 2px;
        }

        .section-nav-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-light);
            border-radius: 20px;
            background: var(--bg-section);
            color: var(--text-mid);
            font-size: 0.8rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .section-nav-btn:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .section-nav-btn.active {
            background: linear-gradient(135deg, var(--pastel-gold), var(--pastel-gold-light));
            border-color: var(--pastel-gold-dark);
            color: var(--text-dark);
            font-weight: 600;
        }

        .section-nav-count {
            background: rgba(0,0,0,0.1);
            padding: 2px 6px;
            border-radius: 8px;
            font-size: 0.7rem;
        }

        /* ì„¹ì…˜ ì»¨í…Œì´ë„ˆ */
        .sections-container {
            flex: 1;
            overflow-y: auto;
            padding: 24px;
        }

        .section {
            margin-bottom: 32px;
            padding-bottom: 32px;
            border-bottom: 3px solid var(--section-divider);
        }

        .section:last-child {
            border-bottom: none;
        }

        .section-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 20px;
        }

        .section-drag-handle {
            width: 32px;
            height: 32px;
            border-radius: 6px;
            background: var(--bg-section);
            border: 1px solid var(--border-light);
            cursor: grab;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            color: var(--text-mid);
            transition: all 0.2s;
        }

        .section-drag-handle:active { cursor: grabbing; }
        .section-drag-handle.show { display: flex; }
        .section-drag-handle:hover { 
            background: var(--pastel-blue-light); 
            border-color: var(--pastel-blue);
        }

        .section-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.3rem;
            flex-shrink: 0;
        }

        .section-icon.blue { background: linear-gradient(135deg, var(--pastel-blue-light), var(--pastel-blue)); }
        .section-icon.green { background: linear-gradient(135deg, var(--pastel-green-light), var(--pastel-green)); }
        .section-icon.purple { background: linear-gradient(135deg, var(--pastel-purple-light), var(--pastel-purple)); }
        .section-icon.pink { background: linear-gradient(135deg, var(--pastel-pink), var(--pastel-pink)); }
        .section-icon.gold { background: linear-gradient(135deg, var(--pastel-gold-light), var(--pastel-gold)); }
        .section-icon.mint { background: linear-gradient(135deg, var(--pastel-mint), var(--pastel-mint)); }

        .section-info {
            flex: 1;
        }

        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .section-title .count {
            font-size: 0.9rem;
            color: var(--text-light);
            font-weight: 400;
        }

        .section-subtitle {
            font-size: 0.8rem;
            color: var(--text-light);
            margin-top: 2px;
        }

        .section-edit-btn {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--bg-section);
            border: 1px solid var(--border-light);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            color: var(--text-mid);
            transition: all 0.2s;
        }

        .section-edit-btn.show { display: flex; }
        .section-edit-btn:hover { background: var(--pastel-gold-light); border-color: var(--pastel-gold); }

        /* ê°€ë¡œ ìŠ¤í¬ë¡¤ ê·¸ë¦¬ë“œ */
        .portfolio-scroll-container {
            overflow-x: auto;
            overflow-y: hidden;
            padding-bottom: 12px;
        }

        .portfolio-scroll-container::-webkit-scrollbar {
            height: 8px;
        }

        .portfolio-scroll-container::-webkit-scrollbar-track {
            background: var(--bg-section);
            border-radius: 4px;
        }

        .portfolio-scroll-container::-webkit-scrollbar-thumb {
            background: var(--border-mid);
            border-radius: 4px;
        }

        .portfolio-scroll-container::-webkit-scrollbar-thumb:hover {
            background: var(--text-light);
        }

        .portfolio-grid {
            display: flex;
            gap: 16px;
            min-width: min-content;
        }

        /* ê¸°ë³¸ ì¹´ë“œ í¬ê¸° */
        .portfolio-grid .portfolio-card {
            width: 300px;
            min-width: 300px;
        }

        .portfolio-grid .add-card {
            width: 300px;
            min-width: 300px;
        }

        /* ë‹¨ì¼ ì„¹ì…˜ ëª¨ë“œ (ì„¹ì…˜ í•˜ë‚˜ë§Œ í‘œì‹œí•  ë•Œ) */
        .single-section-mode .portfolio-scroll-container {
            overflow: visible;
            padding-bottom: 0;
        }

        .single-section-mode .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            width: 100%;
        }

        .single-section-mode .portfolio-grid .portfolio-card,
        .single-section-mode .portfolio-grid .add-card {
            width: 100%;
            min-width: 0;
        }

        .single-section-mode .card-thumbnail {
            height: 180px;
        }

        .single-section-mode .card-body {
            padding: 20px;
        }

        .single-section-mode .card-title {
            font-size: 1.1rem;
        }

        /* ì¶”ê°€ ì¹´ë“œ */
        .add-card {
            background: var(--bg-card);
            border: 2px dashed var(--border-light);
            border-radius: 14px;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 200px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-light);
            flex-shrink: 0;
        }

        .add-card.show { display: flex; }

        .add-card:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
            color: var(--text-dark);
        }

        .add-card-icon {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--bg-section);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.6rem;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .add-card:hover .add-card-icon {
            background: var(--pastel-gold);
            transform: scale(1.1);
        }

        .add-card-text { font-size: 0.85rem; font-weight: 500; }

        /* í¬íŠ¸í´ë¦¬ì˜¤ ì¹´ë“œ */
        .portfolio-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 14px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
            flex-shrink: 0;
        }

        .portfolio-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 30px var(--shadow-mid);
            border-color: var(--pastel-gold);
        }

        .card-link {
            text-decoration: none;
            color: inherit;
            display: block;
            cursor: pointer;
        }

        .card-thumbnail {
            width: 100%;
            height: 140px;
            overflow: hidden;
            background: linear-gradient(135deg, var(--pastel-gold-light) 0%, var(--pastel-blue-light) 100%);
            position: relative;
        }

        .card-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s;
        }

        .portfolio-card:hover .card-thumbnail img {
            transform: scale(1.05);
        }

        .card-thumbnail-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            opacity: 0.5;
        }

        .card-body {
            padding: 16px;
        }

        .card-date {
            font-size: 0.75rem;
            color: var(--text-light);
            margin-bottom: 6px;
        }

        .card-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .portfolio-grid[data-view="1"] .card-title {
            margin-bottom: 0;
        }

        .card-desc {
            font-size: 0.8rem;
            color: var(--text-mid);
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .portfolio-grid[data-view="1"] .card-desc {
            display: none;
        }

        .card-tags {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
        }

        .portfolio-grid[data-view="1"] .card-tags {
            display: none;
        }

        .card-tag {
            padding: 3px 8px;
            background: var(--bg-section);
            border-radius: 10px;
            font-size: 0.7rem;
            color: var(--text-mid);
        }

        .card-file-type {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 10px;
            background: rgba(255,255,255,0.9);
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            color: var(--text-mid);
        }

        /* ì¹´ë“œ í¸ì§‘ ë²„íŠ¼ */
        .card-edit-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            border: none;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            z-index: 5;
            transition: all 0.2s;
        }

        .card-edit-btn.show { display: flex; }
        .card-edit-btn:hover { background: var(--pastel-gold); }

        /* ì¹´ë“œ ì•¡ì…˜ ë²„íŠ¼ (ì‹¤í–‰, ë‹¤ìš´ë¡œë“œ) */
        .card-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .card-action-btn {
            flex: 1;
            padding: 8px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 4px;
        }

        .card-action-btn.primary {
            background: var(--pastel-blue);
            color: var(--pastel-blue-dark);
        }

        .card-action-btn.primary:hover {
            background: var(--pastel-blue-dark);
            color: white;
        }

        .card-action-btn.secondary {
            background: var(--bg-profile);
            color: var(--text-mid);
            border: 1px solid var(--border-light);
        }

        .card-action-btn.secondary:hover {
            background: var(--pastel-gold-light);
            border-color: var(--pastel-gold);
            color: var(--pastel-gold-dark);
        }

        /* ë“œë˜ê·¸ í•¸ë“¤ */
        .drag-handle {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 28px;
            height: 28px;
            border-radius: 6px;
            background: rgba(255,255,255,0.9);
            border: 1px solid var(--border-light);
            cursor: grab;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            z-index: 5;
        }

        .drag-handle:active { cursor: grabbing; }
        .drag-handle.show { display: flex; }

        /* ì„¹ì…˜ ì¶”ê°€ ë²„íŠ¼ */
        .add-section-btn {
            display: none;
            margin: 20px auto;
            padding: 14px 28px;
            background: var(--bg-card);
            border: 2px dashed var(--border-light);
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            color: var(--text-light);
            font-size: 0.9rem;
            transition: all 0.2s;
            max-width: 280px;
        }

        .add-section-btn.show { display: block; }

        .add-section-btn:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
            color: var(--text-dark);
        }

        /* ============ ìš°ì¸¡ íˆìŠ¤í† ë¦¬ íŒ¨ë„ ============ */
        .history-panel {
            width: var(--history-width);
            min-width: var(--history-width);
            background: var(--bg-history);
            border-left: 1px solid var(--border-light);
            display: flex;
            flex-direction: column;
        }

        .history-header {
            padding: 16px;
            background: rgba(255,255,255,0.5);
            border-bottom: 1px solid var(--border-light);
        }

        .history-title {
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .history-list {
            flex: 1;
            overflow-y: auto;
            padding: 12px;
        }

        .history-list::-webkit-scrollbar {
            width: 6px;
        }

        .history-list::-webkit-scrollbar-thumb {
            background: var(--border-mid);
            border-radius: 3px;
        }

        .history-item {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 10px;
            padding: 12px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .history-item:hover {
            border-color: var(--pastel-blue);
            transform: translateX(-4px);
            box-shadow: 2px 2px 10px var(--shadow-soft);
        }

        .history-item-title {
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-dark);
            margin-bottom: 6px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .history-item-meta {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.7rem;
            color: var(--text-light);
        }

        .history-item-type {
            padding: 2px 6px;
            background: var(--bg-section);
            border-radius: 4px;
        }

        .history-empty {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-light);
            font-size: 0.85rem;
        }

        .history-empty-icon {
            font-size: 2rem;
            margin-bottom: 10px;
            opacity: 0.5;
        }

        /* ============ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ ============ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.active { display: flex; }

        .modal {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 28px;
            max-width: 480px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .modal-title {
            font-family: 'Cinzel', serif;
            font-size: 1.3rem;
            color: var(--pastel-gold-dark);
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group { margin-bottom: 18px; }

        .form-label {
            display: block;
            font-size: 0.8rem;
            color: var(--text-mid);
            margin-bottom: 6px;
            font-weight: 500;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 10px 14px;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            background: var(--bg-section);
            color: var(--text-dark);
            transition: all 0.2s;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--pastel-gold);
            background: var(--bg-card);
        }

        .form-textarea { min-height: 90px; resize: vertical; }

        .form-btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 8px;
        }

        .form-btn.primary {
            background: linear-gradient(135deg, var(--pastel-gold), var(--pastel-gold-light));
            color: var(--text-dark);
        }

        .form-btn.primary:hover { box-shadow: 0 4px 15px rgba(232, 213, 163, 0.4); }
        .form-btn.primary:disabled { opacity: 0.6; cursor: not-allowed; }

        .form-btn.secondary {
            background: var(--bg-section);
            border: 1px solid var(--border-light);
            color: var(--text-mid);
        }

        .form-btn.danger {
            background: linear-gradient(135deg, var(--pastel-red), var(--pastel-red-light));
            color: var(--text-dark);
        }

        .form-error {
            color: var(--pastel-red-dark);
            font-size: 0.75rem;
            margin-top: 8px;
            display: none;
        }

        .form-error.show { display: block; }

        /* íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ */
        .file-upload-area {
            border: 2px dashed var(--border-light);
            border-radius: 10px;
            padding: 24px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .file-upload-area:hover, .file-upload-area.dragover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .file-upload-icon { font-size: 2rem; margin-bottom: 8px; }
        .file-upload-text { font-size: 0.85rem; color: var(--text-mid); }
        .file-upload-hint { font-size: 0.75rem; color: var(--text-light); margin-top: 4px; }

        .file-preview {
            display: none;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-section);
            border-radius: 8px;
            margin-top: 10px;
        }

        .file-preview.show { display: flex; }

        .file-preview-icon { font-size: 1.5rem; }
        .file-preview-info { flex: 1; min-width: 0; }
        .file-preview-name { 
            font-size: 0.85rem; 
            color: var(--text-dark);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .file-preview-size { font-size: 0.75rem; color: var(--text-light); }
        .file-preview-remove {
            width: 24px; height: 24px;
            border-radius: 50%;
            background: var(--pastel-red-light);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: var(--pastel-red-dark);
        }

        /* ì¸ë„¤ì¼ ì—…ë¡œë“œ */
        .thumbnail-upload-area {
            width: 100%;
            height: 120px;
            border: 2px dashed var(--border-light);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .thumbnail-upload-area:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .thumbnail-upload-area.dragover {
            border-color: var(--pastel-blue);
            background: var(--pastel-blue-light);
            border-style: solid;
        }

        .thumbnail-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            color: var(--text-light);
            font-size: 0.8rem;
        }

        .thumbnail-placeholder span:first-child { font-size: 1.5rem; }

        .thumbnail-preview-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .thumbnail-remove-btn {
            position: absolute;
            top: 6px;
            right: 6px;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--pastel-red);
            border: none;
            cursor: pointer;
            font-size: 1rem;
            color: white;
            z-index: 5;
        }

        /* í”„ë¡œí•„ ì—…ë¡œë“œ ì˜ì—­ */
        .profile-upload-area {
            width: 140px;
            height: 140px;
            margin: 0 auto;
            border: 2px dashed var(--border-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }

        .profile-upload-area:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .profile-preview-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* ìƒ‰ìƒ ì„ íƒê¸° */
        .color-picker {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .color-option { cursor: pointer; }
        .color-option input { display: none; }

        .color-swatch {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: block;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .color-option input:checked + .color-swatch {
            border-color: var(--text-dark);
            transform: scale(1.1);
        }

        .color-swatch.blue { background: linear-gradient(135deg, var(--pastel-blue-light), var(--pastel-blue)); }
        .color-swatch.green { background: linear-gradient(135deg, var(--pastel-green-light), var(--pastel-green)); }
        .color-swatch.purple { background: linear-gradient(135deg, var(--pastel-purple-light), var(--pastel-purple)); }
        .color-swatch.pink { background: linear-gradient(135deg, var(--pastel-pink), var(--pastel-pink)); }
        .color-swatch.gold { background: linear-gradient(135deg, var(--pastel-gold-light), var(--pastel-gold)); }
        .color-swatch.mint { background: linear-gradient(135deg, var(--pastel-mint), var(--pastel-mint)); }

        /* ìƒ‰ìƒ íŒ”ë ˆíŠ¸ */
        .color-picker-group { margin-top: 8px; }

        .color-palette {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }

        .color-palette-item {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .color-palette-item:hover, .color-palette-item.active {
            border-color: var(--text-dark);
            transform: scale(1.1);
        }

        .color-input-row {
            display: flex;
            gap: 8px;
        }

        .color-input-row input[type="color"] {
            width: 40px;
            height: 32px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            cursor: pointer;
        }

        .color-input-row input[type="text"] {
            flex: 1;
            padding: 6px 10px;
            border: 1px solid var(--border-light);
            border-radius: 6px;
            font-size: 0.85rem;
        }

        /* ìŠ¬ë¼ì´ë” */
        .size-slider-group {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .size-slider-group input[type="range"] {
            flex: 1;
            height: 6px;
            -webkit-appearance: none;
            background: var(--border-light);
            border-radius: 3px;
        }

        .size-slider-group input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 16px;
            height: 16px;
            background: var(--pastel-gold);
            border-radius: 50%;
            cursor: pointer;
        }

        .size-value {
            min-width: 50px;
            font-size: 0.8rem;
            color: var(--text-mid);
        }

        /* ì •ë ¬ ë²„íŠ¼ */
        .align-btn-group {
            display: flex;
            gap: 8px;
        }

        .align-btn {
            width: 40px;
            height: 40px;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            background: var(--bg-section);
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.2s;
        }

        .align-btn:hover {
            background: var(--pastel-gold-light);
        }

        .align-btn.active {
            background: var(--pastel-gold);
            border-color: var(--pastel-gold-dark);
        }

        /* íƒœê·¸ ì…ë ¥ */
        .tags-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            padding: 8px;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            background: var(--bg-section);
            min-height: 42px;
            align-items: center;
        }

        .tag-item {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            background: var(--pastel-blue-light);
            border-radius: 12px;
            font-size: 0.8rem;
            color: var(--text-dark);
        }

        .tag-remove {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: rgba(0,0,0,0.1);
            border: none;
            cursor: pointer;
            font-size: 0.7rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .tag-input {
            border: none;
            background: transparent;
            outline: none;
            font-size: 0.85rem;
            min-width: 100px;
            flex: 1;
        }

        /* í”„ë¡œê·¸ë ˆìŠ¤ ë°” */
        .upload-progress {
            display: none;
            margin-top: 10px;
        }

        .upload-progress.show { display: block; }

        .progress-bar {
            height: 8px;
            background: var(--bg-section);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--pastel-gold), var(--pastel-green));
            transition: width 0.3s;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-mid);
            margin-top: 4px;
            text-align: center;
        }

        /* ë“œë˜ê·¸ ìƒíƒœ */
        .portfolio-card.dragging {
            opacity: 0.5;
            transform: scale(0.98);
        }

        .portfolio-card.drag-over {
            border: 2px dashed var(--pastel-blue);
        }

        .section.dragging {
            opacity: 0.5;
        }

        .section.drag-over-section {
            border-top: 3px solid var(--pastel-blue);
            padding-top: 10px;
        }

        /* ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .portfolio-card { animation: fadeInUp 0.4s ease forwards; }

        /* í‘¸í„° ìˆ˜ì • ë²„íŠ¼ */
        .footer-edit-btn {
            padding: 8px 16px;
            border: 1px solid var(--border-light);
            border-radius: 8px;
            background: var(--bg-card);
            cursor: pointer;
            font-size: 0.8rem;
            display: none;
            margin-bottom: 12px;
        }

        .footer-edit-btn.show { display: inline-block; }
        .footer-edit-btn:hover { background: var(--pastel-gold-light); }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ ë°” -->
    <div class="top-bar">
        <div id="siteTitle" class="site-title" onclick="if(isLoggedIn) openSiteTitleModal()">PORTFOLIO</div>
        <div id="loggedInStatus" class="logged-in-indicator" style="display: none;">í¸ì§‘ ëª¨ë“œ</div>
        <button id="settingsBtn" class="settings-btn" style="display: none;" onclick="openModal('settingsModal')">âš™ï¸ ì„¤ì •</button>
        <button id="logoutBtn" class="logout-btn" style="display: none;" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        <button id="loginBtn" class="login-btn" onclick="openModal('loginModal')">ğŸ” ë¡œê·¸ì¸</button>
    </div>

    <!-- ë©”ì¸ ë ˆì´ì•„ì›ƒ -->
    <div class="main-layout">
        <!-- ì¢Œì¸¡ í”„ë¡œí•„ íŒ¨ë„ -->
        <aside class="profile-panel">
            <button class="profile-edit-btn" id="profileEditBtn" onclick="openProfileModal()" style="margin-bottom: 15px;">âœï¸ í”„ë¡œí•„ ìˆ˜ì •</button>

            <div class="profile-image-container" id="profileImage">
                <div class="profile-emoji" id="profileEmoji">ğŸ®</div>
                <img id="profileImg" style="display: none;">
                <div class="profile-edit-overlay">ğŸ“· ë³€ê²½</div>
            </div>

            <div class="profile-info">
                <h1 class="profile-name" id="mainTitle">PORTFOLIO</h1>
                <p class="profile-role" id="subTitle">GAME DESIGNER</p>
            </div>

            <div class="profile-divider"></div>

            <div class="intro-text-box" id="introText">
                <span id="introContent">ê²Œì„ ì‹œìŠ¤í…œ ì„¤ê³„ì™€ ì½˜í…ì¸  ê¸°íšì— ì—´ì •ì„ ê°€ì§„ ê²Œì„ ê¸°íšìì…ë‹ˆë‹¤. ì‚¬ìš©ì ê²½í—˜ì„ ìµœìš°ì„ ìœ¼ë¡œ ê³ ë ¤í•˜ë©°, ë°ì´í„° ê¸°ë°˜ì˜ ë°¸ëŸ°ìŠ¤ ì„¤ê³„ì™€ ì§ê´€ì ì¸ ì‹œìŠ¤í…œ êµ¬ì¡°ë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤.</span>
                <div class="intro-edit-hint">âœï¸ í´ë¦­í•˜ì—¬ ìˆ˜ì •</div>
            </div>

            <div class="profile-section">
                <div class="profile-section-title">ğŸ“§ Contact</div>
                <div id="contactItemsContainer">
                    <!-- ë™ì ìœ¼ë¡œ ë Œë”ë§ë¨ -->
                </div>
                <button class="contact-add-btn" id="contactAddBtn" onclick="openContactAddModal()" style="display: none;">+ ì—°ë½ì²˜ ì¶”ê°€</button>
            </div>

            <div style="margin-top: auto; text-align: center; padding-top: 20px;">
                <p style="font-size: 0.7rem; color: var(--text-light);" id="copyrightText">Â© 2026 ê²Œì„ ê¸°íšì í¬íŠ¸í´ë¦¬ì˜¤</p>
            </div>
        </aside>

        <!-- ì¤‘ì•™ ë©”ì¸ ì»¨í…ì¸  -->
        <main class="main-content">
            <!-- ì„¹ì…˜ ë„¤ë¹„ê²Œì´ì…˜ -->
            <nav class="section-nav" id="sectionNav">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
            </nav>

            <!-- ì„¹ì…˜ ì»¨í…Œì´ë„ˆ -->
            <div class="sections-container" id="sectionsContainer">
                <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
            </div>

            <!-- ì„¹ì…˜ ì¶”ê°€ ë²„íŠ¼ -->
            <div class="add-section-btn" id="addSectionBtn" onclick="openSectionModal()">
                + ìƒˆ ì„¹ì…˜ ì¶”ê°€
            </div>
        </main>

        <!-- ìš°ì¸¡ íˆìŠ¤í† ë¦¬ íŒ¨ë„ -->
        <aside class="history-panel">
            <div class="history-header">
                <div class="history-title">ğŸ• ìµœê·¼ ì—´ëŒ ê¸°ë¡</div>
            </div>
            <div class="history-list" id="historyList">
                <div class="history-empty">
                    <div class="history-empty-icon">ğŸ“‚</div>
                    <div>ì—´ëŒ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</div>
                </div>
            </div>
        </aside>
    </div>

    <!-- ì‚¬ì´íŠ¸ íƒ€ì´í‹€ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="siteTitleModal">
        <div class="modal">
            <h2 class="modal-title">âœï¸ ì‚¬ì´íŠ¸ íƒ€ì´í‹€ ìˆ˜ì •</h2>
            <div class="form-group">
                <label class="form-label">ìƒë‹¨ íƒ€ì´í‹€</label>
                <input type="text" class="form-input" id="siteTitleInput" placeholder="PORTFOLIO">
            </div>
            <button class="form-btn primary" onclick="saveSiteTitle()">ì €ì¥</button>
            <button class="form-btn secondary" onclick="closeModal('siteTitleModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <h2 class="modal-title">ğŸ” ê´€ë¦¬ì ë¡œê·¸ì¸</h2>
            <div class="form-group">
                <label class="form-label">ì´ë©”ì¼</label>
                <input type="email" class="form-input" id="loginEmail" placeholder="ì´ë©”ì¼ ì…ë ¥">
            </div>
            <div class="form-group">
                <label class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" class="form-input" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
            </div>
            <div class="form-error" id="loginError"></div>
            <button class="form-btn primary" onclick="login()">ë¡œê·¸ì¸</button>
            <button class="form-btn secondary" onclick="closeModal('loginModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <h2 class="modal-title">âš™ï¸ ì„¤ì •</h2>
            <div class="form-group">
                <label class="form-label">ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ ê³µê°œ</label>
                <p style="font-size: 0.85rem; color: var(--text-mid); margin-bottom: 10px;">
                    í™œì„±í™”í•˜ë©´ ë¡œê·¸ì¸í•˜ì§€ ì•Šì€ ì‚¬ìš©ìë„ í´ë” ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                <div class="align-btn-group">
                    <button type="button" class="align-btn" id="downloadOff" onclick="setDownloadEnabled(false)">OFF</button>
                    <button type="button" class="align-btn" id="downloadOn" onclick="setDownloadEnabled(true)">ON</button>
                </div>
            </div>
            <p style="text-align: center; color: var(--text-mid); margin: 20px 0;">
                ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì€ Firebase Consoleì—ì„œ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            </p>
            <button class="form-btn secondary" onclick="closeModal('settingsModal')">ë‹«ê¸°</button>
        </div>
    </div>

    <!-- í”„ë¡œí•„ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="profileModal">
        <div class="modal">
            <h2 class="modal-title">ğŸ‘¤ í”„ë¡œí•„ ìˆ˜ì •</h2>
            <div class="form-group">
                <label class="form-label">í”„ë¡œí•„ ì´ë¯¸ì§€ (í´ë¦­ ë˜ëŠ” Ctrl+V)</label>
                <div class="profile-upload-area" id="profileImageUpload" onclick="document.getElementById('profileImageInput').click()" tabindex="0">
                    <div class="thumbnail-placeholder" id="profileImagePlaceholder">
                        <span>ğŸ–¼ï¸</span>
                        <span style="font-size: 0.75rem;">ì´ë¯¸ì§€ ì—…ë¡œë“œ</span>
                    </div>
                    <img class="profile-preview-img" id="profileImagePreview" style="display: none;">
                    <button type="button" class="thumbnail-remove-btn" id="profileImageRemoveBtn" onclick="event.stopPropagation(); removeProfileImage()" style="display: none;">Ã—</button>
                </div>
                <input type="file" id="profileImageInput" style="display: none;" accept="image/*" onchange="handleProfileImageSelect(event)">
            </div>
            <div class="form-group">
                <label class="form-label">ë©”ì¸ íƒ€ì´í‹€</label>
                <input type="text" class="form-input" id="profileTitle" placeholder="PORTFOLIO">
            </div>
            <div class="form-group">
                <label class="form-label">ë©”ì¸ íƒ€ì´í‹€ ìƒ‰ìƒ</label>
                <div class="color-picker-group">
                    <div class="color-palette" id="mainTitleColorPalette">
                        <div class="color-palette-item" style="background: #c9a86c;" onclick="selectTitleColor('main', '#c9a86c')"></div>
                        <div class="color-palette-item" style="background: #4a4a4a;" onclick="selectTitleColor('main', '#4a4a4a')"></div>
                        <div class="color-palette-item" style="background: #7ba3c9;" onclick="selectTitleColor('main', '#7ba3c9')"></div>
                        <div class="color-palette-item" style="background: #7cb88e;" onclick="selectTitleColor('main', '#7cb88e')"></div>
                        <div class="color-palette-item" style="background: #a87bc2;" onclick="selectTitleColor('main', '#a87bc2')"></div>
                        <div class="color-palette-item" style="background: #c98a8a;" onclick="selectTitleColor('main', '#c98a8a')"></div>
                    </div>
                    <div class="color-input-row">
                        <input type="color" id="mainTitleColorPicker" value="#c9a86c" onchange="selectTitleColor('main', this.value)">
                        <input type="text" id="mainTitleColorCode" placeholder="#c9a86c" oninput="handleColorCodeInput('main', this.value)">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ë©”ì¸ íƒ€ì´í‹€ í¬ê¸°</label>
                <div class="size-slider-group">
                    <input type="range" id="mainTitleSize" min="1" max="2.5" step="0.1" value="1.4" oninput="updateTitleSizePreview('main', this.value)">
                    <div class="size-value" id="mainTitleSizeValue">1.4rem</div>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ì„œë¸Œ íƒ€ì´í‹€</label>
                <input type="text" class="form-input" id="profileSubtitle" placeholder="GAME DESIGNER">
            </div>
            <div class="form-group">
                <label class="form-label">ì„œë¸Œ íƒ€ì´í‹€ ìƒ‰ìƒ</label>
                <div class="color-picker-group">
                    <div class="color-palette">
                        <div class="color-palette-item" style="background: #6a6a6a;" onclick="selectTitleColor('sub', '#6a6a6a')"></div>
                        <div class="color-palette-item" style="background: #4a4a4a;" onclick="selectTitleColor('sub', '#4a4a4a')"></div>
                        <div class="color-palette-item" style="background: #7ba3c9;" onclick="selectTitleColor('sub', '#7ba3c9')"></div>
                        <div class="color-palette-item" style="background: #7cb88e;" onclick="selectTitleColor('sub', '#7cb88e')"></div>
                    </div>
                    <div class="color-input-row">
                        <input type="color" id="subTitleColorPicker" value="#6a6a6a" onchange="selectTitleColor('sub', this.value)">
                        <input type="text" id="subTitleColorCode" placeholder="#6a6a6a" oninput="handleColorCodeInput('sub', this.value)">
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ì„œë¸Œ íƒ€ì´í‹€ í¬ê¸°</label>
                <div class="size-slider-group">
                    <input type="range" id="subTitleSize" min="0.7" max="1.5" step="0.1" value="0.9" oninput="updateTitleSizePreview('sub', this.value)">
                    <div class="size-value" id="subTitleSizeValue">0.9rem</div>
                </div>
            </div>
            <button class="form-btn primary" onclick="saveProfile()">ì €ì¥</button>
            <button class="form-btn secondary" onclick="closeModal('profileModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ìê¸°ì†Œê°œ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="introModal">
        <div class="modal">
            <h2 class="modal-title">âœï¸ ìê¸°ì†Œê°œ ìˆ˜ì •</h2>
            <div class="form-group">
                <label class="form-label">í…ìŠ¤íŠ¸ ì •ë ¬</label>
                <div class="align-btn-group">
                    <button type="button" class="align-btn" id="alignLeft" onclick="setIntroAlign('left')">â¬…</button>
                    <button type="button" class="align-btn" id="alignCenter" onclick="setIntroAlign('center')">â¬Œ</button>
                    <button type="button" class="align-btn" id="alignRight" onclick="setIntroAlign('right')">â¡</button>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">í°íŠ¸ í¬ê¸°</label>
                <div class="size-slider-group">
                    <input type="range" id="introFontSizeSlider" min="0.7" max="1.2" step="0.05" value="0.85" oninput="updateIntroFontSizePreview(this.value)">
                    <div class="size-value" id="introFontSizeValue">0.85rem</div>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ë³¼ë“œì²´</label>
                <div class="align-btn-group">
                    <button type="button" class="align-btn" id="boldOff" onclick="setIntroBold(false)">ê°€</button>
                    <button type="button" class="align-btn" id="boldOn" onclick="setIntroBold(true)" style="font-weight: 700;">ê°€</button>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ìê¸°ì†Œê°œ</label>
                <textarea class="form-textarea" id="introTextInput" rows="5" placeholder="ìê¸°ì†Œê°œë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            </div>
            <button class="form-btn primary" onclick="saveIntro()">ì €ì¥</button>
            <button class="form-btn secondary" onclick="closeModal('introModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- Contact ê°œë³„ ìˆ˜ì • ëª¨ë‹¬ -->
    <!-- Contact ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="contactEditModal">
        <div class="modal">
            <h2 class="modal-title" id="contactEditTitle">âœï¸ ì—°ë½ì²˜ ìˆ˜ì •</h2>
            <input type="hidden" id="contactEditIndex">
            <div class="form-group">
                <label class="form-label">ì•„ì´ì½˜</label>
                <div class="icon-picker" id="contactEditIconPicker">
                    <!-- ì•„ì´ì½˜ ì˜µì…˜ ë™ì  ìƒì„± -->
                </div>
                <input type="hidden" id="contactEditIcon">
            </div>
            <div class="form-group">
                <label class="form-label">í•­ëª© ì´ë¦„</label>
                <input type="text" class="form-input" id="contactEditLabel" placeholder="ì˜ˆ: ì´ë©”ì¼, ì „í™”ë²ˆí˜¸">
            </div>
            <div class="form-group">
                <label class="form-label">ê°’</label>
                <input type="text" class="form-input" id="contactEditValue" placeholder="ê°’ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div class="form-group">
                <label class="form-label">ë§í¬ URL (ì„ íƒì‚¬í•­)</label>
                <input type="text" class="form-input" id="contactEditLink" placeholder="https://...">
            </div>
            <div style="display: flex; gap: 10px;">
                <button class="form-btn primary" onclick="saveContactEdit()">ì €ì¥</button>
                <button class="form-btn secondary" onclick="closeModal('contactEditModal')">ì·¨ì†Œ</button>
                <button class="form-btn" id="contactDeleteBtn" onclick="deleteContactItem()" style="background: var(--pastel-red-light); color: var(--pastel-red-dark); margin-left: auto;">ì‚­ì œ</button>
            </div>
        </div>
    </div>

    <!-- Contact ì¶”ê°€ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="contactAddModal">
        <div class="modal">
            <h2 class="modal-title">â• ì—°ë½ì²˜ ì¶”ê°€</h2>
            <div class="form-group">
                <label class="form-label">ì•„ì´ì½˜ ì„ íƒ</label>
                <div class="icon-picker" id="contactAddIconPicker">
                    <!-- ì•„ì´ì½˜ ì˜µì…˜ ë™ì  ìƒì„± -->
                </div>
                <input type="hidden" id="contactAddIcon" value="ğŸ“§">
            </div>
            <div class="form-group">
                <label class="form-label">í•­ëª© ì´ë¦„ *</label>
                <input type="text" class="form-input" id="contactAddLabel" placeholder="ì˜ˆ: ì´ë©”ì¼, ì „í™”ë²ˆí˜¸, ë¸”ë¡œê·¸">
            </div>
            <div class="form-group">
                <label class="form-label">ê°’ *</label>
                <input type="text" class="form-input" id="contactAddValue" placeholder="ê°’ì„ ì…ë ¥í•˜ì„¸ìš”">
            </div>
            <div class="form-group">
                <label class="form-label">ë§í¬ URL (ì„ íƒì‚¬í•­)</label>
                <input type="text" class="form-input" id="contactAddLink" placeholder="https://...">
            </div>
            <button class="form-btn primary" onclick="saveContactAdd()">ì¶”ê°€</button>
            <button class="form-btn secondary" onclick="closeModal('contactAddModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ì„¹ì…˜ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="sectionModal">
        <div class="modal">
            <h2 class="modal-title" id="sectionModalTitle">ğŸ“ ìƒˆ ì„¹ì…˜ ì¶”ê°€</h2>
            <input type="hidden" id="editSectionId">
            <div class="form-group">
                <label class="form-label">ì•„ì´ì½˜ (ì´ëª¨ì§€)</label>
                <input type="text" class="form-input" id="sectionIcon" placeholder="ğŸ“„" maxlength="2">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¹ì…˜ ì œëª© *</label>
                <input type="text" class="form-input" id="sectionTitle" placeholder="DOCUMENTS">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¹ì…˜ ì„¤ëª…</label>
                <input type="text" class="form-input" id="sectionSubtitle" placeholder="ê¸°íšì„œ ë° ë¶„ì„ ë¬¸ì„œ">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¹ì…˜ ìƒ‰ìƒ</label>
                <div class="color-picker">
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="blue" checked>
                        <span class="color-swatch blue"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="green">
                        <span class="color-swatch green"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="purple">
                        <span class="color-swatch purple"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="pink">
                        <span class="color-swatch pink"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="gold">
                        <span class="color-swatch gold"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="mint">
                        <span class="color-swatch mint"></span>
                    </label>
                </div>
            </div>
            <div class="form-error" id="sectionError"></div>
            <button class="form-btn primary" onclick="saveSection()">ì €ì¥</button>
            <button class="form-btn danger" id="deleteSectionBtn" onclick="deleteSection()" style="display: none;">ì„¹ì…˜ ì‚­ì œ</button>
            <button class="form-btn secondary" onclick="closeModal('sectionModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- í•­ëª© ì¶”ê°€ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="addModal">
        <div class="modal">
            <h2 class="modal-title" id="addModalTitle">ğŸ“„ ìƒˆ í•­ëª© ì¶”ê°€</h2>
            <input type="hidden" id="addCategory">
            <div class="form-group">
                <label class="form-label">íŒŒì¼ ë˜ëŠ” í´ë” ì—…ë¡œë“œ</label>
                <div style="display: flex; gap: 10px; margin-bottom: 10px;">
                    <button type="button" class="form-btn secondary" style="flex: 1;" onclick="document.getElementById('fileInput').click()">ğŸ“„ íŒŒì¼ ì„ íƒ</button>
                    <button type="button" class="form-btn secondary" style="flex: 1;" onclick="document.getElementById('folderInput').click()">ğŸ“ í´ë” ì„ íƒ</button>
                </div>
                <div class="file-upload-area" id="fileUploadArea">
                    <div class="file-upload-icon">ğŸ“</div>
                    <div class="file-upload-text">íŒŒì¼ ë˜ëŠ” í´ë”ë¥¼ ì„ íƒí•˜ì„¸ìš”</div>
                    <div class="file-upload-hint">íŒŒì¼/í´ë”: ìµœëŒ€ 500MB</div>
                </div>
                <input type="file" id="fileInput" style="display: none;" accept="*/*" onchange="handleFileSelect(event)">
                <input type="file" id="folderInput" style="display: none;" webkitdirectory directory multiple onchange="handleFolderSelect(event)">
                <div class="file-preview" id="filePreview">
                    <span class="file-preview-icon" id="filePreviewIcon">ğŸ“„</span>
                    <div class="file-preview-info">
                        <div class="file-preview-name" id="filePreviewName"></div>
                        <div class="file-preview-size" id="filePreviewSize"></div>
                    </div>
                    <button class="file-preview-remove" onclick="removeFile()">Ã—</button>
                </div>
                <div class="upload-progress" id="uploadProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progressText">ì—…ë¡œë“œ ì¤‘... 0%</div>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ë˜ëŠ” ì™¸ë¶€ ë§í¬</label>
                <input type="url" class="form-input" id="itemLink" placeholder="https://...">
            </div>
            <div class="form-group">
                <label class="form-label">ì¸ë„¤ì¼ ì´ë¯¸ì§€ (ì„ íƒ)</label>
                <div class="thumbnail-upload-area" id="thumbnailUploadArea" onclick="document.getElementById('thumbnailInput').click()" tabindex="0">
                    <div class="thumbnail-placeholder" id="thumbnailPlaceholder">
                        <span>ğŸ–¼ï¸</span>
                        <span>í´ë¦­, ë“œë˜ê·¸ ë˜ëŠ” Ctrl+V</span>
                    </div>
                    <img class="thumbnail-preview-img" id="thumbnailPreviewImg" style="display: none;">
                    <button type="button" class="thumbnail-remove-btn" id="thumbnailRemoveBtn" onclick="event.stopPropagation(); removeThumbnail()" style="display: none;">Ã—</button>
                </div>
                <input type="file" id="thumbnailInput" style="display: none;" accept="image/*" onchange="handleThumbnailSelect(event)">
            </div>
            <div class="form-group">
                <label class="form-label">ì œëª© *</label>
                <input type="text" class="form-input" id="itemTitle" placeholder="í•­ëª© ì œëª©">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea class="form-textarea" id="itemDesc" placeholder="í•­ëª©ì— ëŒ€í•œ ì„¤ëª…"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">ë‚ ì§œ</label>
                <input type="month" class="form-input" id="itemDate">
            </div>
            <div class="form-group">
                <label class="form-label">í‚¤ì›Œë“œ (Enterë¡œ ì¶”ê°€)</label>
                <div class="tags-input-container" id="tagsContainer">
                    <input type="text" class="tag-input" id="tagInput" placeholder="í‚¤ì›Œë“œ ì…ë ¥ í›„ Enter">
                </div>
            </div>
            <div class="form-error" id="addError"></div>
            <button class="form-btn primary" id="saveBtn" onclick="saveItem()">ì €ì¥</button>
            <button class="form-btn secondary" onclick="closeModal('addModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- í•­ëª© ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <h2 class="modal-title">âœï¸ í•­ëª© ìˆ˜ì •</h2>
            <input type="hidden" id="editItemId">
            <input type="hidden" id="editCategory">
            <div class="form-group">
                <label class="form-label">ì¸ë„¤ì¼ ì´ë¯¸ì§€</label>
                <div class="thumbnail-upload-area" id="editThumbnailUploadArea" onclick="document.getElementById('editThumbnailInput').click()" tabindex="0">
                    <div class="thumbnail-placeholder" id="editThumbnailPlaceholder">
                        <span>ğŸ–¼ï¸</span>
                        <span>í´ë¦­, ë“œë˜ê·¸ ë˜ëŠ” Ctrl+V</span>
                    </div>
                    <img class="thumbnail-preview-img" id="editThumbnailPreviewImg" style="display: none;">
                    <button type="button" class="thumbnail-remove-btn" id="editThumbnailRemoveBtn" onclick="event.stopPropagation(); removeEditThumbnail()" style="display: none;">Ã—</button>
                </div>
                <input type="file" id="editThumbnailInput" style="display: none;" accept="image/*" onchange="handleEditThumbnailSelect(event)">
            </div>
            <div class="form-group">
                <label class="form-label">ì œëª© *</label>
                <input type="text" class="form-input" id="editTitle">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea class="form-textarea" id="editDesc"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">ë‚ ì§œ</label>
                <input type="month" class="form-input" id="editDate">
            </div>
            <div class="form-group">
                <label class="form-label">í‚¤ì›Œë“œ</label>
                <div class="tags-input-container" id="editTagsContainer">
                    <input type="text" class="tag-input" id="editTagInput" placeholder="í‚¤ì›Œë“œ ì…ë ¥ í›„ Enter">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ì²¨ë¶€ íŒŒì¼</label>
                <div id="editCurrentFile" style="margin-bottom: 10px; padding: 10px; background: var(--bg-section); border-radius: 8px; font-size: 0.8rem; display: none;">
                    ğŸ“ í˜„ì¬ íŒŒì¼: <span id="editCurrentFileName"></span>
                </div>
                <div class="file-upload-area" id="editFileUploadArea" onclick="document.getElementById('editFileInput').click()">
                    <div class="file-upload-icon">ğŸ“</div>
                    <div class="file-upload-text">ìƒˆ íŒŒì¼ ì„ íƒ (ë³€ê²½ ì‹œì—ë§Œ)</div>
                    <div class="file-upload-hint">ìµœëŒ€ 20MB</div>
                </div>
                <input type="file" id="editFileInput" style="display: none;" onchange="handleEditFileSelect(event)">
                <div id="editNewFileInfo" style="margin-top: 10px; padding: 10px; background: var(--pastel-green-light); border: 1px solid var(--pastel-green); border-radius: 8px; font-size: 0.8rem; display: none;">
                    âœ… ìƒˆ íŒŒì¼: <span id="editNewFileName"></span>
                    <button type="button" onclick="cancelEditFile()" style="margin-left: 10px; padding: 2px 8px; border: none; background: var(--pastel-red); border-radius: 4px; cursor: pointer; font-size: 0.7rem;">ì·¨ì†Œ</button>
                </div>
            </div>
            <div class="form-error" id="editError"></div>
            <button class="form-btn primary" onclick="updateItem()">ìˆ˜ì • ì €ì¥</button>
            <button class="form-btn danger" onclick="deleteItem()">ì‚­ì œ</button>
            <button class="form-btn secondary" onclick="closeModal('editModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>

    <!-- JSZip for folder download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    
    <script>
        // ============ Firebase ì„¤ì • ============
        const firebaseConfig = {
            apiKey: "AIzaSyBZ5mWnlloXbbcEc0V5QZ_N4vguDWtiKb0",
            authDomain: "web-portfolio-e7e05.firebaseapp.com",
            databaseURL: "https://web-portfolio-e7e05-default-rtdb.firebaseio.com/",
            storageBucket: "web-portfolio-e7e05.appspot.com"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const storage = firebase.storage();

        // Firebase ì—°ê²° ìƒíƒœ í™•ì¸
        database.ref('.info/connected').on('value', (snapshot) => {
            if (snapshot.val() === true) {
                console.log('Firebase ì—°ê²°ë¨');
            } else {
                console.log('Firebase ì—°ê²° ëŠê¹€');
            }
        });

        // ============ ì „ì—­ ë³€ìˆ˜ ============
        let isLoggedIn = false;
        let currentTags = [];
        let editTags = [];
        let selectedFile = null;
        let selectedFolder = null; // í´ë” ì—…ë¡œë“œìš©
        let selectedThumbnail = null;
        let editThumbnail = null;
        let editThumbnailChanged = false;
        let editThumbnailRemoved = false;
        let currentFilter = 'all';
        let draggedItem = null;
        let downloadEnabled = false; // ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í‘œì‹œ ì—¬ë¶€
        let serviceWorkerRegistration = null; // Service Worker ë“±ë¡ ê°ì²´

        // ìê¸°ì†Œê°œ ìŠ¤íƒ€ì¼
        let currentIntroAlign = 'left';
        let currentIntroFontSize = 0.85;
        let currentIntroBold = false;

        // íƒ€ì´í‹€ ìŠ¤íƒ€ì¼
        let mainTitleColor = '#c9a86c';
        let mainTitleSize = 1.4;
        let subTitleColor = '#6a6a6a';
        let subTitleSize = 0.9;

        const MAX_FILE_SIZE = 500 * 1024 * 1024; // 500MB (ë‹¨ì¼ íŒŒì¼)
        const MAX_FOLDER_SIZE = 500 * 1024 * 1024; // 500MB (í´ë” ì „ì²´)
        const MAX_THUMBNAIL_SIZE = 2 * 1024 * 1024; // 2MB

        // íˆìŠ¤í† ë¦¬ (ì„¸ì…˜ ê¸°ë°˜ - í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì‹œ ì´ˆê¸°í™”)
        let viewHistory = [];

        // ì•„ì´í…œ ìºì‹œ (ë Œë”ë§ëœ ì•„ì´í…œ ë°ì´í„° ì €ì¥)
        let itemsCache = {};

        // ============ Firebase ë°ì´í„° í•¨ìˆ˜ ============
        async function getProfile() {
            try {
                const snapshot = await database.ref('profile/data').once('value');
                return snapshot.val();
            } catch (error) {
                console.error('getProfile error:', error);
                return null;
            }
        }

        async function saveProfileData(profile) {
            try {
                await database.ref('profile/data').set(profile);
            } catch (error) {
                console.error('saveProfileData error:', error);
                throw error;
            }
        }

        async function getIntro() {
            try {
                const snapshot = await database.ref('intro/data').once('value');
                return snapshot.val();
            } catch (error) {
                console.error('getIntro error:', error);
                return null;
            }
        }

        async function saveIntroData(introData) {
            try {
                await database.ref('intro/data').set(introData);
            } catch (error) {
                console.error('saveIntroData error:', error);
                throw error;
            }
        }

        async function getFooter() {
            try {
                const snapshot = await database.ref('footer/data').once('value');
                return snapshot.val();
            } catch (error) {
                console.error('getFooter error:', error);
                return null;
            }
        }

        async function saveFooterData(data) {
            try {
                await database.ref('footer/data').set(data);
            } catch (error) {
                console.error('saveFooterData error:', error);
                throw error;
            }
        }

        // ì„¹ì…˜ ê´€ë ¨
        const DEFAULT_SECTIONS = [
            { id: 'documents', icon: 'ğŸ“„', title: 'DOCUMENTS', subtitle: 'ê¸°íšì„œ ë° ë¶„ì„ ë¬¸ì„œ', color: 'blue', order: 0 },
            { id: 'tools', icon: 'ğŸ› ï¸', title: 'SIMULATORS & TOOLS', subtitle: 'ì¸í„°ë™í‹°ë¸Œ ì‹œë®¬ë ˆì´í„° ë° ë„êµ¬', color: 'green', order: 1 },
            { id: 'visuals', icon: 'ğŸ¨', title: 'VISUALS', subtitle: 'ë‹¤ì´ì–´ê·¸ë¨ ë° ì‹œê° ìë£Œ', color: 'purple', order: 2 },
            { id: 'projects', icon: 'ğŸ“', title: 'PROJECTS', subtitle: 'ì°¸ì—¬ í”„ë¡œì íŠ¸', color: 'pink', order: 3 }
        ];

        async function getSections() {
            try {
                const snapshot = await database.ref('sections').once('value');
                const data = snapshot.val();
                if (!data) {
                    for (const section of DEFAULT_SECTIONS) {
                        await saveSectionData(section);
                    }
                    return DEFAULT_SECTIONS;
                }
                return Object.values(data).sort((a, b) => a.order - b.order);
            } catch (error) {
                console.error('getSections error:', error);
                return DEFAULT_SECTIONS;
            }
        }

        async function saveSectionData(section) {
            try {
                await database.ref('sections/' + section.id).set(section);
            } catch (error) {
                console.error('saveSectionData error:', error);
                throw error;
            }
        }

        async function deleteSectionData(id) {
            try {
                await database.ref('sections/' + id).remove();
            } catch (error) {
                console.error('deleteSectionData error:', error);
                throw error;
            }
        }

        // ë©”íƒ€ë°ì´í„° ê´€ë ¨
        async function getAllMetadata() {
            try {
                const sections = await getSections();
                const snapshot = await database.ref('metadata').once('value');
                const items = snapshot.val() ? Object.values(snapshot.val()) : [];
                
                const data = {};
                sections.forEach(s => data[s.id] = []);
                items.forEach(item => {
                    if (data[item.category] !== undefined) {
                        data[item.category].push(item);
                    }
                });
                return data;
            } catch (error) {
                console.error('getAllMetadata error:', error);
                const sections = await getSections();
                const data = {};
                sections.forEach(s => data[s.id] = []);
                return data;
            }
        }

        async function saveMetadata(item) {
            try {
                await database.ref('metadata/' + item.id).set(item);
            } catch (error) {
                console.error('saveMetadata error:', error);
                throw error;
            }
        }

        async function deleteMetadata(id) {
            try {
                await database.ref('metadata/' + id).remove();
            } catch (error) {
                console.error('deleteMetadata error:', error);
                throw error;
            }
        }

        // íŒŒì¼ ê´€ë ¨
        // ============ Firebase Storage íŒŒì¼ ê´€ë¦¬ ============

        // ë‹¨ì¼ íŒŒì¼ì„ Storageì— ì €ì¥ (Base64 ë˜ëŠ” File ê°ì²´)
        async function saveFile(fileId, data, metadata = {}) {
            try {
                console.log('saveFile í˜¸ì¶œ:', fileId, 'íƒ€ì…:', typeof data);

                let blob;
                if (typeof data === 'string') {
                    // Base64 ë¬¸ìì—´ì„ Blobìœ¼ë¡œ ë³€í™˜
                    blob = base64ToBlob(data, metadata.type || 'application/octet-stream');
                } else if (data instanceof Blob || data instanceof File) {
                    blob = data;
                } else {
                    throw new Error('ì§€ì›í•˜ì§€ ì•ŠëŠ” ë°ì´í„° íƒ€ì…');
                }

                const storageRef = storage.ref('files/' + fileId);
                const uploadTask = await storageRef.put(blob, metadata);

                console.log('saveFile ì™„ë£Œ:', fileId);
                return uploadTask;
            } catch (error) {
                console.error('saveFile error:', error);
                throw error;
            }
        }

        // í´ë” ì „ì²´ë¥¼ Storageì— ì €ì¥
        async function saveFolder(folderId, files, onProgress) {
            try {
                console.log('í´ë” ì €ì¥ ì‹œì‘:', folderId, 'íŒŒì¼ ê°œìˆ˜:', files.length);

                const uploadPromises = [];
                let completedCount = 0;

                for (const file of files) {
                    const filePath = `folders/${folderId}/${file.webkitRelativePath || file.name}`;
                    const storageRef = storage.ref(filePath);

                    const uploadPromise = storageRef.put(file).then(() => {
                        completedCount++;
                        if (onProgress) {
                            onProgress(completedCount, files.length);
                        }
                        return {
                            path: file.webkitRelativePath || file.name,
                            name: file.name,
                            type: file.type,
                            size: file.size
                        };
                    });

                    uploadPromises.push(uploadPromise);
                }

                const uploadedFiles = await Promise.all(uploadPromises);
                console.log('í´ë” ì €ì¥ ì™„ë£Œ:', folderId);

                return uploadedFiles;
            } catch (error) {
                console.error('saveFolder error:', error);
                throw error;
            }
        }

        // Storageì—ì„œ íŒŒì¼ ë‹¤ìš´ë¡œë“œ URL ê°€ì ¸ì˜¤ê¸°
        async function getFile(fileId) {
            console.log('=== getFile ì‹œì‘ ===');
            console.log('ìš”ì²­ íŒŒì¼ ID:', fileId);

            try {
                const storageRef = storage.ref('files/' + fileId);
                const url = await storageRef.getDownloadURL();

                console.log('ë‹¤ìš´ë¡œë“œ URL ì¡°íšŒ ì™„ë£Œ');
                return url;
            } catch (error) {
                console.error('=== getFile ì˜¤ë¥˜ ===');
                console.error('ì˜¤ë¥˜ ì½”ë“œ:', error.code);
                console.error('ì˜¤ë¥˜ ë©”ì‹œì§€:', error.message);

                if (error.code === 'storage/object-not-found') {
                    console.error('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', fileId);
                }

                return null;
            }
        }

        // Storageì—ì„œ í´ë”ì˜ ëª¨ë“  íŒŒì¼ ëª©ë¡ ê°€ì ¸ì˜¤ê¸°
        async function getFolderFiles(folderId) {
            try {
                console.log('í´ë” íŒŒì¼ ëª©ë¡ ì¡°íšŒ:', folderId);
                const folderRef = storage.ref('folders/' + folderId);
                const result = await folderRef.listAll();

                const files = await Promise.all(
                    result.items.map(async (itemRef) => {
                        const url = await itemRef.getDownloadURL();
                        const metadata = await itemRef.getMetadata();

                        return {
                            path: itemRef.fullPath.replace(`folders/${folderId}/`, ''),
                            name: itemRef.name,
                            type: metadata.contentType,
                            size: metadata.size,
                            url: url
                        };
                    })
                );

                console.log('í´ë” íŒŒì¼ ëª©ë¡ ì¡°íšŒ ì™„ë£Œ:', files.length, 'ê°œ');
                return files;
            } catch (error) {
                console.error('getFolderFiles error:', error);
                return [];
            }
        }

        // Storageì—ì„œ íŒŒì¼ ì‚­ì œ
        async function deleteFile(fileId) {
            try {
                const storageRef = storage.ref('files/' + fileId);
                await storageRef.delete();
                console.log('íŒŒì¼ ì‚­ì œ ì™„ë£Œ:', fileId);
            } catch (error) {
                console.error('deleteFile error:', error);
            }
        }

        // Storageì—ì„œ í´ë” ì „ì²´ ì‚­ì œ
        async function deleteFolder(folderId) {
            try {
                const folderRef = storage.ref('folders/' + folderId);
                const result = await folderRef.listAll();

                // ëª¨ë“  íŒŒì¼ ì‚­ì œ
                await Promise.all(
                    result.items.map(itemRef => itemRef.delete())
                );

                console.log('í´ë” ì‚­ì œ ì™„ë£Œ:', folderId);
            } catch (error) {
                console.error('deleteFolder error:', error);
            }
        }

        // ============ ì¸ì¦ ============
        function checkSession() {
            const session = sessionStorage.getItem('portfolioLoggedIn');
            if (session === 'true') {
                isLoggedIn = true;
                updateLoginUI();
            }
        }

        async function login() {
            const email = document.getElementById('loginEmail').value.trim();
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');
            
            if (!email || !password) {
                errorEl.textContent = 'ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            try {
                await firebase.auth().signInWithEmailAndPassword(email, password);
                isLoggedIn = true;
                sessionStorage.setItem('portfolioLoggedIn', 'true');
                closeModal('loginModal');
                updateLoginUI();
                updateUI();
            } catch (error) {
                console.error('Login error:', error);
                errorEl.textContent = 'ë¡œê·¸ì¸ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
            }
        }

        function logout() {
            firebase.auth().signOut();
            isLoggedIn = false;
            sessionStorage.removeItem('portfolioLoggedIn');
            updateLoginUI();
            updateUI();
        }

        function updateLoginUI() {
            document.getElementById('loginBtn').style.display = isLoggedIn ? 'none' : 'block';
            document.getElementById('logoutBtn').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('settingsBtn').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('loggedInStatus').style.display = isLoggedIn ? 'flex' : 'none';
        }

        // ============ ëª¨ë‹¬ ============
        function openModal(id) {
            document.getElementById(id).classList.add('active');
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
            const errorEl = document.getElementById(id.replace('Modal', 'Error'));
            if (errorEl) errorEl.classList.remove('show');
        }

        // ============ íˆìŠ¤í† ë¦¬ ============
        function addToHistory(item) {
            const historyItem = {
                id: item.id,
                title: item.title,
                fileType: item.fileType || 'link',
                timestamp: Date.now()
            };
            
            viewHistory = viewHistory.filter(h => h.id !== item.id);
            viewHistory.unshift(historyItem);
            viewHistory = viewHistory.slice(0, 20);
            
            renderHistory();
        }

        function renderHistory() {
            const container = document.getElementById('historyList');
            
            if (viewHistory.length === 0) {
                container.innerHTML = `
                    <div class="history-empty">
                        <div class="history-empty-icon">ğŸ“‚</div>
                        <div>ì—´ëŒ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</div>
                    </div>
                `;
                return;
            }

            container.innerHTML = viewHistory.map(item => {
                const timeAgo = getTimeAgo(item.timestamp);
                return `
                    <div class="history-item" onclick="openHistoryItem('${item.id}')">
                        <div class="history-item-title">${item.title}</div>
                        <div class="history-item-meta">
                            <span class="history-item-type">${item.fileType.toUpperCase()}</span>
                            <span>${timeAgo}</span>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getTimeAgo(timestamp) {
            const seconds = Math.floor((Date.now() - timestamp) / 1000);
            if (seconds < 60) return 'ë°©ê¸ˆ ì „';
            if (seconds < 3600) return Math.floor(seconds / 60) + 'ë¶„ ì „';
            if (seconds < 86400) return Math.floor(seconds / 3600) + 'ì‹œê°„ ì „';
            return Math.floor(seconds / 86400) + 'ì¼ ì „';
        }

        async function openHistoryItem(itemId) {
            console.log('openHistoryItem í˜¸ì¶œ:', itemId);
            try {
                const snapshot = await database.ref('metadata/' + itemId).once('value');
                const item = snapshot.val();
                if (item) {
                    await openItem(item);
                } else {
                    alert('í•­ëª© ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('openHistoryItem ì˜¤ë¥˜:', error);
            }
        }

        // ============ íŒŒì¼ ì—´ê¸° ============
        async function openItem(item) {
            console.log('=== íŒŒì¼ ì—´ê¸° ì‹œì‘ ===');
            console.log('í•­ëª© ê°ì²´ í‚¤:', Object.keys(item));
            console.log('item.id:', item.id);
            console.log('item.title:', item.title);
            console.log('item.fileId:', item.fileId, '(íƒ€ì…:', typeof item.fileId, ')');
            console.log('item.link:', item.link, '(íƒ€ì…:', typeof item.link, ')');
            console.log('item.fileType:', item.fileType);
            console.log('ì „ì²´ í•­ëª©:', JSON.stringify(item, null, 2));

            addToHistory(item);

            // 1. íŒŒì¼ IDê°€ ìˆëŠ” ê²½ìš° - ì—…ë¡œë“œëœ íŒŒì¼ ë˜ëŠ” í´ë”
            // fileIdê°€ ì¡´ì¬í•˜ê³ , ë¹ˆ ë¬¸ìì—´ì´ ì•„ë‹ˆê³ , null/undefinedê°€ ì•„ë‹Œ ê²½ìš°
            if (item.fileId && item.fileId !== '' && item.fileId !== 'null' && item.fileId !== 'undefined') {
                console.log('1. íŒŒì¼ ID ì¡´ì¬:', item.fileId);

                try {
                    // í´ë” íƒ€ì…ì¸ ê²½ìš°ëŠ” ZIP ë‹¤ìš´ë¡œë“œë§Œ ì§€ì› (í´ë¦­ ì‹œ)
                    if (item.fileType === 'folder') {
                        console.log('í´ë” íƒ€ì… - ZIP ë‹¤ìš´ë¡œë“œ');
                        await downloadFolder(item.id);
                        return;
                    }

                    // ë‹¨ì¼ íŒŒì¼ì€ Storage URLë¡œ ì—´ê¸°
                    const fileUrl = await getFile(item.fileId);

                    if (fileUrl) {
                        console.log('2. íŒŒì¼ URL ì¡°íšŒ ì„±ê³µ:', fileUrl);

                        // a íƒœê·¸ë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ ì—´ê¸°
                        const link = document.createElement('a');
                        link.href = fileUrl;
                        link.target = '_blank';
                        link.rel = 'noopener noreferrer';

                        // ì¼ë¶€ íŒŒì¼ í˜•ì‹ì€ ë‹¤ìš´ë¡œë“œë¡œ ì²˜ë¦¬
                        const downloadTypes = ['doc', 'docx', 'xls', 'xlsx', 'ppt', 'pptx', 'zip'];
                        if (downloadTypes.includes(item.fileType?.toLowerCase())) {
                            link.download = item.fileName || item.title + '.' + item.fileType;
                        }

                        document.body.appendChild(link);
                        link.click();
                        document.body.removeChild(link);

                        console.log('3. íŒŒì¼ ì—´ê¸° ì™„ë£Œ');
                        return;
                    } else {
                        console.error('íŒŒì¼ URL ì—†ìŒ - fileId:', item.fileId);
                        alert('íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n\nfileId: ' + item.fileId + '\n\nFirebase Storageì—ì„œ íŒŒì¼ì´ ì‚­ì œë˜ì—ˆê±°ë‚˜ ê¶Œí•œì´ ì—†ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.');
                        return;
                    }
                } catch (error) {
                    console.error('íŒŒì¼ ì—´ê¸° ì˜¤ë¥˜:', error);
                    alert('íŒŒì¼ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜: ' + error.message);
                    return;
                }
            } else {
                console.log('fileId ì—†ìŒ ë˜ëŠ” ìœ íš¨í•˜ì§€ ì•ŠìŒ:', item.fileId);
            }

            // 2. ë§í¬ê°€ ìˆëŠ” ê²½ìš° - ì™¸ë¶€ ë§í¬
            if (item.link && item.link !== '' && item.link !== 'null') {
                console.log('ë§í¬ ì—´ê¸°:', item.link);
                const link = document.createElement('a');
                link.href = item.link;
                link.target = '_blank';
                link.rel = 'noopener noreferrer';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                return;
            }
            
            // 3. íŒŒì¼ë„ ë§í¬ë„ ì—†ëŠ” ê²½ìš° - ìì„¸í•œ ì •ë³´ í‘œì‹œ
            console.error('=== íŒŒì¼/ë§í¬ ì—†ìŒ ì˜¤ë¥˜ ===');
            console.error('item.fileId:', item.fileId);
            console.error('item.link:', item.link);
            console.error('ì „ì²´ item í‚¤:', Object.keys(item));
            
            alert('ì´ í•­ëª©ì—ëŠ” ì—´ ìˆ˜ ìˆëŠ” íŒŒì¼ì´ë‚˜ ë§í¬ê°€ ì—†ìŠµë‹ˆë‹¤.\n\n' +
                  'í•­ëª© ID: ' + item.id + '\n' +
                  'ì œëª©: ' + item.title + '\n' +
                  'fileId: ' + (item.fileId || 'ì—†ìŒ') + '\n' +
                  'link: ' + (item.link || 'ì—†ìŒ') + '\n\n' +
                  'ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬(F12)ì—ì„œ Consoleì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }

        function getMimeType(fileType) {
            const mimeTypes = {
                'pdf': 'application/pdf',
                'html': 'text/html',
                'png': 'image/png',
                'jpg': 'image/jpeg',
                'jpeg': 'image/jpeg',
                'gif': 'image/gif',
                'mp4': 'video/mp4',
                'txt': 'text/plain',
                'doc': 'application/msword',
                'docx': 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
                'xls': 'application/vnd.ms-excel',
                'xlsx': 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                'ppt': 'application/vnd.ms-powerpoint',
                'pptx': 'application/vnd.openxmlformats-officedocument.presentationml.presentation',
                'zip': 'application/zip'
            };
            return mimeTypes[fileType?.toLowerCase()] || 'application/octet-stream';
        }

        function base64ToBlob(base64, mimeType) {
            try {
                // base64 ë¬¸ìì—´ì´ data URL í˜•ì‹ì¸ ê²½ìš° ìˆœìˆ˜ base64ë§Œ ì¶”ì¶œ
                let pureBase64 = base64;
                if (base64.includes(',')) {
                    pureBase64 = base64.split(',')[1];
                }

                const byteCharacters = atob(pureBase64);
                const byteNumbers = new Array(byteCharacters.length);
                for (let i = 0; i < byteCharacters.length; i++) {
                    byteNumbers[i] = byteCharacters.charCodeAt(i);
                }
                const byteArray = new Uint8Array(byteNumbers);
                return new Blob([byteArray], { type: mimeType });
            } catch (error) {
                console.error('base64ToBlob ì˜¤ë¥˜:', error);
                throw error;
            }
        }

        // í´ë”ë¥¼ ZIP íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ
        async function downloadFolderAsZip(folderDataString, folderName) {
            try {
                const folderData = JSON.parse(folderDataString);
                const zip = new JSZip();

                // ëª¨ë“  íŒŒì¼ì„ ZIPì— ì¶”ê°€
                for (const file of folderData.files) {
                    // Base64ë¥¼ Blobìœ¼ë¡œ ë³€í™˜
                    const blob = base64ToBlob(file.data, file.type);
                    // ZIPì— íŒŒì¼ ì¶”ê°€ (ì›ë³¸ ê²½ë¡œ êµ¬ì¡° ìœ ì§€)
                    zip.file(file.path, blob);
                }

                // ZIP íŒŒì¼ ìƒì„±
                const zipBlob = await zip.generateAsync({
                    type: 'blob',
                    compression: 'DEFLATE',
                    compressionOptions: { level: 6 }
                });

                // ZIP íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                const url = URL.createObjectURL(zipBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `${folderName}.zip`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                setTimeout(() => URL.revokeObjectURL(url), 1000);
            } catch (error) {
                console.error('ZIP ìƒì„± ì˜¤ë¥˜:', error);
                alert('í´ë”ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\nì˜¤ë¥˜: ' + error.message);
            }
        }

        // í´ë” ë‹¤ìš´ë¡œë“œ (Firebase Storageì—ì„œ ZIPìœ¼ë¡œ)
        async function downloadFolder(itemId) {
            try {
                const item = itemsCache[itemId] || (await database.ref('metadata/' + itemId).once('value')).val();
                if (!item || item.fileType !== 'folder') {
                    alert('í´ë”ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                // Firebase Storageì—ì„œ í´ë”ì˜ ëª¨ë“  íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
                const files = await getFolderFiles(item.fileId);
                if (!files || files.length === 0) {
                    alert('í´ë”ì— íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                // ZIP íŒŒì¼ ìƒì„±
                const zip = new JSZip();
                const folderName = item.fileName || item.title;

                console.log('ZIP ìƒì„± ì‹œì‘:', files.length, 'ê°œ íŒŒì¼');

                // ëª¨ë“  íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ZIPì— ì¶”ê°€
                for (const file of files) {
                    try {
                        const response = await fetch(file.url);
                        const blob = await response.blob();
                        zip.file(file.path, blob);
                    } catch (error) {
                        console.error('íŒŒì¼ ë‹¤ìš´ë¡œë“œ ì‹¤íŒ¨:', file.path, error);
                    }
                }

                // ZIP ìƒì„± ë° ë‹¤ìš´ë¡œë“œ
                const zipBlob = await zip.generateAsync({
                    type: 'blob',
                    compression: 'DEFLATE',
                    compressionOptions: { level: 6 }
                });

                const url = URL.createObjectURL(zipBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = `${folderName}.zip`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                setTimeout(() => URL.revokeObjectURL(url), 1000);

                console.log('ZIP ë‹¤ìš´ë¡œë“œ ì™„ë£Œ');
            } catch (error) {
                console.error('í´ë” ë‹¤ìš´ë¡œë“œ ì˜¤ë¥˜:', error);
                alert('í´ë” ë‹¤ìš´ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
            }
        }

        // Unity WebGL ì‹¤í–‰
        async function runWebGL(itemId) {
            try {
                // Service Worker ë“±ë¡ í™•ì¸
                if (!serviceWorkerRegistration) {
                    await registerServiceWorker();
                }

                // í•­ëª© ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                const item = itemsCache[itemId] || (await database.ref('metadata/' + itemId).once('value')).val();
                if (!item || !item.isWebGL) {
                    alert('WebGL í”„ë¡œì íŠ¸ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                // ìƒˆ íƒ­ì—ì„œ ê°€ìƒ URL ì—´ê¸°
                const virtualUrl = `/virtual/${item.fileId}/`;
                window.open(virtualUrl, '_blank');

            } catch (error) {
                console.error('WebGL ì‹¤í–‰ ì˜¤ë¥˜:', error);
                alert('WebGL ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.\n\n' + error.message);
            }
        }

        // Service Worker ë“±ë¡
        async function registerServiceWorker() {
            try {
                if (!('serviceWorker' in navigator)) {
                    throw new Error('ì´ ë¸Œë¼ìš°ì €ëŠ” Service Workerë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
                }

                const registration = await navigator.serviceWorker.register('/sw.js');
                serviceWorkerRegistration = registration;

                console.log('Service Worker ë“±ë¡ ì™„ë£Œ:', registration);

                // Service Workerê°€ í™œì„±í™”ë  ë•Œê¹Œì§€ ëŒ€ê¸°
                await navigator.serviceWorker.ready;

                // Firebase Storage URL ì „ì†¡
                const storageUrl = `https://firebasestorage.googleapis.com/v0/b/${firebaseConfig.apiKey.split(':')[0]}-default-appspot.com`;
                registration.active.postMessage({
                    type: 'INIT_STORAGE',
                    storageUrl: 'https://firebasestorage.googleapis.com/v0/b/web-portfolio-e7e05.appspot.com'
                });

                console.log('Service Worker ì´ˆê¸°í™” ì™„ë£Œ');

            } catch (error) {
                console.error('Service Worker ë“±ë¡ ì‹¤íŒ¨:', error);
                throw error;
            }
        }

        // ============ ë Œë”ë§ ============
        async function renderSectionsAndNav() {
            const sections = await getSections();
            const data = await getAllMetadata();
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë Œë”ë§
            const navContainer = document.getElementById('sectionNav');
            const totalCount = sections.reduce((sum, s) => sum + (data[s.id] || []).length, 0);
            
            navContainer.innerHTML = `
                <button class="section-nav-btn ${currentFilter === 'all' ? 'active' : ''}" data-filter="all">
                    ğŸ“‹ ì „ì²´ <span class="section-nav-count">${totalCount}</span>
                </button>
                ${sections.map(section => `
                    <button class="section-nav-btn ${currentFilter === section.id ? 'active' : ''}" data-filter="${section.id}">
                        ${section.icon} ${section.title.split(' ')[0]} 
                        <span class="section-nav-count" id="navCount-${section.id}">${(data[section.id] || []).length}</span>
                    </button>
                `).join('')}
            `;

            // ë„¤ë¹„ê²Œì´ì…˜ ì´ë²¤íŠ¸
            navContainer.querySelectorAll('.section-nav-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const filter = this.dataset.filter;
                    setFilter(filter);
                });
            });

            // ì„¹ì…˜ ë Œë”ë§
            const sectionsContainer = document.getElementById('sectionsContainer');
            sectionsContainer.innerHTML = sections.map(section => `
                <section class="section" id="${section.id}" data-section-id="${section.id}">
                    <div class="section-header">
                        <div class="section-drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½">â‹®â‹®</div>
                        <div class="section-icon ${section.color}">${section.icon}</div>
                        <div class="section-info">
                            <h2 class="section-title">${section.title} <span class="count" id="sectionCount-${section.id}">(${(data[section.id] || []).length})</span></h2>
                            <p class="section-subtitle">${section.subtitle}</p>
                        </div>
                        <button class="section-edit-btn" onclick="openSectionModal('${section.id}')" title="ì„¹ì…˜ ìˆ˜ì •">âœï¸</button>
                    </div>
                    <div class="portfolio-scroll-container" id="scroll-${section.id}">
                        <div class="portfolio-grid" id="grid-${section.id}">
                            <!-- ì¹´ë“œë“¤ì´ ì—¬ê¸°ì— ë Œë”ë§ë¨ -->
                        </div>
                    </div>
                </section>
            `).join('');

            // ê°€ë¡œ ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ì„¤ì •
            setupHorizontalScroll();

            setupSectionDragAndDrop();
            updateSectionVisibility();
        }

        function setupHorizontalScroll() {
            // ë‹¨ì¼ ì„¹ì…˜ ëª¨ë“œê°€ ì•„ë‹ ë•Œë§Œ ê°€ë¡œ ìŠ¤í¬ë¡¤ ì ìš©
            if (currentFilter === 'all') {
                document.querySelectorAll('.portfolio-scroll-container').forEach(scrollContainer => {
                    // ê¸°ì¡´ ì´ë²¤íŠ¸ ì œê±°ë¥¼ ìœ„í•´ ìƒˆë¡œìš´ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
                    scrollContainer.onwheel = (e) => {
                        if (e.deltaY !== 0) {
                            e.preventDefault();
                            scrollContainer.scrollLeft += e.deltaY;
                        }
                    };
                });
            } else {
                document.querySelectorAll('.portfolio-scroll-container').forEach(scrollContainer => {
                    scrollContainer.onwheel = null;
                });
            }
        }

        async function renderAllSections() {
            // ìºì‹œ ì´ˆê¸°í™”
            itemsCache = {};
            
            const sections = await getSections();
            const data = await getAllMetadata();
            
            console.log('=== renderAllSections ===');
            console.log('ì„¹ì…˜ ëª©ë¡:', sections.map(s => s.id));
            
            // ê° ì„¹ì…˜ì˜ í•­ëª© ìƒì„¸ ë¡œê¹…
            sections.forEach(section => {
                const items = data[section.id] || [];
                console.log(`[${section.id}] í•­ëª© ìˆ˜: ${items.length}`);
                items.forEach((item, idx) => {
                    console.log(`  - [${idx}] ${item.title} | fileId: ${item.fileId || 'ì—†ìŒ'} | link: ${item.link || 'ì—†ìŒ'}`);
                });
                renderSection(section.id, items);
            });
            
            console.log('ìºì‹œëœ í•­ëª© ìˆ˜:', Object.keys(itemsCache).length);
        }

        function renderSection(sectionId, items) {
            const grid = document.getElementById(`grid-${sectionId}`);
            if (!grid) return;

            items.sort((a, b) => (a.order || 0) - (b.order || 0));

            // ì•„ì´í…œ ìºì‹œì— ì €ì¥
            items.forEach(item => {
                itemsCache[item.id] = item;
            });

            grid.innerHTML = items.map((item, index) => createCardHTML(item, sectionId)).join('') +
                `<div class="add-card" onclick="openAddModal('${sectionId}')">
                    <div class="add-card-icon">+</div>
                    <div class="add-card-text">ìƒˆ í•­ëª© ì¶”ê°€</div>
                </div>`;

            // ì¹´ë“œ ì´ë²¤íŠ¸ ì„¤ì •
            grid.querySelectorAll('.portfolio-card').forEach(card => {
                const itemId = card.dataset.itemId;
                setupDragAndDrop(card, sectionId, itemId);
            });

            updateUI();
        }

        function createCardHTML(item, category) {
            const fileTypeIcon = getFileTypeIcon(item.fileType);
            const thumbnailHTML = item.thumbnail
                ? `<img src="data:image/jpeg;base64,${item.thumbnail}" alt="${item.title}">`
                : `<div class="card-thumbnail-placeholder">${fileTypeIcon}</div>`;

            // WebGL ì‹¤í–‰ ë²„íŠ¼ ë° ë‹¤ìš´ë¡œë“œ ë²„íŠ¼
            let actionButtons = '';
            if (item.fileType === 'folder' && item.isWebGL) {
                actionButtons = `
                    <div class="card-actions">
                        <button class="card-action-btn primary" onclick="event.stopPropagation(); runWebGL('${item.id}')" title="ì‹¤í–‰">â–¶ ì‹¤í–‰</button>
                        ${downloadEnabled || isLoggedIn ? `<button class="card-action-btn secondary" onclick="event.stopPropagation(); downloadFolder('${item.id}')" title="ë‹¤ìš´ë¡œë“œ">â¬‡ ZIP</button>` : ''}
                    </div>
                `;
            } else if (item.fileType === 'folder') {
                if (downloadEnabled || isLoggedIn) {
                    actionButtons = `
                        <div class="card-actions">
                            <button class="card-action-btn secondary" onclick="event.stopPropagation(); downloadFolder('${item.id}')" title="ë‹¤ìš´ë¡œë“œ">â¬‡ ZIP</button>
                        </div>
                    `;
                }
            }

            return `
                <div class="portfolio-card" data-item-id="${item.id}" data-category="${category}">
                    <button class="card-edit-btn" onclick="event.stopPropagation(); openEditModal('${item.id}', '${category}')" title="ìˆ˜ì •">âœï¸</button>
                    <div class="drag-handle" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½">â‹®â‹®</div>
                    <div class="card-link" onclick="openItemById('${item.id}')">
                        <div class="card-thumbnail">
                            ${thumbnailHTML}
                            <span class="card-file-type">${item.isWebGL ? 'WEBGL' : (item.fileType || 'LINK').toUpperCase()}</span>
                        </div>
                        <div class="card-body">
                            <div class="card-info">
                                ${item.date ? `<div class="card-date">${item.date}</div>` : ''}
                                <h3 class="card-title">${item.title}</h3>
                                ${item.description ? `<p class="card-desc">${item.description}</p>` : ''}
                                ${item.tags && item.tags.length ? `
                                    <div class="card-tags">
                                        ${item.tags.slice(0, 3).map(tag => `<span class="card-tag">${tag}</span>`).join('')}
                                    </div>
                                ` : ''}
                            </div>
                            ${actionButtons}
                        </div>
                    </div>
                </div>
            `;
        }

        async function openItemById(itemId) {
            console.log('=== openItemById ì‹œì‘ ===');
            console.log('ìš”ì²­ í•­ëª© ID:', itemId);
            
            try {
                // 1. ìºì‹œì—ì„œ ë¨¼ì € í™•ì¸
                let item = itemsCache[itemId];
                
                if (item) {
                    console.log('ìºì‹œì—ì„œ í•­ëª© ë°œê²¬:', item.title);
                    console.log('ìºì‹œ í•­ëª© fileId:', item.fileId);
                    console.log('ìºì‹œ í•­ëª© link:', item.link);
                } else {
                    // 2. ìºì‹œì— ì—†ìœ¼ë©´ Firebaseì—ì„œ ì¡°íšŒ
                    console.log('ìºì‹œì— ì—†ìŒ, Firebaseì—ì„œ ì¡°íšŒ...');
                    const snapshot = await database.ref('metadata/' + itemId).once('value');
                    item = snapshot.val();
                    
                    if (item) {
                        console.log('Firebaseì—ì„œ í•­ëª© ë°œê²¬:', item.title);
                        console.log('Firebase í•­ëª© fileId:', item.fileId);
                        console.log('Firebase í•­ëª© link:', item.link);
                        // ìºì‹œì— ì €ì¥
                        itemsCache[itemId] = item;
                    }
                }
                
                if (item) {
                    // í•­ëª© ë°ì´í„° ì „ì²´ ì¶œë ¥
                    console.log('ìµœì¢… í•­ëª© ë°ì´í„°:', JSON.stringify(item, null, 2));
                    await openItem(item);
                } else {
                    console.error('í•­ëª©ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', itemId);
                    alert('í•­ëª© ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('openItemById ì˜¤ë¥˜:', error);
                alert('í•­ëª©ì„ ì—¬ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }
        }

        function getFileTypeIcon(fileType) {
            const icons = {
                'pdf': 'ğŸ“•',
                'html': 'ğŸŒ',
                'png': 'ğŸ–¼ï¸',
                'jpg': 'ğŸ–¼ï¸',
                'jpeg': 'ğŸ–¼ï¸',
                'gif': 'ğŸï¸',
                'mp4': 'ğŸ¬',
                'link': 'ğŸ”—',
                'folder': 'ğŸ“'
            };
            return icons[fileType?.toLowerCase()] || 'ğŸ“„';
        }

        // ============ í”„ë¡œí•„ ============
        async function loadProfile() {
            const profile = await getProfile();
            if (profile) {
                document.getElementById('mainTitle').textContent = profile.title || 'PORTFOLIO';
                document.getElementById('subTitle').textContent = profile.subtitle || 'GAME DESIGNER';
                
                if (profile.mainTitleColor) {
                    mainTitleColor = profile.mainTitleColor;
                    document.getElementById('mainTitle').style.color = mainTitleColor;
                }
                if (profile.mainTitleSize) {
                    mainTitleSize = profile.mainTitleSize;
                    document.getElementById('mainTitle').style.fontSize = mainTitleSize + 'rem';
                }
                if (profile.subTitleColor) {
                    subTitleColor = profile.subTitleColor;
                    document.getElementById('subTitle').style.color = subTitleColor;
                }
                if (profile.subTitleSize) {
                    subTitleSize = profile.subTitleSize;
                    document.getElementById('subTitle').style.fontSize = subTitleSize + 'rem';
                }

                if (profile.image) {
                    document.getElementById('profileImg').src = 'data:image/jpeg;base64,' + profile.image;
                    document.getElementById('profileImg').style.display = 'block';
                    document.getElementById('profileEmoji').style.display = 'none';
                }
            }
        }

        async function loadIntro() {
            const intro = await getIntro();
            if (intro) {
                document.getElementById('introContent').textContent = intro.text || '';
                const introBox = document.getElementById('introText');
                if (intro.align) {
                    introBox.style.textAlign = intro.align;
                    currentIntroAlign = intro.align;
                }
                if (intro.fontSize) {
                    introBox.style.fontSize = intro.fontSize + 'rem';
                    currentIntroFontSize = intro.fontSize;
                }
                if (intro.bold) {
                    introBox.style.fontWeight = '700';
                    currentIntroBold = true;
                }
            }
        }

        // ì¶”ì²œ ì•„ì´ì½˜ ëª©ë¡
        const CONTACT_ICONS = ['âœ‰ï¸', 'ğŸ“§', 'ğŸ“', 'ğŸ’¼', 'ğŸ’»', 'ğŸ”—', 'ğŸŒ', 'ğŸ“', 'ğŸ“±', 'ğŸ®', 'ğŸ¨', 'ğŸ“·', 'ğŸµ', 'ğŸ“º', 'ğŸ¦', 'ğŸ“Œ', 'ğŸ ', 'ğŸ‘¤'];

        // ì—°ë½ì²˜ ë°ì´í„° ìºì‹œ
        let cachedFooterData = null;

        // ì—°ë½ì²˜ ë°ì´í„° ë¡œë“œ ë° ë Œë”ë§
        async function loadFooter() {
            let footer = await getFooter() || {};
            let needsSave = false;
            
            // contacts ë°°ì—´ì´ ì—†ìœ¼ë©´ ê¸°ì¡´ ë°ì´í„°ë¥¼ ë§ˆì´ê·¸ë ˆì´ì…˜
            if (!footer.contacts) {
                footer.contacts = [];
                if (footer.email) {
                    footer.contacts.push({ icon: 'âœ‰ï¸', label: 'ì´ë©”ì¼', value: footer.email, link: 'mailto:' + footer.email });
                }
                if (footer.github) {
                    footer.contacts.push({ icon: 'ğŸ’»', label: 'GitHub', value: footer.github, link: footer.github });
                }
                if (footer.linkedin) {
                    footer.contacts.push({ icon: 'ğŸ’¼', label: 'LinkedIn', value: footer.linkedin, link: footer.linkedin });
                }
                if (footer.copyright) {
                    footer.contacts.push({ icon: 'Â©ï¸', label: 'Copyright', value: footer.copyright, link: '' });
                }
                
                // ë§ˆì´ê·¸ë ˆì´ì…˜ ë°ì´í„°ê°€ ìˆìœ¼ë©´ ì €ì¥ í”Œë˜ê·¸
                if (footer.contacts.length > 0) {
                    needsSave = true;
                }
            }
            
            // ìºì‹œì— ì €ì¥
            cachedFooterData = footer;
            
            // ë§ˆì´ê·¸ë ˆì´ì…˜ëœ ë°ì´í„° ì €ì¥ (ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œë§Œ)
            if (needsSave && isLoggedIn) {
                await saveFooterData(footer);
                console.log('ì—°ë½ì²˜ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜ ì™„ë£Œ');
            }
            
            renderContactItems(footer.contacts || []);
            
            // Copyright ì—…ë°ì´íŠ¸ (ë³„ë„ í‘œì‹œìš©)
            const copyrightItem = (footer.contacts || []).find(c => c.label === 'Copyright');
            const copyrightValue = copyrightItem?.value || footer.copyright || 'Â© 2026 í¬íŠ¸í´ë¦¬ì˜¤';
            document.getElementById('copyrightText').textContent = copyrightValue;
        }

        function renderContactItems(contacts) {
            const container = document.getElementById('contactItemsContainer');
            
            if (contacts.length === 0) {
                container.innerHTML = `<div style="text-align: center; padding: 10px; color: var(--text-light); font-size: 0.8rem;">ì—°ë½ì²˜ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>`;
            } else {
                container.innerHTML = contacts.map((contact, index) => `
                    <div class="profile-item contact-editable" onclick="if(isLoggedIn) openContactEditModal(${index})">
                        <span class="profile-item-icon">${contact.icon}</span>
                        <div class="profile-item-content">
                            <div class="profile-item-label">${contact.label}</div>
                            <div class="profile-item-value">
                                ${contact.link ? `<a href="${contact.link}" target="_blank" onclick="event.stopPropagation()">${contact.value}</a>` : contact.value}
                            </div>
                        </div>
                        <span class="contact-edit-icon">âœï¸</span>
                    </div>
                `).join('');
            }
            
            // ì—°ë½ì²˜ ì¶”ê°€ ë²„íŠ¼ í‘œì‹œ
            const addBtn = document.getElementById('contactAddBtn');
            if (addBtn) {
                addBtn.style.display = isLoggedIn ? 'block' : 'none';
            }
        }

        function renderIconPicker(containerId, selectedIcon) {
            const container = document.getElementById(containerId);
            container.innerHTML = CONTACT_ICONS.map(icon => `
                <div class="icon-option ${icon === selectedIcon ? 'selected' : ''}" onclick="selectIcon('${containerId}', '${icon}')">${icon}</div>
            `).join('');
        }

        function selectIcon(containerId, icon) {
            // ì„ íƒ ìƒíƒœ ì—…ë°ì´íŠ¸
            document.querySelectorAll(`#${containerId} .icon-option`).forEach(el => {
                el.classList.remove('selected');
                if (el.textContent === icon) el.classList.add('selected');
            });
            
            // hidden input ì—…ë°ì´íŠ¸
            if (containerId === 'contactEditIconPicker') {
                document.getElementById('contactEditIcon').value = icon;
            } else if (containerId === 'contactAddIconPicker') {
                document.getElementById('contactAddIcon').value = icon;
            }
        }

        // ============ í”„ë¡œí•„ ëª¨ë‹¬ ============
        function openProfileModal() {
            if (!isLoggedIn) return;
            
            document.getElementById('profileTitle').value = document.getElementById('mainTitle').textContent;
            document.getElementById('profileSubtitle').value = document.getElementById('subTitle').textContent;
            
            document.getElementById('mainTitleColorPicker').value = mainTitleColor;
            document.getElementById('mainTitleColorCode').value = mainTitleColor;
            document.getElementById('mainTitleSize').value = mainTitleSize;
            document.getElementById('mainTitleSizeValue').textContent = mainTitleSize + 'rem';
            
            document.getElementById('subTitleColorPicker').value = subTitleColor;
            document.getElementById('subTitleColorCode').value = subTitleColor;
            document.getElementById('subTitleSize').value = subTitleSize;
            document.getElementById('subTitleSizeValue').textContent = subTitleSize + 'rem';

            const profileImg = document.getElementById('profileImg');
            if (profileImg.style.display !== 'none') {
                document.getElementById('profileImagePreview').src = profileImg.src;
                document.getElementById('profileImagePreview').style.display = 'block';
                document.getElementById('profileImagePlaceholder').style.display = 'none';
                document.getElementById('profileImageRemoveBtn').style.display = 'block';
            } else {
                document.getElementById('profileImagePreview').style.display = 'none';
                document.getElementById('profileImagePlaceholder').style.display = 'flex';
                document.getElementById('profileImageRemoveBtn').style.display = 'none';
            }
            
            openModal('profileModal');
        }

        async function saveProfile() {
            const title = document.getElementById('profileTitle').value.trim() || 'PORTFOLIO';
            const subtitle = document.getElementById('profileSubtitle').value.trim() || 'GAME DESIGNER';
            
            let imageData = null;
            const preview = document.getElementById('profileImagePreview');
            if (preview.style.display !== 'none' && preview.src) {
                imageData = preview.src.split(',')[1];
            }

            const profile = {
                title,
                subtitle,
                mainTitleColor,
                mainTitleSize,
                subTitleColor,
                subTitleSize,
                image: imageData
            };

            await saveProfileData(profile);
            await loadProfile();
            closeModal('profileModal');
        }

        function selectTitleColor(type, color) {
            if (type === 'main') {
                mainTitleColor = color;
                document.getElementById('mainTitleColorPicker').value = color;
                document.getElementById('mainTitleColorCode').value = color;
            } else {
                subTitleColor = color;
                document.getElementById('subTitleColorPicker').value = color;
                document.getElementById('subTitleColorCode').value = color;
            }
        }

        function handleColorCodeInput(type, value) {
            if (/^#[0-9A-Fa-f]{6}$/.test(value)) {
                selectTitleColor(type, value);
            }
        }

        function updateTitleSizePreview(type, value) {
            if (type === 'main') {
                mainTitleSize = parseFloat(value);
                document.getElementById('mainTitleSizeValue').textContent = value + 'rem';
            } else {
                subTitleSize = parseFloat(value);
                document.getElementById('subTitleSizeValue').textContent = value + 'rem';
            }
        }

        function handleProfileImageSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > MAX_THUMBNAIL_SIZE) {
                alert('ì´ë¯¸ì§€ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                document.getElementById('profileImagePreview').src = e.target.result;
                document.getElementById('profileImagePreview').style.display = 'block';
                document.getElementById('profileImagePlaceholder').style.display = 'none';
                document.getElementById('profileImageRemoveBtn').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        function removeProfileImage() {
            document.getElementById('profileImagePreview').style.display = 'none';
            document.getElementById('profileImagePlaceholder').style.display = 'flex';
            document.getElementById('profileImageRemoveBtn').style.display = 'none';
            document.getElementById('profileImageInput').value = '';
        }

        function handleProfileImagePaste(e) {
            const items = e.clipboardData?.items;
            if (!items) return;

            for (let item of items) {
                if (item.type.indexOf('image') !== -1) {
                    const file = item.getAsFile();
                    if (file.size > MAX_THUMBNAIL_SIZE) {
                        alert('ì´ë¯¸ì§€ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                        return;
                    }
                    const reader = new FileReader();
                    reader.onload = (evt) => {
                        document.getElementById('profileImagePreview').src = evt.target.result;
                        document.getElementById('profileImagePreview').style.display = 'block';
                        document.getElementById('profileImagePlaceholder').style.display = 'none';
                        document.getElementById('profileImageRemoveBtn').style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                    e.preventDefault();
                    break;
                }
            }
        }

        // ============ ìê¸°ì†Œê°œ ëª¨ë‹¬ ============
        function openIntroModal() {
            if (!isLoggedIn) return;
            
            document.getElementById('introTextInput').value = document.getElementById('introContent').textContent;
            document.getElementById('introFontSizeSlider').value = currentIntroFontSize;
            document.getElementById('introFontSizeValue').textContent = currentIntroFontSize + 'rem';
            
            document.querySelectorAll('.align-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('align' + currentIntroAlign.charAt(0).toUpperCase() + currentIntroAlign.slice(1)).classList.add('active');
            
            document.getElementById('boldOff').classList.toggle('active', !currentIntroBold);
            document.getElementById('boldOn').classList.toggle('active', currentIntroBold);
            
            openModal('introModal');
        }

        function setIntroAlign(align) {
            currentIntroAlign = align;
            document.querySelectorAll('.align-btn').forEach(btn => btn.classList.remove('active'));
            document.getElementById('align' + align.charAt(0).toUpperCase() + align.slice(1)).classList.add('active');
        }

        function updateIntroFontSizePreview(value) {
            currentIntroFontSize = parseFloat(value);
            document.getElementById('introFontSizeValue').textContent = value + 'rem';
        }

        function setIntroBold(bold) {
            currentIntroBold = bold;
            document.getElementById('boldOff').classList.toggle('active', !bold);
            document.getElementById('boldOn').classList.toggle('active', bold);
        }

        async function saveIntro() {
            const text = document.getElementById('introTextInput').value.trim();
            
            const introData = {
                text,
                align: currentIntroAlign,
                fontSize: currentIntroFontSize,
                bold: currentIntroBold
            };

            await saveIntroData(introData);
            await loadIntro();
            closeModal('introModal');
        }

        // ============ Footer ëª¨ë‹¬ ============
        // ============ ì‚¬ì´íŠ¸ íƒ€ì´í‹€ ============
        function openSiteTitleModal() {
            if (!isLoggedIn) return;
            document.getElementById('siteTitleInput').value = document.getElementById('siteTitle').textContent;
            openModal('siteTitleModal');
        }

        async function saveSiteTitle() {
            const title = document.getElementById('siteTitleInput').value.trim() || 'PORTFOLIO';
            document.getElementById('siteTitle').textContent = title;
            
            // Firebaseì— ì €ì¥
            try {
                await database.ref('settings/siteTitle').set(title);
            } catch (error) {
                console.error('ì‚¬ì´íŠ¸ íƒ€ì´í‹€ ì €ì¥ ì˜¤ë¥˜:', error);
            }
            
            closeModal('siteTitleModal');
        }

        async function loadSiteTitle() {
            try {
                const snapshot = await database.ref('settings/siteTitle').once('value');
                const title = snapshot.val();
                if (title) {
                    document.getElementById('siteTitle').textContent = title;
                }
            } catch (error) {
                console.error('ì‚¬ì´íŠ¸ íƒ€ì´í‹€ ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }

        // ============ ë‹¤ìš´ë¡œë“œ ì„¤ì • ============
        async function loadDownloadSettings() {
            try {
                const snapshot = await database.ref('settings/downloadEnabled').once('value');
                const enabled = snapshot.val();
                downloadEnabled = enabled === true;
                updateDownloadUI();
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì„¤ì • ë¡œë“œ ì˜¤ë¥˜:', error);
            }
        }

        async function setDownloadEnabled(enabled) {
            try {
                downloadEnabled = enabled;
                await database.ref('settings/downloadEnabled').set(enabled);
                updateDownloadUI();
                // ì¹´ë“œ ë‹¤ì‹œ ë Œë”ë§í•˜ì—¬ ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
                await renderAllSections();
            } catch (error) {
                console.error('ë‹¤ìš´ë¡œë“œ ì„¤ì • ì €ì¥ ì˜¤ë¥˜:', error);
                alert('ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function updateDownloadUI() {
            const downloadOff = document.getElementById('downloadOff');
            const downloadOn = document.getElementById('downloadOn');
            if (downloadOff && downloadOn) {
                downloadOff.classList.toggle('active', !downloadEnabled);
                downloadOn.classList.toggle('active', downloadEnabled);
            }
        }

        // ============ ì—°ë½ì²˜ ìˆ˜ì •/ì¶”ê°€ ============
        let editingContactIndex = -1;

        async function openContactEditModal(index) {
            if (!isLoggedIn) return;
            
            // ìºì‹œëœ ë°ì´í„° ì‚¬ìš© (ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©ëœ ë°ì´í„°)
            if (!cachedFooterData || !cachedFooterData.contacts) {
                await loadFooter();
            }
            
            const contacts = cachedFooterData?.contacts || [];
            const contact = contacts[index];
            
            if (!contact) {
                console.error('ì—°ë½ì²˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. index:', index);
                return;
            }
            
            editingContactIndex = index;
            
            document.getElementById('contactEditTitle').textContent = 'âœï¸ ì—°ë½ì²˜ ìˆ˜ì •';
            document.getElementById('contactEditIndex').value = index;
            document.getElementById('contactEditLabel').value = contact.label || '';
            document.getElementById('contactEditValue').value = contact.value || '';
            document.getElementById('contactEditLink').value = contact.link || '';
            document.getElementById('contactEditIcon').value = contact.icon || 'ğŸ“§';
            
            // ì•„ì´ì½˜ ì„ íƒê¸° ë Œë”ë§
            renderIconPicker('contactEditIconPicker', contact.icon || 'ğŸ“§');
            
            // ì‚­ì œ ë²„íŠ¼ í‘œì‹œ
            document.getElementById('contactDeleteBtn').style.display = 'block';
            
            openModal('contactEditModal');
        }

        async function saveContactEdit() {
            const index = parseInt(document.getElementById('contactEditIndex').value);
            const icon = document.getElementById('contactEditIcon').value;
            const label = document.getElementById('contactEditLabel').value.trim();
            const value = document.getElementById('contactEditValue').value.trim();
            const link = document.getElementById('contactEditLink').value.trim();
            
            if (!label || !value) {
                alert('í•­ëª© ì´ë¦„ê³¼ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ìºì‹œëœ ë°ì´í„° ì‚¬ìš©
            if (!cachedFooterData) {
                cachedFooterData = {};
            }
            if (!cachedFooterData.contacts) {
                cachedFooterData.contacts = [];
            }
            
            cachedFooterData.contacts[index] = { icon, label, value, link };
            
            await saveFooterData(cachedFooterData);
            await loadFooter();
            closeModal('contactEditModal');
        }

        async function deleteContactItem() {
            if (!confirm('ì´ ì—°ë½ì²˜ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            const index = parseInt(document.getElementById('contactEditIndex').value);
            
            if (cachedFooterData && cachedFooterData.contacts) {
                cachedFooterData.contacts.splice(index, 1);
                await saveFooterData(cachedFooterData);
                await loadFooter();
            }
            
            closeModal('contactEditModal');
        }

        function openContactAddModal() {
            if (!isLoggedIn) return;
            
            document.getElementById('contactAddLabel').value = '';
            document.getElementById('contactAddValue').value = '';
            document.getElementById('contactAddLink').value = '';
            document.getElementById('contactAddIcon').value = 'ğŸ“§';
            
            // ì•„ì´ì½˜ ì„ íƒê¸° ë Œë”ë§
            renderIconPicker('contactAddIconPicker', 'ğŸ“§');
            
            openModal('contactAddModal');
        }

        async function saveContactAdd() {
            const icon = document.getElementById('contactAddIcon').value;
            const label = document.getElementById('contactAddLabel').value.trim();
            const value = document.getElementById('contactAddValue').value.trim();
            const link = document.getElementById('contactAddLink').value.trim();
            
            if (!label || !value) {
                alert('í•­ëª© ì´ë¦„ê³¼ ê°’ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ìºì‹œëœ ë°ì´í„° ì‚¬ìš©
            if (!cachedFooterData) {
                cachedFooterData = {};
            }
            if (!cachedFooterData.contacts) {
                cachedFooterData.contacts = [];
            }
            
            cachedFooterData.contacts.push({ icon, label, value, link });
            
            await saveFooterData(cachedFooterData);
            await loadFooter();
            closeModal('contactAddModal');
        }

        // ============ ì„¹ì…˜ ê´€ë ¨ ============
        let editingSectionId = null;

        function openSectionModal(sectionId = null) {
            if (!isLoggedIn) return;
            
            editingSectionId = sectionId;
            
            if (sectionId) {
                document.getElementById('sectionModalTitle').textContent = 'âœï¸ ì„¹ì…˜ ìˆ˜ì •';
                document.getElementById('deleteSectionBtn').style.display = 'block';
                
                getSections().then(sections => {
                    const section = sections.find(s => s.id === sectionId);
                    if (section) {
                        document.getElementById('sectionIcon').value = section.icon;
                        document.getElementById('sectionTitle').value = section.title;
                        document.getElementById('sectionSubtitle').value = section.subtitle;
                        document.querySelector(`input[name="sectionColor"][value="${section.color}"]`).checked = true;
                    }
                });
            } else {
                document.getElementById('sectionModalTitle').textContent = 'ğŸ“ ìƒˆ ì„¹ì…˜ ì¶”ê°€';
                document.getElementById('deleteSectionBtn').style.display = 'none';
                document.getElementById('sectionIcon').value = 'ğŸ“„';
                document.getElementById('sectionTitle').value = '';
                document.getElementById('sectionSubtitle').value = '';
                document.querySelector('input[name="sectionColor"][value="blue"]').checked = true;
            }
            
            openModal('sectionModal');
        }

        async function saveSection() {
            const icon = document.getElementById('sectionIcon').value || 'ğŸ“„';
            const title = document.getElementById('sectionTitle').value.trim();
            const subtitle = document.getElementById('sectionSubtitle').value.trim();
            const color = document.querySelector('input[name="sectionColor"]:checked').value;
            const errorEl = document.getElementById('sectionError');

            if (!title) {
                errorEl.textContent = 'ì„¹ì…˜ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            const sections = await getSections();
            
            if (editingSectionId) {
                const section = sections.find(s => s.id === editingSectionId);
                if (section) {
                    section.icon = icon;
                    section.title = title;
                    section.subtitle = subtitle;
                    section.color = color;
                    await saveSectionData(section);
                }
            } else {
                const newId = 'section_' + Date.now();
                const newSection = {
                    id: newId,
                    icon,
                    title,
                    subtitle,
                    color,
                    order: sections.length
                };
                await saveSectionData(newSection);
            }

            closeModal('sectionModal');
            await renderSectionsAndNav();
            await renderAllSections();
        }

        async function deleteSection() {
            if (!editingSectionId) return;
            if (!confirm('ì´ ì„¹ì…˜ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            await deleteSectionData(editingSectionId);
            closeModal('sectionModal');
            await renderSectionsAndNav();
            await renderAllSections();
        }

        // ============ í•„í„°ë§ ============
        function setFilter(filter) {
            currentFilter = filter;
            document.querySelectorAll('.section-nav-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === filter);
            });
            updateSectionVisibility();
            setupHorizontalScroll();
        }

        function updateSectionVisibility() {
            const sectionsContainer = document.getElementById('sectionsContainer');
            
            // ë‹¨ì¼ ì„¹ì…˜ ëª¨ë“œ í´ë˜ìŠ¤ í† ê¸€
            if (currentFilter === 'all') {
                sectionsContainer.classList.remove('single-section-mode');
            } else {
                sectionsContainer.classList.add('single-section-mode');
            }

            document.querySelectorAll('.section').forEach(section => {
                if (currentFilter === 'all') {
                    section.style.display = 'block';
                } else {
                    section.style.display = section.id === currentFilter ? 'block' : 'none';
                }
            });

            const addSectionBtn = document.getElementById('addSectionBtn');
            if (addSectionBtn) {
                addSectionBtn.style.display = (isLoggedIn && currentFilter === 'all') ? 'block' : 'none';
            }
        }

        // ============ í•­ëª© ì¶”ê°€ ============
        function openAddModal(category) {
            if (!isLoggedIn) return;
            
            resetAddForm();
            document.getElementById('addCategory').value = category;
            
            getSections().then(sections => {
                const section = sections.find(s => s.id === category);
                if (section) {
                    document.getElementById('addModalTitle').textContent = `${section.icon} ${section.title}ì— ì¶”ê°€`;
                }
            });
            
            openModal('addModal');
        }

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) handleFile(file);
        }

        async function handleFolderSelect(event) {
            const files = Array.from(event.target.files);
            if (files.length === 0) return;

            // ì „ì²´ í´ë” í¬ê¸° ê³„ì‚°
            const totalSize = files.reduce((sum, file) => sum + file.size, 0);

            // í´ë” í¬ê¸° ê²€ì¦
            if (totalSize > MAX_FOLDER_SIZE) {
                alert(`í´ë” ì „ì²´ í¬ê¸°ëŠ” ${formatFileSize(MAX_FOLDER_SIZE)} ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.\ní˜„ì¬ í¬ê¸°: ${formatFileSize(totalSize)}`);
                event.target.value = '';
                return;
            }

            // í´ë” ì´ë¦„ ì¶”ì¶œ (ì²« ë²ˆì§¸ íŒŒì¼ì˜ ê²½ë¡œì—ì„œ)
            const folderPath = files[0].webkitRelativePath;
            const folderName = folderPath.split('/')[0];

            // index.html íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸ (Unity WebGL ë¹Œë“œ ê°ì§€)
            const hasIndexHtml = files.some(f =>
                f.name === 'index.html' || f.webkitRelativePath.endsWith('/index.html')
            );

            selectedFolder = {
                name: folderName,
                files: files,
                totalSize: totalSize,
                isWebGL: hasIndexHtml
            };
            selectedFile = null; // í´ë” ì„ íƒ ì‹œ ë‹¨ì¼ íŒŒì¼ ì´ˆê¸°í™”

            const icon = hasIndexHtml ? 'ğŸ®' : 'ğŸ“';
            const typeLabel = hasIndexHtml ? 'Unity WebGL' : 'í´ë”';

            document.getElementById('filePreviewIcon').textContent = icon;
            document.getElementById('filePreviewName').textContent = `${folderName} (${files.length}ê°œ íŒŒì¼ - ${typeLabel})`;
            document.getElementById('filePreviewSize').textContent = formatFileSize(totalSize);
            document.getElementById('filePreview').classList.add('show');
        }

        function handleFile(file) {
            if (file.size > MAX_FILE_SIZE) {
                alert(`íŒŒì¼ í¬ê¸°ëŠ” ${formatFileSize(MAX_FILE_SIZE)} ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.\ní˜„ì¬ í¬ê¸°: ${formatFileSize(file.size)}`);
                return;
            }

            selectedFile = file;
            selectedFolder = null; // íŒŒì¼ ì„ íƒ ì‹œ í´ë” ì´ˆê¸°í™”
            const ext = file.name.split('.').pop().toLowerCase();

            document.getElementById('filePreviewIcon').textContent = getFileTypeIcon(ext);
            document.getElementById('filePreviewName').textContent = file.name;
            document.getElementById('filePreviewSize').textContent = formatFileSize(file.size);
            document.getElementById('filePreview').classList.add('show');
        }

        function removeFile() {
            selectedFile = null;
            selectedFolder = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('folderInput').value = '';
            document.getElementById('filePreview').classList.remove('show');
        }

        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        function handleThumbnailSelect(event) {
            const file = event.target.files[0];
            if (!file) return;
            handleThumbnailFile(file);
        }

        function handleThumbnailFile(file) {
            if (file.size > MAX_THUMBNAIL_SIZE) {
                alert('ì¸ë„¤ì¼ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                selectedThumbnail = e.target.result.split(',')[1];
                document.getElementById('thumbnailPreviewImg').src = e.target.result;
                document.getElementById('thumbnailPreviewImg').style.display = 'block';
                document.getElementById('thumbnailPlaceholder').style.display = 'none';
                document.getElementById('thumbnailRemoveBtn').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        function handleThumbnailPaste(e) {
            const items = e.clipboardData?.items;
            if (!items) return;

            for (let item of items) {
                if (item.type.indexOf('image') !== -1) {
                    const file = item.getAsFile();
                    if (file.size > MAX_THUMBNAIL_SIZE) {
                        alert('ì´ë¯¸ì§€ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                        return;
                    }
                    const reader = new FileReader();
                    reader.onload = (evt) => {
                        selectedThumbnail = evt.target.result.split(',')[1];
                        document.getElementById('thumbnailPreviewImg').src = evt.target.result;
                        document.getElementById('thumbnailPreviewImg').style.display = 'block';
                        document.getElementById('thumbnailPlaceholder').style.display = 'none';
                        document.getElementById('thumbnailRemoveBtn').style.display = 'block';
                    };
                    reader.readAsDataURL(file);
                    e.preventDefault();
                    break;
                }
            }
        }

        function removeThumbnail() {
            selectedThumbnail = null;
            document.getElementById('thumbnailInput').value = '';
            document.getElementById('thumbnailPreviewImg').style.display = 'none';
            document.getElementById('thumbnailPlaceholder').style.display = 'flex';
            document.getElementById('thumbnailRemoveBtn').style.display = 'none';
        }

        // íƒœê·¸
        function addTag(containerId, inputId, type) {
            const input = document.getElementById(inputId);
            const tag = input.value.trim();
            
            if (!tag) return;
            
            const tagsArray = type === 'current' ? currentTags : editTags;
            if (tagsArray.includes(tag)) {
                input.value = '';
                return;
            }
            
            tagsArray.push(tag);
            renderTags(containerId, tagsArray, type);
            input.value = '';
        }

        function removeTag(index, containerId, type) {
            const tagsArray = type === 'current' ? currentTags : editTags;
            tagsArray.splice(index, 1);
            renderTags(containerId, tagsArray, type);
        }

        function renderTags(containerId, tags, type) {
            const container = document.getElementById(containerId);
            const input = container.querySelector('.tag-input');
            
            container.innerHTML = '';
            tags.forEach((tag, index) => {
                const tagEl = document.createElement('div');
                tagEl.className = 'tag-item';
                tagEl.innerHTML = `
                    ${tag}
                    <button class="tag-remove" onclick="removeTag(${index}, '${containerId}', '${type}')">Ã—</button>
                `;
                container.appendChild(tagEl);
            });
            container.appendChild(input);
        }

        async function saveItem() {
            const category = document.getElementById('addCategory').value;
            const title = document.getElementById('itemTitle').value.trim();
            const description = document.getElementById('itemDesc').value.trim();
            const date = document.getElementById('itemDate').value;
            const link = document.getElementById('itemLink').value.trim();
            const errorEl = document.getElementById('addError');

            console.log('í•­ëª© ì €ì¥ ì‹œë„:', { category, title, selectedFile: selectedFile ? selectedFile.name : null, selectedFolder: selectedFolder ? selectedFolder.name : null, link });

            if (!title) {
                errorEl.textContent = 'ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            if (!selectedFile && !selectedFolder && !link) {
                errorEl.textContent = 'íŒŒì¼, í´ë”ë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ ë§í¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            const saveBtn = document.getElementById('saveBtn');
            saveBtn.disabled = true;
            saveBtn.textContent = 'ì €ì¥ ì¤‘...';

            try {
                const itemId = 'item_' + Date.now();
                let fileId = null;
                let fileType = 'link';
                let mimeType = null;
                let fileName = null;
                let folderData = null;

                // í´ë” ì—…ë¡œë“œ ì²˜ë¦¬ (Firebase Storage)
                if (selectedFolder) {
                    console.log('í´ë” ì—…ë¡œë“œ ì‹œì‘:', selectedFolder.name);
                    document.getElementById('uploadProgress').classList.add('show');

                    fileId = itemId;
                    fileType = 'folder';
                    fileName = selectedFolder.name;

                    // Firebase Storageì— í´ë” ì €ì¥ (ì›ë³¸ íŒŒì¼ ê·¸ëŒ€ë¡œ)
                    await saveFolder(itemId, selectedFolder.files, (completed, total) => {
                        const progress = Math.round((completed / total) * 100);
                        document.getElementById('progressFill').style.width = progress + '%';
                        document.getElementById('progressText').textContent = `ì—…ë¡œë“œ ì¤‘... ${progress}% (${completed}/${total})`;
                    });

                    console.log('í´ë” ì €ì¥ ì™„ë£Œ');
                    document.getElementById('progressFill').style.width = '100%';
                    document.getElementById('progressText').textContent = 'ì—…ë¡œë“œ ì™„ë£Œ!';
                }
                // ë‹¨ì¼ íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬ (Firebase Storage)
                else if (selectedFile) {
                    console.log('íŒŒì¼ ì—…ë¡œë“œ ì‹œì‘:', selectedFile.name);
                    document.getElementById('uploadProgress').classList.add('show');

                    fileId = itemId;
                    fileType = selectedFile.name.split('.').pop().toLowerCase();
                    mimeType = selectedFile.type;
                    fileName = selectedFile.name;

                    // Firebase Storageì— íŒŒì¼ ì €ì¥ (File ê°ì²´ ê·¸ëŒ€ë¡œ)
                    await saveFile(fileId, selectedFile, { contentType: mimeType });
                    console.log('íŒŒì¼ ì €ì¥ ì™„ë£Œ');

                    document.getElementById('progressFill').style.width = '100%';
                    document.getElementById('progressText').textContent = 'ì—…ë¡œë“œ ì™„ë£Œ!';
                }

                if (selectedThumbnail) {
                    await saveFile(itemId + '_thumb', selectedThumbnail);
                    console.log('ì¸ë„¤ì¼ ì €ì¥ ì™„ë£Œ');
                }

                const data = await getAllMetadata();
                const items = data[category] || [];

                const item = {
                    id: itemId,
                    category,
                    title,
                    description,
                    date,
                    link: (selectedFile || selectedFolder) ? null : link,
                    fileId,
                    fileType,
                    mimeType,
                    fileName,
                    thumbnail: selectedThumbnail,
                    tags: currentTags,
                    order: items.length,
                    createdAt: Date.now(),
                    isWebGL: selectedFolder ? selectedFolder.isWebGL : false
                };

                console.log('ë©”íƒ€ë°ì´í„° ì €ì¥:', item);
                console.log('  - fileId:', item.fileId);
                console.log('  - fileType:', item.fileType);
                console.log('  - mimeType:', item.mimeType);
                
                await saveMetadata(item);
                console.log('ë©”íƒ€ë°ì´í„° ì €ì¥ ì™„ë£Œ');
                
                // ìºì‹œì— ì¦‰ì‹œ ì¶”ê°€
                itemsCache[item.id] = item;
                console.log('ìºì‹œì— í•­ëª© ì¶”ê°€ë¨:', item.id);
                
                closeModal('addModal');
                await renderSectionsAndNav();
                await renderAllSections();
                console.log('í™”ë©´ ê°±ì‹  ì™„ë£Œ');

            } catch (error) {
                console.error('Save error:', error);
                errorEl.textContent = 'ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                errorEl.classList.add('show');
            } finally {
                saveBtn.disabled = false;
                saveBtn.textContent = 'ì €ì¥';
            }
        }

        function fileToBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result.split(',')[1]);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        function resetAddForm() {
            document.getElementById('itemTitle').value = '';
            document.getElementById('itemDesc').value = '';
            // í˜„ì¬ ë‚ ì§œ(ì›”ê¹Œì§€)ë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
            const now = new Date();
            const year = now.getFullYear();
            const month = String(now.getMonth() + 1).padStart(2, '0');
            document.getElementById('itemDate').value = `${year}-${month}`;
            document.getElementById('itemLink').value = '';
            currentTags = [];
            renderTags('tagsContainer', currentTags, 'current');
            removeFile();
            removeThumbnail();
            document.getElementById('uploadProgress').classList.remove('show');
        }

        // ============ í•­ëª© ìˆ˜ì • ============
        let editNewFile = null;

        async function openEditModal(itemId, category) {
            if (!isLoggedIn) return;
            
            resetEditForm();
            
            const snapshot = await database.ref('metadata/' + itemId).once('value');
            const item = snapshot.val();
            
            if (!item) return;

            document.getElementById('editItemId').value = itemId;
            document.getElementById('editCategory').value = category;
            document.getElementById('editTitle').value = item.title || '';
            document.getElementById('editDesc').value = item.description || '';
            // ë‚ ì§œê°€ ì—†ìœ¼ë©´ í˜„ì¬ ë‚ ì§œë¡œ ì„¤ì •
            if (item.date) {
                document.getElementById('editDate').value = item.date;
            } else {
                const now = new Date();
                const year = now.getFullYear();
                const month = String(now.getMonth() + 1).padStart(2, '0');
                document.getElementById('editDate').value = `${year}-${month}`;
            }
            
            editTags = item.tags || [];
            renderTags('editTagsContainer', editTags, 'edit');

            if (item.thumbnail) {
                document.getElementById('editThumbnailPreviewImg').src = 'data:image/jpeg;base64,' + item.thumbnail;
                document.getElementById('editThumbnailPreviewImg').style.display = 'block';
                document.getElementById('editThumbnailPlaceholder').style.display = 'none';
                document.getElementById('editThumbnailRemoveBtn').style.display = 'block';
                editThumbnail = item.thumbnail;
            }

            if (item.fileName) {
                document.getElementById('editCurrentFile').style.display = 'block';
                document.getElementById('editCurrentFileName').textContent = item.fileName;
            }

            openModal('editModal');
        }

        function handleEditThumbnailSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > MAX_THUMBNAIL_SIZE) {
                alert('ì¸ë„¤ì¼ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                editThumbnail = e.target.result.split(',')[1];
                editThumbnailChanged = true;
                document.getElementById('editThumbnailPreviewImg').src = e.target.result;
                document.getElementById('editThumbnailPreviewImg').style.display = 'block';
                document.getElementById('editThumbnailPlaceholder').style.display = 'none';
                document.getElementById('editThumbnailRemoveBtn').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        function handleEditThumbnailFile(file) {
            if (file.size > MAX_THUMBNAIL_SIZE) {
                alert('ì´ë¯¸ì§€ í¬ê¸°ëŠ” 2MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }
            const reader = new FileReader();
            reader.onload = (evt) => {
                editThumbnail = evt.target.result.split(',')[1];
                editThumbnailChanged = true;
                document.getElementById('editThumbnailPreviewImg').src = evt.target.result;
                document.getElementById('editThumbnailPreviewImg').style.display = 'block';
                document.getElementById('editThumbnailPlaceholder').style.display = 'none';
                document.getElementById('editThumbnailRemoveBtn').style.display = 'block';
            };
            reader.readAsDataURL(file);
        }

        function handleEditThumbnailPaste(e) {
            const items = e.clipboardData?.items;
            if (!items) return;

            for (let item of items) {
                if (item.type.indexOf('image') !== -1) {
                    const file = item.getAsFile();
                    handleEditThumbnailFile(file);
                    e.preventDefault();
                    break;
                }
            }
        }

        function removeEditThumbnail() {
            editThumbnail = null;
            editThumbnailChanged = true;
            editThumbnailRemoved = true;
            document.getElementById('editThumbnailInput').value = '';
            document.getElementById('editThumbnailPreviewImg').style.display = 'none';
            document.getElementById('editThumbnailPlaceholder').style.display = 'flex';
            document.getElementById('editThumbnailRemoveBtn').style.display = 'none';
        }

        function handleEditFileSelect(event) {
            const file = event.target.files[0];
            if (!file) return;

            if (file.size > MAX_FILE_SIZE) {
                alert(`íŒŒì¼ í¬ê¸°ëŠ” ${formatFileSize(MAX_FILE_SIZE)} ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.\ní˜„ì¬ í¬ê¸°: ${formatFileSize(file.size)}`);
                event.target.value = '';
                return;
            }

            editNewFile = file;
            document.getElementById('editNewFileName').textContent = file.name;
            document.getElementById('editNewFileInfo').style.display = 'block';
        }

        function cancelEditFile() {
            editNewFile = null;
            document.getElementById('editFileInput').value = '';
            document.getElementById('editNewFileInfo').style.display = 'none';
        }

        async function updateItem() {
            const itemId = document.getElementById('editItemId').value;
            const title = document.getElementById('editTitle').value.trim();
            const description = document.getElementById('editDesc').value.trim();
            const date = document.getElementById('editDate').value;
            const errorEl = document.getElementById('editError');

            if (!title) {
                errorEl.textContent = 'ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            try {
                const snapshot = await database.ref('metadata/' + itemId).once('value');
                const item = snapshot.val();
                
                item.title = title;
                item.description = description;
                item.date = date;
                item.tags = editTags;

                if (editThumbnailChanged) {
                    if (editThumbnailRemoved) {
                        item.thumbnail = null;
                        await deleteFile(itemId + '_thumb');
                    } else if (editThumbnail) {
                        item.thumbnail = editThumbnail;
                        await saveFile(itemId + '_thumb', editThumbnail);
                    }
                }

                if (editNewFile) {
                    if (item.fileId) {
                        await deleteFile(item.fileId);
                    }
                    
                    const base64 = await fileToBase64(editNewFile);
                    await saveFile(itemId, base64);
                    
                    item.fileId = itemId;
                    item.fileType = editNewFile.name.split('.').pop().toLowerCase();
                    item.mimeType = editNewFile.type;
                    item.fileName = editNewFile.name;
                }

                await saveMetadata(item);
                closeModal('editModal');
                await renderSectionsAndNav();
                await renderAllSections();

            } catch (error) {
                console.error('Update error:', error);
                errorEl.textContent = 'ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                errorEl.classList.add('show');
            }
        }

        async function deleteItem() {
            if (!confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const itemId = document.getElementById('editItemId').value;

            try {
                await deleteMetadata(itemId);
                await deleteFile(itemId);
                await deleteFile(itemId + '_thumb');
                
                closeModal('editModal');
                await renderSectionsAndNav();
                await renderAllSections();
            } catch (error) {
                console.error('Delete error:', error);
                alert('ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function resetEditForm() {
            editTags = [];
            editThumbnail = null;
            editThumbnailChanged = false;
            editThumbnailRemoved = false;
            editNewFile = null;
            document.getElementById('editFileInput').value = '';
            document.getElementById('editNewFileInfo').style.display = 'none';
            document.getElementById('editCurrentFile').style.display = 'none';
            document.getElementById('editThumbnailPreviewImg').style.display = 'none';
            document.getElementById('editThumbnailPlaceholder').style.display = 'flex';
            document.getElementById('editThumbnailRemoveBtn').style.display = 'none';
        }

        // ============ ë“œë˜ê·¸ì•¤ë“œë¡­ ============
        function setupDragAndDrop(card, category, itemId) {
            const handle = card.querySelector('.drag-handle');
            if (!handle) return;

            handle.addEventListener('mousedown', () => {
                if (isLoggedIn) card.draggable = true;
            });

            card.addEventListener('dragstart', (e) => {
                if (!isLoggedIn) {
                    e.preventDefault();
                    return;
                }
                draggedItem = { element: card, category, itemId };
                card.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
            });

            card.addEventListener('dragend', () => {
                card.draggable = false;
                card.classList.remove('dragging');
                draggedItem = null;
                document.querySelectorAll('.drag-over').forEach(el => el.classList.remove('drag-over'));
            });

            card.addEventListener('dragover', (e) => {
                e.preventDefault();
                if (!draggedItem || !isLoggedIn) return;
                card.classList.add('drag-over');
            });

            card.addEventListener('dragleave', () => {
                card.classList.remove('drag-over');
            });

            card.addEventListener('drop', async (e) => {
                e.preventDefault();
                card.classList.remove('drag-over');
                
                if (!draggedItem || !isLoggedIn) return;
                if (draggedItem.element === card) return;

                const sourceCategory = draggedItem.category;
                const targetCategory = card.dataset.category;
                const targetGrid = card.parentElement;

                if (sourceCategory === targetCategory) {
                    const cards = Array.from(targetGrid.querySelectorAll('.portfolio-card'));
                    const draggedIndex = cards.indexOf(draggedItem.element);
                    const dropIndex = cards.indexOf(card);

                    if (draggedIndex < dropIndex) {
                        card.after(draggedItem.element);
                    } else {
                        card.before(draggedItem.element);
                    }

                    await saveNewOrder(sourceCategory);
                } else {
                    card.before(draggedItem.element);
                    draggedItem.element.dataset.category = targetCategory;

                    await moveItemToSection(draggedItem.itemId, sourceCategory, targetCategory);
                    await saveNewOrder(sourceCategory);
                    await saveNewOrder(targetCategory);
                    await updateSectionCounts();
                }
            });
        }

        async function moveItemToSection(itemId, fromCategory, toCategory) {
            try {
                const snapshot = await database.ref('metadata/' + itemId).once('value');
                const item = snapshot.val();
                if (item) {
                    item.category = toCategory;
                    await database.ref('metadata/' + itemId).set(item);
                }
            } catch (error) {
                console.error('moveItemToSection error:', error);
            }
        }

        async function updateSectionCounts() {
            const sections = await getSections();
            const data = await getAllMetadata();

            sections.forEach(section => {
                const count = (data[section.id] || []).length;
                const countEl = document.getElementById(`sectionCount-${section.id}`);
                if (countEl) countEl.textContent = `(${count})`;

                const navCountEl = document.getElementById(`navCount-${section.id}`);
                if (navCountEl) navCountEl.textContent = count;
            });

            const totalCount = sections.reduce((sum, s) => sum + (data[s.id] || []).length, 0);
            const totalNavCount = document.querySelector('.section-nav-btn[data-filter="all"] .section-nav-count');
            if (totalNavCount) totalNavCount.textContent = totalCount;
        }

        async function saveNewOrder(category) {
            const grid = document.getElementById(`grid-${category}`);
            const cards = Array.from(grid.querySelectorAll('.portfolio-card'));
            const data = await getAllMetadata();
            const items = data[category] || [];

            for (let i = 0; i < cards.length; i++) {
                const itemId = cards[i].dataset.itemId;
                const item = items.find(it => it.id === itemId);
                if (item) {
                    item.order = i;
                    await saveMetadata(item);
                }
            }
        }

        // ì„¹ì…˜ ë“œë˜ê·¸ì•¤ë“œë¡­
        function setupSectionDragAndDrop() {
            document.querySelectorAll('.section').forEach(section => {
                const handle = section.querySelector('.section-drag-handle');
                if (!handle) return;

                handle.addEventListener('mousedown', () => {
                    if (isLoggedIn) section.draggable = true;
                });

                section.addEventListener('dragstart', (e) => {
                    if (!isLoggedIn) {
                        e.preventDefault();
                        return;
                    }
                    section.classList.add('dragging');
                    e.dataTransfer.effectAllowed = 'move';
                });

                section.addEventListener('dragend', () => {
                    section.draggable = false;
                    section.classList.remove('dragging');
                    document.querySelectorAll('.drag-over-section').forEach(el => el.classList.remove('drag-over-section'));
                });

                section.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    if (!isLoggedIn) return;
                    const dragging = document.querySelector('.section.dragging');
                    if (dragging && dragging !== section) {
                        section.classList.add('drag-over-section');
                    }
                });

                section.addEventListener('dragleave', () => {
                    section.classList.remove('drag-over-section');
                });

                section.addEventListener('drop', async (e) => {
                    e.preventDefault();
                    section.classList.remove('drag-over-section');
                    
                    if (!isLoggedIn) return;
                    
                    const dragging = document.querySelector('.section.dragging');
                    if (dragging && dragging !== section) {
                        const container = section.parentElement;
                        const sections = Array.from(container.querySelectorAll('.section'));
                        const draggedIndex = sections.indexOf(dragging);
                        const dropIndex = sections.indexOf(section);

                        if (draggedIndex < dropIndex) {
                            section.after(dragging);
                        } else {
                            section.before(dragging);
                        }

                        await saveSectionOrder();
                    }
                });
            });
        }

        async function saveSectionOrder() {
            const container = document.getElementById('sectionsContainer');
            const sectionEls = Array.from(container.querySelectorAll('.section'));
            const sections = await getSections();

            for (let i = 0; i < sectionEls.length; i++) {
                const sectionId = sectionEls[i].dataset.sectionId;
                const section = sections.find(s => s.id === sectionId);
                if (section) {
                    section.order = i;
                    await saveSectionData(section);
                }
            }
        }

        // ============ UI ì—…ë°ì´íŠ¸ ============
        function updateUI() {
            document.querySelectorAll('.add-card').forEach(card => {
                card.classList.toggle('show', isLoggedIn);
            });
            document.querySelectorAll('.card-edit-btn').forEach(btn => {
                btn.classList.toggle('show', isLoggedIn);
            });
            document.querySelectorAll('.drag-handle').forEach(handle => {
                handle.classList.toggle('show', isLoggedIn);
            });
            document.querySelectorAll('.section-drag-handle').forEach(handle => {
                handle.classList.toggle('show', isLoggedIn);
            });
            document.querySelectorAll('.section-edit-btn').forEach(btn => {
                btn.classList.toggle('show', isLoggedIn);
            });
            document.querySelectorAll('.profile-edit-btn').forEach(btn => {
                btn.classList.toggle('show', isLoggedIn);
            });
            
            updateSectionVisibility();

            const profileImage = document.getElementById('profileImage');
            if (profileImage) profileImage.classList.toggle('editable', isLoggedIn);

            const introText = document.getElementById('introText');
            if (introText) introText.classList.toggle('editable', isLoggedIn);
            
            // ì‚¬ì´íŠ¸ íƒ€ì´í‹€ ìˆ˜ì • ê°€ëŠ¥ ìƒíƒœ
            const siteTitle = document.getElementById('siteTitle');
            if (siteTitle) siteTitle.style.cursor = isLoggedIn ? 'pointer' : 'default';
            
            // ì—°ë½ì²˜ í•­ëª© ìˆ˜ì • ê°€ëŠ¥ ìƒíƒœ
            document.querySelectorAll('.contact-editable').forEach(item => {
                item.style.cursor = isLoggedIn ? 'pointer' : 'default';
            });
            document.querySelectorAll('.contact-edit-icon').forEach(icon => {
                icon.style.display = isLoggedIn ? '' : 'none';
            });
            
            // ì—°ë½ì²˜ ì¶”ê°€ ë²„íŠ¼
            const contactAddBtn = document.getElementById('contactAddBtn');
            if (contactAddBtn) {
                contactAddBtn.style.display = isLoggedIn ? 'block' : 'none';
            }
        }

        // ============ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ============
        function setupEventListeners() {
            document.getElementById('tagInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') { e.preventDefault(); addTag('tagsContainer', 'tagInput', 'current'); }
            });
            document.getElementById('editTagInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') { e.preventDefault(); addTag('editTagsContainer', 'editTagInput', 'edit'); }
            });

            const uploadArea = document.getElementById('fileUploadArea');
            uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('dragover'); });
            uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('dragover'));
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
            });

            const editUploadArea = document.getElementById('editFileUploadArea');
            editUploadArea.addEventListener('dragover', (e) => { e.preventDefault(); editUploadArea.classList.add('dragover'); });
            editUploadArea.addEventListener('dragleave', () => editUploadArea.classList.remove('dragover'));
            editUploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                editUploadArea.classList.remove('dragover');
                if (e.dataTransfer.files.length) {
                    const file = e.dataTransfer.files[0];
                    if (file.size > MAX_FILE_SIZE) {
                        alert(`íŒŒì¼ í¬ê¸°ëŠ” ${formatFileSize(MAX_FILE_SIZE)} ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.\ní˜„ì¬ í¬ê¸°: ${formatFileSize(file.size)}`);
                        return;
                    }
                    editNewFile = file;
                    document.getElementById('editNewFileName').textContent = file.name;
                    document.getElementById('editNewFileInfo').style.display = 'block';
                }
            });

            // ì¸ë„¤ì¼ ë¶™ì—¬ë„£ê¸°
            const thumbnailArea = document.getElementById('thumbnailUploadArea');
            thumbnailArea.addEventListener('paste', handleThumbnailPaste);
            
            // ì¸ë„¤ì¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­
            thumbnailArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                thumbnailArea.classList.add('dragover');
            });
            thumbnailArea.addEventListener('dragleave', () => {
                thumbnailArea.classList.remove('dragover');
            });
            thumbnailArea.addEventListener('drop', (e) => {
                e.preventDefault();
                thumbnailArea.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    handleThumbnailFile(file);
                }
            });

            const editThumbnailArea = document.getElementById('editThumbnailUploadArea');
            editThumbnailArea.addEventListener('paste', handleEditThumbnailPaste);
            
            // ìˆ˜ì • ëª¨ë‹¬ ì¸ë„¤ì¼ ë“œë˜ê·¸ ì•¤ ë“œë¡­
            editThumbnailArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                editThumbnailArea.classList.add('dragover');
            });
            editThumbnailArea.addEventListener('dragleave', () => {
                editThumbnailArea.classList.remove('dragover');
            });
            editThumbnailArea.addEventListener('drop', (e) => {
                e.preventDefault();
                editThumbnailArea.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    handleEditThumbnailFile(file);
                }
            });

            // í”„ë¡œí•„ ì´ë¯¸ì§€ ë¶™ì—¬ë„£ê¸°
            const profileImageUpload = document.getElementById('profileImageUpload');
            profileImageUpload.addEventListener('paste', handleProfileImagePaste);

            // ì „ì—­ ë¶™ì—¬ë„£ê¸°
            document.addEventListener('paste', (e) => {
                const addModal = document.getElementById('addModal');
                const editModal = document.getElementById('editModal');
                const profileModal = document.getElementById('profileModal');

                if (addModal.classList.contains('active')) {
                    handleThumbnailPaste(e);
                } else if (editModal.classList.contains('active')) {
                    handleEditThumbnailPaste(e);
                } else if (profileModal.classList.contains('active')) {
                    handleProfileImagePaste(e);
                }
            });

            document.getElementById('loginEmail').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') document.getElementById('loginPassword').focus();
            });

            document.getElementById('loginPassword').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') login();
            });

            document.getElementById('profileImage').addEventListener('click', () => {
                if (isLoggedIn) openProfileModal();
            });

            document.getElementById('introText').addEventListener('click', () => {
                if (isLoggedIn) openIntroModal();
            });

            // íˆìŠ¤í† ë¦¬ íŒ¨ë„ íœ  ìŠ¤í¬ë¡¤
            const historyList = document.getElementById('historyList');
            historyList.addEventListener('wheel', (e) => {
                // ê¸°ë³¸ ì„¸ë¡œ ìŠ¤í¬ë¡¤ ìœ ì§€
            });
        }


        // ============ ì´ˆê¸°í™” ============
        async function init() {
            try {
                console.log('í¬íŠ¸í´ë¦¬ì˜¤ ì´ˆê¸°í™” ì‹œì‘...');
                checkSession();

                // Service Worker ë“±ë¡ (ë°±ê·¸ë¼ìš´ë“œ)
                registerServiceWorker().catch(err => {
                    console.warn('Service Worker ë“±ë¡ ì‹¤íŒ¨ (WebGL ì‹¤í–‰ ë¶ˆê°€):', err);
                });

                await loadSiteTitle();
                console.log('ì‚¬ì´íŠ¸ íƒ€ì´í‹€ ë¡œë“œ ì™„ë£Œ');
                await loadDownloadSettings();
                console.log('ë‹¤ìš´ë¡œë“œ ì„¤ì • ë¡œë“œ ì™„ë£Œ');
                await loadProfile();
                console.log('í”„ë¡œí•„ ë¡œë“œ ì™„ë£Œ');
                await loadIntro();
                console.log('ìê¸°ì†Œê°œ ë¡œë“œ ì™„ë£Œ');
                await loadFooter();
                console.log('í‘¸í„° ë¡œë“œ ì™„ë£Œ');
                await renderSectionsAndNav();
                console.log('ì„¹ì…˜ ë„¤ë¹„ê²Œì´ì…˜ ë Œë”ë§ ì™„ë£Œ');
                await renderAllSections();
                console.log('ëª¨ë“  ì„¹ì…˜ ë Œë”ë§ ì™„ë£Œ');
                renderHistory();
                setupEventListeners();
                updateUI();
                console.log('í¬íŠ¸í´ë¦¬ì˜¤ ì´ˆê¸°í™” ì™„ë£Œ!');
            } catch (error) {
                console.error('ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
