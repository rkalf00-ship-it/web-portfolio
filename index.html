<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê²Œì„ ê¸°íšì í¬íŠ¸í´ë¦¬ì˜¤</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-main: #f8f6f4;
            --bg-card: #ffffff;
            --bg-section: #fafafa;
            --pastel-gold: #e8d5a3;
            --pastel-gold-light: #f5e6c3;
            --pastel-gold-dark: #c9a86c;
            --pastel-blue: #a8c5e2;
            --pastel-blue-light: #c5daef;
            --pastel-blue-dark: #7ba3c9;
            --pastel-red: #e8a8a8;
            --pastel-red-light: #f2c5c5;
            --pastel-red-dark: #c98a8a;
            --pastel-green: #a8d8b4;
            --pastel-green-light: #c5e8ce;
            --pastel-green-dark: #7cb88e;
            --pastel-purple: #c5a8d8;
            --pastel-purple-light: #dac5e8;
            --pastel-purple-dark: #a87bc2;
            --pastel-pink: #e8b8c8;
            --pastel-mint: #a8d8d8;
            --text-dark: #4a4a4a;
            --text-mid: #6a6a6a;
            --text-light: #9a9a9a;
            --border-light: #e8e8e8;
            --border-mid: #d0d0d0;
            --shadow-soft: rgba(0, 0, 0, 0.06);
            --shadow-mid: rgba(0, 0, 0, 0.1);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #f5f3f0 0%, #ebe7e3 100%);
            min-height: 100vh;
            color: var(--text-dark);
            line-height: 1.6;
        }

        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 60px 24px;
        }

        /* ìƒë‹¨ ë¡œê·¸ì¸ ë°” */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 50px;
            background: var(--bg-card);
            border-bottom: 1px solid var(--border-light);
            display: flex;
            justify-content: flex-end;
            align-items: center;
            padding: 0 24px;
            z-index: 100;
            box-shadow: 0 2px 10px var(--shadow-soft);
        }

        .login-btn, .logout-btn, .settings-btn {
            padding: 8px 18px;
            border: 1px solid var(--border-light);
            border-radius: 20px;
            background: var(--bg-section);
            color: var(--text-mid);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.2s;
            margin-left: 10px;
        }

        .login-btn:hover, .settings-btn:hover { 
            border-color: var(--pastel-gold); 
            background: var(--pastel-gold-light); 
        }

        .logout-btn:hover { 
            border-color: var(--pastel-red); 
            background: var(--pastel-red-light); 
        }

        .logged-in-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--pastel-green-dark);
            font-size: 0.85rem;
            margin-right: 10px;
        }

        .logged-in-indicator::before {
            content: '';
            width: 8px;
            height: 8px;
            background: var(--pastel-green);
            border-radius: 50%;
        }

        body { padding-top: 50px; }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.4);
            backdrop-filter: blur(4px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-overlay.active { display: flex; }

        .modal {
            background: var(--bg-card);
            border-radius: 20px;
            padding: 32px;
            max-width: 480px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
        }

        .modal-title {
            font-family: 'Cinzel', serif;
            font-size: 1.4rem;
            color: var(--pastel-gold-dark);
            margin-bottom: 24px;
            text-align: center;
        }

        .form-group { margin-bottom: 20px; }

        .form-label {
            display: block;
            font-size: 0.85rem;
            color: var(--text-mid);
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border-light);
            border-radius: 10px;
            font-size: 0.95rem;
            font-family: inherit;
            background: var(--bg-section);
            color: var(--text-dark);
            transition: all 0.2s;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--pastel-gold);
            background: var(--bg-card);
        }

        .form-textarea { min-height: 100px; resize: vertical; }

        .form-btn {
            width: 100%;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            margin-top: 10px;
        }

        .form-btn.primary {
            background: linear-gradient(135deg, var(--pastel-gold), var(--pastel-gold-light));
            color: var(--text-dark);
        }

        .form-btn.primary:hover { box-shadow: 0 4px 15px rgba(232, 213, 163, 0.4); }
        .form-btn.primary:disabled { opacity: 0.6; cursor: not-allowed; }

        .form-btn.secondary {
            background: var(--bg-section);
            border: 1px solid var(--border-light);
            color: var(--text-mid);
        }

        .form-btn.danger {
            background: linear-gradient(135deg, var(--pastel-red), var(--pastel-red-light));
            color: var(--text-dark);
        }

        .form-link {
            display: block;
            text-align: center;
            margin-top: 16px;
            color: var(--pastel-blue-dark);
            font-size: 0.85rem;
            cursor: pointer;
            text-decoration: underline;
        }

        .form-error {
            color: var(--pastel-red-dark);
            font-size: 0.8rem;
            margin-top: 8px;
            display: none;
        }

        .form-error.show { display: block; }

        /* íŒŒì¼ ì—…ë¡œë“œ */
        .file-upload-area {
            border: 2px dashed var(--border-light);
            border-radius: 12px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-section);
        }

        .file-upload-area:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .file-upload-area.dragover {
            border-color: var(--pastel-blue);
            background: var(--pastel-blue-light);
        }

        .file-upload-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .file-upload-text { color: var(--text-mid); font-size: 0.9rem; }
        .file-upload-hint { color: var(--text-light); font-size: 0.8rem; margin-top: 8px; }

        .file-preview {
            display: none;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--bg-section);
            border-radius: 10px;
            margin-top: 12px;
        }

        .file-preview.show { display: flex; }
        .file-preview-icon { font-size: 1.5rem; }
        .file-preview-info { flex: 1; }
        .file-preview-name { font-size: 0.85rem; color: var(--text-dark); word-break: break-all; }
        .file-preview-size { font-size: 0.75rem; color: var(--text-light); }
        .file-preview-remove {
            width: 24px; height: 24px;
            border: none; background: var(--pastel-red-light);
            border-radius: 50%; cursor: pointer; color: var(--pastel-red-dark);
        }

        /* ì¸ë„¤ì¼ ì—…ë¡œë“œ */
        .thumbnail-upload-area {
            width: 100%;
            height: 120px;
            border: 2px dashed var(--border-light);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            background: var(--bg-section);
            position: relative;
            overflow: hidden;
        }

        .thumbnail-upload-area:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .thumbnail-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            color: var(--text-light);
            font-size: 0.85rem;
        }

        .thumbnail-placeholder span:first-child {
            font-size: 2rem;
        }

        .thumbnail-preview-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .thumbnail-remove-btn {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 24px;
            height: 24px;
            border: none;
            background: rgba(232, 168, 168, 0.9);
            border-radius: 50%;
            cursor: pointer;
            color: var(--pastel-red-dark);
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .thumbnail-remove-btn:hover {
            background: var(--pastel-red);
        }

        /* ì—…ë¡œë“œ ì§„í–‰ ë°” */
        .upload-progress {
            display: none;
            margin-top: 12px;
        }

        .upload-progress.show { display: block; }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--border-light);
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--pastel-gold), var(--pastel-gold-light));
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        .progress-text {
            font-size: 0.75rem;
            color: var(--text-light);
            text-align: center;
            margin-top: 6px;
        }

        /* í‚¤ì›Œë“œ íƒœê·¸ ì…ë ¥ */
        .tags-input-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px;
            border: 1px solid var(--border-light);
            border-radius: 10px;
            background: var(--bg-section);
            min-height: 50px;
        }

        .tag-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 5px 12px;
            background: var(--pastel-gold-light);
            border-radius: 15px;
            font-size: 0.8rem;
            color: var(--text-dark);
        }

        .tag-remove {
            width: 16px; height: 16px;
            border: none; background: transparent;
            cursor: pointer; font-size: 0.9rem; color: var(--text-mid);
        }

        .tag-input {
            border: none;
            background: transparent;
            outline: none;
            font-size: 0.85rem;
            min-width: 100px;
            flex: 1;
        }

        /* í—¤ë” */
        header { text-align: center; margin-bottom: 60px; }

        .profile-section {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
        }

        .profile-image {
            min-width: 120px;
            min-height: 120px;
            max-width: 200px;
            max-height: 260px;
            border-radius: 12px;
            background: linear-gradient(135deg, var(--pastel-gold-light), var(--pastel-gold));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            box-shadow: 0 8px 30px var(--shadow-mid);
            border: 4px solid var(--bg-card);
            position: relative;
            overflow: hidden;
            cursor: default;
        }

        .profile-image.has-image {
            width: auto;
            height: auto;
        }

        .profile-image.editable { cursor: pointer; }

        .profile-edit-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: white;
            border-radius: 12px;
        }

        .profile-image.editable:hover .profile-edit-overlay { display: flex; }

        .intro-text {
            max-width: 700px;
            margin: 30px auto 0;
            padding: 24px 32px;
            background: var(--bg-card);
            border-radius: 16px;
            border: 1px solid var(--border-light);
            box-shadow: 0 4px 20px var(--shadow-soft);
            font-size: 0.95rem;
            color: var(--text-mid);
            line-height: 1.8;
            position: relative;
            cursor: default;
            transition: all 0.2s;
        }

        .intro-text.editable { cursor: pointer; }
        .intro-text.editable:hover { border-color: var(--pastel-gold); }

        .intro-edit-overlay {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(232, 213, 163, 0.95);
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--text-dark);
            display: none;
            font-weight: 500;
        }

        .intro-text.editable:hover .intro-edit-overlay { display: block; }
        .intro-text.editable:hover #introContent { opacity: 0.3; }

        /* ë“œë˜ê·¸ì•¤ë“œë¡­ */
        .portfolio-card.dragging {
            opacity: 0.5;
            transform: scale(1.02);
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }

        .portfolio-card.drag-over {
            border: 2px dashed var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .drag-handle {
            position: absolute;
            top: 12px;
            right: 48px;
            width: 32px; height: 32px;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            border: 1px solid var(--border-light);
            cursor: grab;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            color: var(--text-mid);
            z-index: 10;
        }

        .drag-handle:active { cursor: grabbing; }
        .drag-handle.show { display: flex; }
        .drag-handle:hover { background: var(--pastel-blue-light); border-color: var(--pastel-blue); }

        /* ì„¹ì…˜ ì¶”ê°€ ë²„íŠ¼ */
        .add-section-btn {
            display: none;
            margin: 30px auto;
            padding: 16px 32px;
            background: var(--bg-card);
            border: 2px dashed var(--border-light);
            border-radius: 12px;
            cursor: pointer;
            text-align: center;
            color: var(--text-light);
            font-size: 0.95rem;
            transition: all 0.2s;
            max-width: 300px;
        }

        .add-section-btn.show { display: block; }

        .add-section-btn:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
            color: var(--text-dark);
        }

        /* ì„¹ì…˜ í—¤ë” ìˆ˜ì • ë²„íŠ¼ */
        .section-edit-btn {
            width: 32px; height: 32px;
            border-radius: 50%;
            background: var(--bg-section);
            border: 1px solid var(--border-light);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.85rem;
            color: var(--text-mid);
            margin-left: auto;
            transition: all 0.2s;
        }

        .section-edit-btn.show { display: flex; }
        .section-edit-btn:hover { background: var(--pastel-gold-light); border-color: var(--pastel-gold); }

        /* ìƒ‰ìƒ ì„ íƒê¸° */
        .color-picker {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .color-option {
            cursor: pointer;
        }

        .color-option input { display: none; }

        .color-swatch {
            width: 36px; height: 36px;
            border-radius: 50%;
            display: block;
            border: 3px solid transparent;
            transition: all 0.2s;
        }

        .color-option input:checked + .color-swatch {
            border-color: var(--text-dark);
            transform: scale(1.1);
        }

        .color-swatch.blue { background: linear-gradient(135deg, var(--pastel-blue-light), var(--pastel-blue)); }
        .color-swatch.green { background: linear-gradient(135deg, var(--pastel-green-light), var(--pastel-green)); }
        .color-swatch.purple { background: linear-gradient(135deg, var(--pastel-purple-light), var(--pastel-purple)); }
        .color-swatch.pink { background: linear-gradient(135deg, var(--pastel-pink), var(--pastel-pink)); }
        .color-swatch.gold { background: linear-gradient(135deg, var(--pastel-gold-light), var(--pastel-gold)); }
        .color-swatch.mint { background: linear-gradient(135deg, var(--pastel-mint), var(--pastel-mint)); }

        /* ì„¹ì…˜ ì•„ì´ì½˜ ìƒ‰ìƒ */
        .section-icon.blue { background: linear-gradient(135deg, var(--pastel-blue-light), var(--pastel-blue)); }
        .section-icon.green { background: linear-gradient(135deg, var(--pastel-green-light), var(--pastel-green)); }
        .section-icon.purple { background: linear-gradient(135deg, var(--pastel-purple-light), var(--pastel-purple)); }
        .section-icon.pink { background: linear-gradient(135deg, var(--pastel-pink), var(--pastel-pink)); }
        .section-icon.gold { background: linear-gradient(135deg, var(--pastel-gold-light), var(--pastel-gold)); }
        .section-icon.mint { background: linear-gradient(135deg, var(--pastel-mint), var(--pastel-mint)); }

        .main-title {
            font-family: 'Cinzel', serif;
            font-size: 2.8rem;
            font-weight: 700;
            color: var(--pastel-gold-dark);
            letter-spacing: 4px;
            margin-bottom: 8px;
        }

        .sub-title {
            font-size: 1.1rem;
            color: var(--text-mid);
            letter-spacing: 2px;
        }

        /* ë„¤ë¹„ê²Œì´ì…˜ */
        .nav-tabs {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .nav-tab {
            padding: 12px 24px;
            border: 1px solid var(--border-light);
            border-radius: 30px;
            background: var(--bg-card);
            color: var(--text-mid);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
            transform: translateY(-2px);
        }

        .nav-tab.active {
            background: linear-gradient(135deg, var(--pastel-gold), var(--pastel-gold-light));
            border-color: var(--pastel-gold-dark);
            color: var(--text-dark);
            font-weight: 600;
        }

        .nav-count {
            background: rgba(0,0,0,0.1);
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        /* ì„¹ì…˜ */
        .section { margin-bottom: 50px; }

        .section-header {
            display: flex;
            align-items: center;
            gap: 14px;
            margin-bottom: 24px;
            padding-bottom: 14px;
            border-bottom: 2px solid var(--border-light);
        }

        .section-icon {
            width: 48px; height: 48px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.4rem;
            flex-shrink: 0;
        }

        .section-title {
            font-family: 'Cinzel', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .section-title .count {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 400;
        }

        .section-subtitle {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-top: 2px;
        }

        /* ê·¸ë¦¬ë“œ */
        .portfolio-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        /* ì¶”ê°€ ë²„íŠ¼ ì¹´ë“œ */
        .add-card {
            background: var(--bg-card);
            border: 2px dashed var(--border-light);
            border-radius: 16px;
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 280px;
            cursor: pointer;
            transition: all 0.3s;
            color: var(--text-light);
        }

        .add-card.show { display: flex; }

        .add-card:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
            color: var(--text-dark);
        }

        .add-card-icon {
            width: 60px; height: 60px;
            border-radius: 50%;
            background: var(--bg-section);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            margin-bottom: 12px;
            transition: all 0.3s;
        }

        .add-card:hover .add-card-icon {
            background: var(--pastel-gold);
            transform: scale(1.1);
        }

        .add-card-text { font-size: 0.9rem; font-weight: 500; }

        /* í¬íŠ¸í´ë¦¬ì˜¤ ì¹´ë“œ */
        .portfolio-card {
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.3s ease;
            position: relative;
        }

        .portfolio-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 12px 40px var(--shadow-mid);
            border-color: var(--pastel-gold);
        }

        .card-link {
            text-decoration: none;
            color: inherit;
            display: block;
            cursor: pointer;
        }

        .card-thumbnail {
            height: 160px;
            background: var(--bg-section);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            position: relative;
            overflow: hidden;
        }

        .card-thumbnail img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .card-thumbnail.pdf { background: linear-gradient(135deg, var(--pastel-red-light), #fff5f5); }
        .card-thumbnail.html { background: linear-gradient(135deg, var(--pastel-blue-light), #f5faff); }
        .card-thumbnail.image { background: linear-gradient(135deg, var(--pastel-purple-light), #faf5ff); }
        .card-thumbnail.project { background: linear-gradient(135deg, var(--pastel-green-light), #f5fff8); }
        .card-thumbnail.video { background: linear-gradient(135deg, var(--pastel-pink), #fff5fa); }
        .card-thumbnail.other { background: linear-gradient(135deg, var(--pastel-mint), #f5ffff); }

        .card-badge {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
        }

        .card-badge.pdf { background: var(--pastel-red); }
        .card-badge.html { background: var(--pastel-blue); }
        .card-badge.image { background: var(--pastel-purple); }
        .card-badge.video { background: var(--pastel-pink); }
        .card-badge.other { background: var(--pastel-mint); }

        .card-edit-btn {
            position: absolute;
            top: 12px;
            left: 12px;
            width: 32px; height: 32px;
            border-radius: 50%;
            background: rgba(255,255,255,0.9);
            border: 1px solid var(--border-light);
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            color: var(--text-mid);
            transition: all 0.2s;
            z-index: 10;
        }

        .card-edit-btn.show { display: flex; }
        .card-edit-btn:hover { background: var(--pastel-gold-light); border-color: var(--pastel-gold); }

        .card-content { padding: 20px; }

        .card-title {
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
            line-height: 1.4;
        }

        .card-description {
            font-size: 0.85rem;
            color: var(--text-light);
            line-height: 1.6;
            margin-bottom: 12px;
        }

        .card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 12px;
            border-top: 1px solid var(--border-light);
        }

        .card-date { font-size: 0.75rem; color: var(--text-light); }

        .card-tags { display: flex; gap: 6px; flex-wrap: wrap; }

        .card-tag {
            padding: 3px 10px;
            background: var(--bg-section);
            border-radius: 12px;
            font-size: 0.7rem;
            color: var(--text-mid);
        }

        /* í‘¸í„° */
        footer {
            margin-top: 80px;
            padding-top: 40px;
            border-top: 1px solid var(--border-light);
            text-align: center;
        }

        .contact-title {
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 16px;
        }

        .contact-links {
            display: flex;
            justify-content: center;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .contact-link {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 25px;
            text-decoration: none;
            color: var(--text-mid);
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .contact-link:hover {
            border-color: var(--pastel-gold);
            background: var(--pastel-gold-light);
        }

        .copyright { font-size: 0.8rem; color: var(--text-light); }

        /* ìŠ¤í† ë¦¬ì§€ ì •ë³´ */
        .storage-info {
            position: fixed;
            bottom: 20px;
            right: 20px;
            padding: 10px 16px;
            background: var(--bg-card);
            border: 1px solid var(--border-light);
            border-radius: 20px;
            font-size: 0.75rem;
            color: var(--text-light);
            box-shadow: 0 4px 15px var(--shadow-soft);
            display: none;
        }

        .storage-info.show { display: block; }

        @media (max-width: 768px) {
            .container { padding: 40px 16px; }
            .main-title { font-size: 2rem; }
            .portfolio-grid { grid-template-columns: 1fr; }
            .nav-tabs { gap: 8px; }
            .nav-tab { padding: 10px 16px; font-size: 0.8rem; }
            .modal { padding: 24px; margin: 10px; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .portfolio-card { animation: fadeInUp 0.5s ease forwards; }
    </style>
</head>
<body>
    <!-- ìƒë‹¨ ë°” -->
    <div class="top-bar">
        <div id="loggedInStatus" class="logged-in-indicator" style="display: none;">í¸ì§‘ ëª¨ë“œ</div>
        <button id="settingsBtn" class="settings-btn" style="display: none;" onclick="openModal('settingsModal')">âš™ï¸ ì„¤ì •</button>
        <button id="logoutBtn" class="logout-btn" style="display: none;" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        <button id="loginBtn" class="login-btn" onclick="openModal('loginModal')">ğŸ” ë¡œê·¸ì¸</button>
    </div>

    <div class="container">
        <header>
            <div class="profile-section">
                <div class="profile-image" id="profileImage">
                    <span id="profileEmoji">ğŸ®</span>
                    <img id="profileImg" style="display: none; max-width: 200px; max-height: 260px; width: auto; height: auto; border-radius: 8px;">
                    <div class="profile-edit-overlay" id="profileEditOverlay">ğŸ“·</div>
                </div>
                <div>
                    <h1 class="main-title" id="mainTitle">PORTFOLIO</h1>
                    <p class="sub-title" id="subTitle">GAME DESIGNER</p>
                </div>
            </div>
            <div class="intro-text" id="introText">
                <span id="introContent">ê²Œì„ ì‹œìŠ¤í…œ ì„¤ê³„ì™€ ì½˜í…ì¸  ê¸°íšì— ì—´ì •ì„ ê°€ì§„ ê²Œì„ ê¸°íšìì…ë‹ˆë‹¤.
                ì‚¬ìš©ì ê²½í—˜ì„ ìµœìš°ì„ ìœ¼ë¡œ ê³ ë ¤í•˜ë©°, ë°ì´í„° ê¸°ë°˜ì˜ ë°¸ëŸ°ìŠ¤ ì„¤ê³„ì™€ 
                ì§ê´€ì ì¸ ì‹œìŠ¤í…œ êµ¬ì¡°ë¥¼ ì¶”êµ¬í•©ë‹ˆë‹¤.</span>
                <div class="intro-edit-overlay" id="introEditOverlay">âœï¸ í´ë¦­í•˜ì—¬ ìˆ˜ì •</div>
            </div>
        </header>

        <nav class="nav-tabs" id="navTabs">
            <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
        </nav>

        <div id="sectionsContainer">
            <!-- ì„¹ì…˜ë“¤ì´ ë™ì ìœ¼ë¡œ ìƒì„±ë¨ -->
        </div>

        <!-- ì„¹ì…˜ ì¶”ê°€ ë²„íŠ¼ -->
        <div class="add-section-btn" id="addSectionBtn" onclick="openSectionModal()">
            <span>+ ìƒˆ ì„¹ì…˜ ì¶”ê°€</span>
        </div>

        <footer>
            <div class="contact-title">CONTACT</div>
            <div class="contact-links">
                <a href="mailto:your-email@example.com" class="contact-link">âœ‰ï¸ Email : your-email@example.com </a>
                <!-- ì´í›„ì— ìˆ˜ì • ì˜ˆì •
                <a href="#" class="contact-link">ğŸ’» GitHub</a>
                <a href="#" class="contact-link">ğŸ’¼ LinkedIn</a> -->
            </div>
            <p class="copyright">Â© 2026 ê²Œì„ ê¸°íšì ê¹€ì¬ì—½ í¬íŠ¸í´ë¦¬ì˜¤</p>
        </footer>
    </div>

    <div class="storage-info" id="storageInfo">ğŸ’¾ ì‚¬ìš© ì¤‘: <span id="storageUsed">0 MB</span></div>

    <!-- í”„ë¡œí•„ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="profileModal">
        <div class="modal">
            <h2 class="modal-title">ğŸ‘¤ í”„ë¡œí•„ ìˆ˜ì •</h2>
            <div class="form-group">
                <label class="form-label">í”„ë¡œí•„ ì´ë¯¸ì§€</label>
                <div class="thumbnail-upload-area" id="profileImageUpload" onclick="document.getElementById('profileImageInput').click()">
                    <div class="thumbnail-placeholder" id="profileImagePlaceholder">
                        <span>ğŸ–¼ï¸</span>
                        <span>í´ë¦­í•˜ì—¬ ì´ë¯¸ì§€ ì—…ë¡œë“œ</span>
                    </div>
                    <img class="thumbnail-preview-img" id="profileImagePreview" style="display: none;">
                    <button type="button" class="thumbnail-remove-btn" id="profileImageRemoveBtn" onclick="event.stopPropagation(); removeProfileImage()" style="display: none;">Ã—</button>
                </div>
                <input type="file" id="profileImageInput" style="display: none;" accept="image/*" onchange="handleProfileImageSelect(event)">
            </div>
            <div class="form-group">
                <label class="form-label">ë©”ì¸ íƒ€ì´í‹€</label>
                <input type="text" class="form-input" id="profileTitle" placeholder="PORTFOLIO">
            </div>
            <div class="form-group">
                <label class="form-label">ì„œë¸Œ íƒ€ì´í‹€</label>
                <input type="text" class="form-input" id="profileSubtitle" placeholder="GAME DESIGNER">
            </div>
            <button class="form-btn primary" onclick="saveProfile()">ì €ì¥</button>
            <button class="form-btn secondary" onclick="closeModal('profileModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ìê¸°ì†Œê°œ ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="introModal">
        <div class="modal">
            <h2 class="modal-title">âœï¸ ìê¸°ì†Œê°œ ìˆ˜ì •</h2>
            <div class="form-group">
                <label class="form-label">ìê¸°ì†Œê°œ</label>
                <textarea class="form-textarea" id="introTextInput" rows="6" placeholder="ìê¸°ì†Œê°œë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
            </div>
            <button class="form-btn primary" onclick="saveIntro()">ì €ì¥</button>
            <button class="form-btn secondary" onclick="closeModal('introModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ì„¹ì…˜ ì¶”ê°€/ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="sectionModal">
        <div class="modal">
            <h2 class="modal-title" id="sectionModalTitle">ğŸ“ ìƒˆ ì„¹ì…˜ ì¶”ê°€</h2>
            <input type="hidden" id="editSectionId">
            <div class="form-group">
                <label class="form-label">ì•„ì´ì½˜ (ì´ëª¨ì§€)</label>
                <input type="text" class="form-input" id="sectionIcon" placeholder="ğŸ“„" maxlength="2">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¹ì…˜ ì œëª© *</label>
                <input type="text" class="form-input" id="sectionTitle" placeholder="DOCUMENTS">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¹ì…˜ ì„¤ëª…</label>
                <input type="text" class="form-input" id="sectionSubtitle" placeholder="ê¸°íšì„œ ë° ë¶„ì„ ë¬¸ì„œ">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¹ì…˜ ìƒ‰ìƒ</label>
                <div class="color-picker">
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="blue" checked>
                        <span class="color-swatch blue"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="green">
                        <span class="color-swatch green"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="purple">
                        <span class="color-swatch purple"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="pink">
                        <span class="color-swatch pink"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="gold">
                        <span class="color-swatch gold"></span>
                    </label>
                    <label class="color-option">
                        <input type="radio" name="sectionColor" value="mint">
                        <span class="color-swatch mint"></span>
                    </label>
                </div>
            </div>
            <div class="form-error" id="sectionError"></div>
            <button class="form-btn primary" onclick="saveSection()">ì €ì¥</button>
            <button class="form-btn danger" id="deleteSectionBtn" onclick="deleteSection()" style="display: none;">ì„¹ì…˜ ì‚­ì œ</button>
            <button class="form-btn secondary" onclick="closeModal('sectionModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ë¡œê·¸ì¸ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="loginModal">
        <div class="modal">
            <h2 class="modal-title">ğŸ” ë¡œê·¸ì¸</h2>
            <div id="loginSetupForm">
                <p style="text-align:center; color: var(--text-mid); margin-bottom: 20px;">
                    ë¹„ë°€ë²ˆí˜¸ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.<br>ìƒˆ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì„¤ì •í•´ì£¼ì„¸ìš”.
                </p>
                <div class="form-group">
                    <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" class="form-input" id="setupPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
                </div>
                <div class="form-group">
                    <label class="form-label">ë¹„ë°€ë²ˆí˜¸ í™•ì¸</label>
                    <input type="password" class="form-input" id="setupPasswordConfirm" placeholder="ë¹„ë°€ë²ˆí˜¸ ì¬ì…ë ¥">
                </div>
                <div class="form-group">
                    <label class="form-label">ë¹„ë°€ë²ˆí˜¸ íŒíŠ¸ (ì°¾ê¸°ìš©)</label>
                    <input type="text" class="form-input" id="setupHint" placeholder="ë³¸ì¸ë§Œ ì•„ëŠ” íŒíŠ¸">
                </div>
                <div class="form-error" id="setupError"></div>
                <button class="form-btn primary" onclick="setupPassword()">ë¹„ë°€ë²ˆí˜¸ ì„¤ì •</button>
            </div>
            <div id="loginForm" style="display: none;">
                <div class="form-group">
                    <label class="form-label">ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" class="form-input" id="loginPassword" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
                </div>
                <div class="form-error" id="loginError"></div>
                <button class="form-btn primary" onclick="login()">ë¡œê·¸ì¸</button>
                <span class="form-link" onclick="showForgotPassword()">ë¹„ë°€ë²ˆí˜¸ë¥¼ ìŠìœ¼ì…¨ë‚˜ìš”?</span>
            </div>
            <div id="forgotForm" style="display: none;">
                <p style="text-align:center; color: var(--text-mid); margin-bottom: 16px;" id="hintDisplay"></p>
                <div class="form-group">
                    <label class="form-label">íŒíŠ¸ ë‹µë³€</label>
                    <input type="text" class="form-input" id="hintAnswer" placeholder="íŒíŠ¸ì— í•´ë‹¹í•˜ëŠ” ë‹µë³€">
                </div>
                <div class="form-group">
                    <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                    <input type="password" class="form-input" id="newPassword" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸">
                </div>
                <div class="form-error" id="forgotError"></div>
                <button class="form-btn primary" onclick="resetPassword()">ë¹„ë°€ë²ˆí˜¸ ì¬ì„¤ì •</button>
                <span class="form-link" onclick="showLoginForm()">â† ë¡œê·¸ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</span>
            </div>
            <button class="form-btn secondary" style="margin-top: 12px;" onclick="closeModal('loginModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ì„¤ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="settingsModal">
        <div class="modal">
            <h2 class="modal-title">âš™ï¸ ì„¤ì •</h2>
            <div class="form-group">
                <label class="form-label">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" class="form-input" id="currentPw" placeholder="í˜„ì¬ ë¹„ë°€ë²ˆí˜¸">
            </div>
            <div class="form-group">
                <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸</label>
                <input type="password" class="form-input" id="newPw" placeholder="ìƒˆ ë¹„ë°€ë²ˆí˜¸ (ë³€ê²½ ì‹œì—ë§Œ)">
            </div>
            <div class="form-group">
                <label class="form-label">ìƒˆ ë¹„ë°€ë²ˆí˜¸ íŒíŠ¸</label>
                <input type="text" class="form-input" id="newHint" placeholder="ìƒˆ íŒíŠ¸ (ë³€ê²½ ì‹œì—ë§Œ)">
            </div>
            <div class="form-error" id="settingsError"></div>
            <button class="form-btn primary" onclick="changePassword()">ë³€ê²½ ì €ì¥</button>
            
            <!-- ë°ì´í„° ë°±ì—…/ë³µì› ì„¹ì…˜ -->
            <div style="border-top: 1px solid var(--border-light); margin-top: 20px; padding-top: 20px;">
                <label class="form-label" style="font-size: 0.95rem; color: var(--text-dark); margin-bottom: 12px;">ğŸ“¦ ë°ì´í„° ë°±ì—…/ë³µì›</label>
                <p style="font-size: 0.8rem; color: var(--text-light); margin-bottom: 12px; line-height: 1.5;">
                    ë‹¤ë¥¸ ê¸°ê¸°ì—ì„œ ì‚¬ìš©í•˜ë ¤ë©´ ë°ì´í„°ë¥¼ ë°±ì—…í•˜ì—¬ ë³µì›í•˜ì„¸ìš”.<br>
                    <strong>ë…ë¦½í˜• HTML</strong>ì„ ë‹¤ìš´ë¡œë“œí•˜ë©´ ë°ì´í„°ê°€ í¬í•¨ëœ íŒŒì¼ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                </p>
                <button class="form-btn" style="background: var(--pastel-blue-light); border: 1px solid var(--pastel-blue); color: var(--text-dark); margin-bottom: 8px;" onclick="openModal('backupModal'); closeModal('settingsModal');">ğŸ“¦ ë°±ì—…/ë³µì› ì—´ê¸°</button>
            </div>
            
            <button class="form-btn secondary" onclick="closeModal('settingsModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- ë°±ì—…/ë³µì› ëª¨ë‹¬ -->
    <div class="modal-overlay" id="backupModal">
        <div class="modal" style="max-width: 520px;">
            <h2 class="modal-title">ğŸ“¦ ë°ì´í„° ë°±ì—…/ë³µì›</h2>
            
            <div style="background: var(--pastel-gold-light); border: 1px solid var(--pastel-gold); border-radius: 10px; padding: 12px; margin-bottom: 20px;">
                <p style="font-size: 0.85rem; color: var(--text-dark); margin: 0; line-height: 1.5;">
                    âš ï¸ <strong>ì¤‘ìš”:</strong> ë¸Œë¼ìš°ì € ë¡œì»¬ ì €ì¥ì†Œ(IndexedDB)ëŠ” í•´ë‹¹ ê¸°ê¸°ì—ì„œë§Œ ìœ ì§€ë©ë‹ˆë‹¤.<br>
                    ë‹¤ë¥¸ ì»´í“¨í„°ë‚˜ Netlify ë°°í¬ ì‹œ ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë ¤ë©´ ì•„ë˜ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì„¸ìš”.
                </p>
            </div>
            
            <!-- ë‚´ë³´ë‚´ê¸° ì„¹ì…˜ -->
            <div class="form-group" style="border: 1px solid var(--border-light); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                <label class="form-label" style="font-size: 0.95rem; color: var(--pastel-blue-dark); margin-bottom: 10px;">ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</label>
                <p style="font-size: 0.8rem; color: var(--text-light); margin-bottom: 12px;">í˜„ì¬ ì €ì¥ëœ ëª¨ë“  ë°ì´í„°ë¥¼ JSON íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.</p>
                <button class="form-btn" style="background: linear-gradient(135deg, var(--pastel-blue), var(--pastel-blue-light)); color: var(--text-dark);" onclick="exportAllData()">ğŸ“¥ JSON ë°±ì—… ë‹¤ìš´ë¡œë“œ</button>
            </div>
            
            <!-- ê°€ì ¸ì˜¤ê¸° ì„¹ì…˜ -->
            <div class="form-group" style="border: 1px solid var(--border-light); border-radius: 12px; padding: 16px; margin-bottom: 16px;">
                <label class="form-label" style="font-size: 0.95rem; color: var(--pastel-green-dark); margin-bottom: 10px;">ğŸ“¥ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</label>
                <p style="font-size: 0.8rem; color: var(--text-light); margin-bottom: 12px;">ë°±ì—… JSON íŒŒì¼ì„ ì„ íƒí•˜ì—¬ ë°ì´í„°ë¥¼ ë³µì›í•©ë‹ˆë‹¤.</p>
                <input type="file" id="backupFileInput" accept=".json" style="display: none;" onchange="importAllData(event)">
                <button class="form-btn" style="background: linear-gradient(135deg, var(--pastel-green), var(--pastel-green-light)); color: var(--text-dark);" onclick="document.getElementById('backupFileInput').click()">ğŸ“¤ JSON íŒŒì¼ ì„ íƒ ë° ë³µì›</button>
            </div>
            
            <!-- ë…ë¦½í˜• HTML ë‹¤ìš´ë¡œë“œ ì„¹ì…˜ -->
            <div class="form-group" style="border: 1px solid var(--pastel-purple); border-radius: 12px; padding: 16px; background: var(--pastel-purple-light); margin-bottom: 16px;">
                <label class="form-label" style="font-size: 0.95rem; color: var(--pastel-purple-dark); margin-bottom: 10px;">ğŸŒ ë…ë¦½í˜• HTML ë‹¤ìš´ë¡œë“œ (ì¶”ì²œ)</label>
                <p style="font-size: 0.8rem; color: var(--text-dark); margin-bottom: 12px;">
                    <strong>Netlify ë°°í¬ìš©!</strong><br>
                    í˜„ì¬ ë°ì´í„°ê°€ ëª¨ë‘ í¬í•¨ëœ HTML íŒŒì¼ì„ ë‹¤ìš´ë¡œë“œí•©ë‹ˆë‹¤.<br>
                    ì´ íŒŒì¼ì„ Netlifyì— ì—…ë¡œë“œí•˜ë©´ ëª¨ë“  ë°ì´í„°ê°€ ë³´ì¡´ë©ë‹ˆë‹¤.
                </p>
                <button class="form-btn" style="background: linear-gradient(135deg, var(--pastel-purple), var(--pastel-purple-light)); color: var(--text-dark);" onclick="downloadStandaloneHTML()">ğŸš€ ë°ì´í„° í¬í•¨ HTML ë‹¤ìš´ë¡œë“œ</button>
            </div>
            
            <div id="backupStatus" style="display: none; padding: 12px; border-radius: 8px; margin-bottom: 12px; font-size: 0.85rem;"></div>
            
            <button class="form-btn secondary" onclick="closeModal('backupModal')">ë‹«ê¸°</button>
        </div>
    </div>

    <!-- í•­ëª© ì¶”ê°€ ëª¨ë‹¬ -->
    <div class="modal-overlay" id="addModal">
        <div class="modal">
            <h2 class="modal-title" id="addModalTitle">ğŸ“„ ìƒˆ í•­ëª© ì¶”ê°€</h2>
            <input type="hidden" id="addCategory">
            <div class="form-group">
                <label class="form-label">íŒŒì¼ ì—…ë¡œë“œ (ìµœëŒ€ 100MB)</label>
                <div class="file-upload-area" id="fileUploadArea" onclick="document.getElementById('fileInput').click()">
                    <div class="file-upload-icon">ğŸ“</div>
                    <div class="file-upload-text">í´ë¦­í•˜ê±°ë‚˜ íŒŒì¼ì„ ë“œë˜ê·¸í•˜ì„¸ìš”</div>
                    <div class="file-upload-hint">PDF, HTML, PNG, JPG, GIF, MP4 ë“±</div>
                </div>
                <input type="file" id="fileInput" style="display: none;" accept="*/*" onchange="handleFileSelect(event)">
                <div class="file-preview" id="filePreview">
                    <span class="file-preview-icon" id="filePreviewIcon">ğŸ“„</span>
                    <div class="file-preview-info">
                        <div class="file-preview-name" id="filePreviewName"></div>
                        <div class="file-preview-size" id="filePreviewSize"></div>
                    </div>
                    <button class="file-preview-remove" onclick="removeFile()">Ã—</button>
                </div>
                <div class="upload-progress" id="uploadProgress">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progressText">ì—…ë¡œë“œ ì¤‘... 0%</div>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">ë˜ëŠ” ì™¸ë¶€ ë§í¬</label>
                <input type="url" class="form-input" id="itemLink" placeholder="https://...">
            </div>
            <div class="form-group">
                <label class="form-label">ì¸ë„¤ì¼ ì´ë¯¸ì§€ (ì„ íƒ)</label>
                <div class="thumbnail-upload-area" id="thumbnailUploadArea" onclick="document.getElementById('thumbnailInput').click()">
                    <div class="thumbnail-placeholder" id="thumbnailPlaceholder">
                        <span>ğŸ–¼ï¸</span>
                        <span>í´ë¦­í•˜ì—¬ ì¸ë„¤ì¼ ì¶”ê°€</span>
                    </div>
                    <img class="thumbnail-preview-img" id="thumbnailPreviewImg" style="display: none;">
                    <button type="button" class="thumbnail-remove-btn" id="thumbnailRemoveBtn" onclick="event.stopPropagation(); removeThumbnail()" style="display: none;">Ã—</button>
                </div>
                <input type="file" id="thumbnailInput" style="display: none;" accept="image/*" onchange="handleThumbnailSelect(event)">
            </div>
            <div class="form-group">
                <label class="form-label">ì œëª© *</label>
                <input type="text" class="form-input" id="itemTitle" placeholder="í•­ëª© ì œëª©">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea class="form-textarea" id="itemDesc" placeholder="í•­ëª©ì— ëŒ€í•œ ì„¤ëª…"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">ë‚ ì§œ</label>
                <input type="month" class="form-input" id="itemDate">
            </div>
            <div class="form-group">
                <label class="form-label">í‚¤ì›Œë“œ (Enterë¡œ ì¶”ê°€)</label>
                <div class="tags-input-container" id="tagsContainer">
                    <input type="text" class="tag-input" id="tagInput" placeholder="í‚¤ì›Œë“œ ì…ë ¥ í›„ Enter">
                </div>
            </div>
            <div class="form-error" id="addError"></div>
            <button class="form-btn primary" id="saveBtn" onclick="saveItem()">ì €ì¥</button>
            <button class="form-btn secondary" onclick="closeModal('addModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <!-- í•­ëª© ìˆ˜ì • ëª¨ë‹¬ -->
    <div class="modal-overlay" id="editModal">
        <div class="modal">
            <h2 class="modal-title">âœï¸ í•­ëª© ìˆ˜ì •</h2>
            <input type="hidden" id="editItemId">
            <input type="hidden" id="editCategory">
            <div class="form-group">
                <label class="form-label">ì¸ë„¤ì¼ ì´ë¯¸ì§€</label>
                <div class="thumbnail-upload-area" id="editThumbnailUploadArea" onclick="document.getElementById('editThumbnailInput').click()">
                    <div class="thumbnail-placeholder" id="editThumbnailPlaceholder">
                        <span>ğŸ–¼ï¸</span>
                        <span>í´ë¦­í•˜ì—¬ ì¸ë„¤ì¼ ì¶”ê°€</span>
                    </div>
                    <img class="thumbnail-preview-img" id="editThumbnailPreviewImg" style="display: none;">
                    <button type="button" class="thumbnail-remove-btn" id="editThumbnailRemoveBtn" onclick="event.stopPropagation(); removeEditThumbnail()" style="display: none;">Ã—</button>
                </div>
                <input type="file" id="editThumbnailInput" style="display: none;" accept="image/*" onchange="handleEditThumbnailSelect(event)">
            </div>
            <div class="form-group">
                <label class="form-label">ì œëª© *</label>
                <input type="text" class="form-input" id="editTitle">
            </div>
            <div class="form-group">
                <label class="form-label">ì„¤ëª…</label>
                <textarea class="form-textarea" id="editDesc"></textarea>
            </div>
            <div class="form-group">
                <label class="form-label">ë‚ ì§œ</label>
                <input type="month" class="form-input" id="editDate">
            </div>
            <div class="form-group">
                <label class="form-label">í‚¤ì›Œë“œ</label>
                <div class="tags-input-container" id="editTagsContainer">
                    <input type="text" class="tag-input" id="editTagInput" placeholder="í‚¤ì›Œë“œ ì…ë ¥ í›„ Enter">
                </div>
            </div>
            <div class="form-error" id="editError"></div>
            <button class="form-btn primary" onclick="updateItem()">ìˆ˜ì • ì €ì¥</button>
            <button class="form-btn danger" onclick="deleteItem()">ì‚­ì œ</button>
            <button class="form-btn secondary" onclick="closeModal('editModal')">ì·¨ì†Œ</button>
        </div>
    </div>

    <script>
        // ============ IndexedDB ì„¤ì • ============
        const DB_NAME = 'PortfolioDB';
        const DB_VERSION = 2;
        const STORES = {
            META: 'metadata',
            FILES: 'files',
            AUTH: 'auth',
            PROFILE: 'profile',
            SECTIONS: 'sections'
        };

        let db = null;
        let isLoggedIn = false;
        let currentTags = [];
        let editTags = [];
        let selectedFile = null;
        let selectedThumbnail = null;
        let editThumbnail = null;
        let editThumbnailChanged = false;
        let editThumbnailRemoved = false;
        let currentFilter = 'all'; // í˜„ì¬ í•„í„° ìƒíƒœ
        let draggedItem = null; // ë“œë˜ê·¸ ì¤‘ì¸ ì•„ì´í…œ

        const MAX_FILE_SIZE = 100 * 1024 * 1024; // 100MB
        const MAX_THUMBNAIL_SIZE = 5 * 1024 * 1024; // 5MB

        // DB ì´ˆê¸°í™”
        async function initDB() {
            return new Promise((resolve, reject) => {
                const request = indexedDB.open(DB_NAME, DB_VERSION);

                request.onerror = () => reject(request.error);
                request.onsuccess = () => {
                    db = request.result;
                    resolve(db);
                };

                request.onupgradeneeded = (event) => {
                    const database = event.target.result;
                    
                    // ë©”íƒ€ë°ì´í„° ì €ì¥ì†Œ
                    if (!database.objectStoreNames.contains(STORES.META)) {
                        database.createObjectStore(STORES.META, { keyPath: 'id' });
                    }
                    
                    // íŒŒì¼ ì €ì¥ì†Œ
                    if (!database.objectStoreNames.contains(STORES.FILES)) {
                        database.createObjectStore(STORES.FILES, { keyPath: 'id' });
                    }
                    
                    // ì¸ì¦ ì €ì¥ì†Œ
                    if (!database.objectStoreNames.contains(STORES.AUTH)) {
                        database.createObjectStore(STORES.AUTH, { keyPath: 'key' });
                    }

                    // í”„ë¡œí•„ ì €ì¥ì†Œ
                    if (!database.objectStoreNames.contains(STORES.PROFILE)) {
                        database.createObjectStore(STORES.PROFILE, { keyPath: 'key' });
                    }

                    // ì„¹ì…˜ ì €ì¥ì†Œ
                    if (!database.objectStoreNames.contains(STORES.SECTIONS)) {
                        database.createObjectStore(STORES.SECTIONS, { keyPath: 'id' });
                    }
                };
            });
        }

        // DB íŠ¸ëœì­ì…˜ í—¬í¼
        function getStore(storeName, mode = 'readonly') {
            const tx = db.transaction(storeName, mode);
            return tx.objectStore(storeName);
        }

        // ì¸ì¦ ê´€ë ¨
        async function getAuth() {
            return new Promise((resolve) => {
                const store = getStore(STORES.AUTH);
                const request = store.get('credentials');
                request.onsuccess = () => resolve(request.result?.data || null);
                request.onerror = () => resolve(null);
            });
        }

        async function setAuth(password, hint) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.AUTH, 'readwrite');
                const request = store.put({ key: 'credentials', data: { password, hint } });
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // ë©”íƒ€ë°ì´í„° ê´€ë ¨
        async function getAllMetadata() {
            return new Promise(async (resolve) => {
                const sections = await getSections();
                const store = getStore(STORES.META);
                const request = store.getAll();
                request.onsuccess = () => {
                    const items = request.result || [];
                    const data = {};
                    sections.forEach(s => data[s.id] = []);
                    items.forEach(item => {
                        if (data[item.category] !== undefined) {
                            data[item.category].push(item);
                        }
                    });
                    resolve(data);
                };
                request.onerror = () => {
                    const data = {};
                    sections.forEach(s => data[s.id] = []);
                    resolve(data);
                };
            });
        }

        async function saveMetadata(item) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.META, 'readwrite');
                const request = store.put(item);
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        async function deleteMetadata(id) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.META, 'readwrite');
                const request = store.delete(id);
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // íŒŒì¼ ê´€ë ¨
        async function saveFile(id, fileData) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.FILES, 'readwrite');
                const request = store.put({ id, data: fileData });
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        async function getFile(id) {
            return new Promise((resolve) => {
                const store = getStore(STORES.FILES);
                const request = store.get(id);
                request.onsuccess = () => resolve(request.result?.data || null);
                request.onerror = () => resolve(null);
            });
        }

        async function deleteFile(id) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.FILES, 'readwrite');
                const request = store.delete(id);
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        // ìŠ¤í† ë¦¬ì§€ ì‚¬ìš©ëŸ‰ ê³„ì‚°
        async function getStorageUsage() {
            if (navigator.storage && navigator.storage.estimate) {
                const estimate = await navigator.storage.estimate();
                return {
                    used: estimate.usage || 0,
                    quota: estimate.quota || 0
                };
            }
            return { used: 0, quota: 0 };
        }

        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        async function updateStorageInfo() {
            const usage = await getStorageUsage();
            document.getElementById('storageUsed').textContent = formatBytes(usage.used);
            if (isLoggedIn) {
                document.getElementById('storageInfo').classList.add('show');
            }
        }

        // ============ í”„ë¡œí•„ ê´€ë ¨ ============
        async function getProfile() {
            return new Promise((resolve) => {
                const store = getStore(STORES.PROFILE);
                const request = store.get('main');
                request.onsuccess = () => resolve(request.result?.data || null);
                request.onerror = () => resolve(null);
            });
        }

        async function saveProfileData(profileData) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.PROFILE, 'readwrite');
                const request = store.put({ key: 'main', data: profileData });
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        let profileImageData = null;

        function handleProfileImageSelect(event) {
            if (event.target.files.length) {
                const file = event.target.files[0];
                if (!file.type.startsWith('image/')) {
                    alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                    return;
                }
                if (file.size > MAX_THUMBNAIL_SIZE) {
                    alert('ì´ë¯¸ì§€ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                    return;
                }
                const reader = new FileReader();
                reader.onload = (e) => {
                    profileImageData = e.target.result;
                    document.getElementById('profileImagePreview').src = e.target.result;
                    document.getElementById('profileImagePreview').style.display = 'block';
                    document.getElementById('profileImagePlaceholder').style.display = 'none';
                    document.getElementById('profileImageRemoveBtn').style.display = 'flex';
                };
                reader.readAsDataURL(file);
            }
        }

        function removeProfileImage() {
            profileImageData = 'removed';
            document.getElementById('profileImageInput').value = '';
            document.getElementById('profileImagePreview').style.display = 'none';
            document.getElementById('profileImagePlaceholder').style.display = 'flex';
            document.getElementById('profileImageRemoveBtn').style.display = 'none';
        }

        async function openProfileModal() {
            const profile = await getProfile();
            document.getElementById('profileTitle').value = profile?.title || 'PORTFOLIO';
            document.getElementById('profileSubtitle').value = profile?.subtitle || 'GAME DESIGNER';
            
            profileImageData = null;
            if (profile?.image) {
                document.getElementById('profileImagePreview').src = profile.image;
                document.getElementById('profileImagePreview').style.display = 'block';
                document.getElementById('profileImagePlaceholder').style.display = 'none';
                document.getElementById('profileImageRemoveBtn').style.display = 'flex';
            } else {
                document.getElementById('profileImagePreview').style.display = 'none';
                document.getElementById('profileImagePlaceholder').style.display = 'flex';
                document.getElementById('profileImageRemoveBtn').style.display = 'none';
            }
            
            openModal('profileModal');
        }

        async function saveProfile() {
            const currentProfile = await getProfile() || {};
            const newProfile = {
                title: document.getElementById('profileTitle').value || 'PORTFOLIO',
                subtitle: document.getElementById('profileSubtitle').value || 'GAME DESIGNER',
                image: profileImageData === 'removed' ? null : (profileImageData || currentProfile.image)
            };
            
            await saveProfileData(newProfile);
            await loadProfile();
            closeModal('profileModal');
        }

        async function loadProfile() {
            const profile = await getProfile();
            const profileImageEl = document.getElementById('profileImage');
            
            document.getElementById('mainTitle').textContent = profile?.title || 'PORTFOLIO';
            document.getElementById('subTitle').textContent = profile?.subtitle || 'GAME DESIGNER';
            
            if (profile?.image) {
                document.getElementById('profileEmoji').style.display = 'none';
                const img = document.getElementById('profileImg');
                img.src = profile.image;
                img.style.display = 'block';
                profileImageEl.classList.add('has-image');
            } else {
                document.getElementById('profileEmoji').style.display = 'block';
                document.getElementById('profileImg').style.display = 'none';
                profileImageEl.classList.remove('has-image');
            }
        }

        // ìê¸°ì†Œê°œ ê´€ë ¨
        async function getIntro() {
            return new Promise((resolve) => {
                const store = getStore(STORES.PROFILE);
                const request = store.get('intro');
                request.onsuccess = () => resolve(request.result?.data || null);
                request.onerror = () => resolve(null);
            });
        }

        async function saveIntroData(intro) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.PROFILE, 'readwrite');
                const request = store.put({ key: 'intro', data: intro });
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        async function openIntroModal() {
            const intro = await getIntro();
            document.getElementById('introTextInput').value = intro || document.getElementById('introContent').textContent.trim();
            openModal('introModal');
        }

        async function saveIntro() {
            const intro = document.getElementById('introTextInput').value.trim();
            await saveIntroData(intro);
            document.getElementById('introContent').textContent = intro;
            closeModal('introModal');
        }

        async function loadIntro() {
            const intro = await getIntro();
            if (intro) {
                document.getElementById('introContent').textContent = intro;
            }
        }

        // ============ ì„¹ì…˜ ê´€ë ¨ ============
        const DEFAULT_SECTIONS = [
            { id: 'documents', icon: 'ğŸ“„', title: 'DOCUMENTS', subtitle: 'ê¸°íšì„œ ë° ë¶„ì„ ë¬¸ì„œ', color: 'blue', order: 0 },
            { id: 'tools', icon: 'ğŸ› ï¸', title: 'SIMULATORS & TOOLS', subtitle: 'ì¸í„°ë™í‹°ë¸Œ ì‹œë®¬ë ˆì´í„° ë° ë„êµ¬', color: 'green', order: 1 },
            { id: 'visuals', icon: 'ğŸ¨', title: 'VISUALS', subtitle: 'ë‹¤ì´ì–´ê·¸ë¨ ë° ì‹œê° ìë£Œ', color: 'purple', order: 2 },
            { id: 'projects', icon: 'ğŸ“', title: 'PROJECTS', subtitle: 'ì°¸ì—¬ í”„ë¡œì íŠ¸', color: 'pink', order: 3 }
        ];

        async function getSections() {
            return new Promise((resolve) => {
                const store = getStore(STORES.SECTIONS);
                const request = store.getAll();
                request.onsuccess = async () => {
                    let sections = request.result || [];
                    if (sections.length === 0) {
                        // ê¸°ë³¸ ì„¹ì…˜ ì €ì¥
                        for (const section of DEFAULT_SECTIONS) {
                            await saveSectionData(section);
                        }
                        resolve(DEFAULT_SECTIONS);
                    } else {
                        resolve(sections.sort((a, b) => a.order - b.order));
                    }
                };
                request.onerror = () => resolve(DEFAULT_SECTIONS);
            });
        }

        async function saveSectionData(section) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.SECTIONS, 'readwrite');
                const request = store.put(section);
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        async function deleteSectionData(id) {
            return new Promise((resolve, reject) => {
                const store = getStore(STORES.SECTIONS, 'readwrite');
                const request = store.delete(id);
                request.onsuccess = () => resolve();
                request.onerror = () => reject(request.error);
            });
        }

        let editingSectionId = null;

        function openSectionModal(sectionId = null) {
            editingSectionId = sectionId;
            
            if (sectionId) {
                document.getElementById('sectionModalTitle').textContent = 'âœï¸ ì„¹ì…˜ ìˆ˜ì •';
                document.getElementById('deleteSectionBtn').style.display = 'block';
                
                getSections().then(sections => {
                    const section = sections.find(s => s.id === sectionId);
                    if (section) {
                        document.getElementById('sectionIcon').value = section.icon;
                        document.getElementById('sectionTitle').value = section.title;
                        document.getElementById('sectionSubtitle').value = section.subtitle;
                        document.querySelector(`input[name="sectionColor"][value="${section.color}"]`).checked = true;
                    }
                });
            } else {
                document.getElementById('sectionModalTitle').textContent = 'ğŸ“ ìƒˆ ì„¹ì…˜ ì¶”ê°€';
                document.getElementById('deleteSectionBtn').style.display = 'none';
                document.getElementById('sectionIcon').value = 'ğŸ“„';
                document.getElementById('sectionTitle').value = '';
                document.getElementById('sectionSubtitle').value = '';
                document.querySelector('input[name="sectionColor"][value="blue"]').checked = true;
            }
            
            openModal('sectionModal');
        }

        async function saveSection() {
            const icon = document.getElementById('sectionIcon').value || 'ğŸ“„';
            const title = document.getElementById('sectionTitle').value.trim();
            const subtitle = document.getElementById('sectionSubtitle').value.trim();
            const color = document.querySelector('input[name="sectionColor"]:checked').value;
            const errorEl = document.getElementById('sectionError');

            if (!title) {
                errorEl.textContent = 'ì„¹ì…˜ ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            const sections = await getSections();

            if (editingSectionId) {
                // ìˆ˜ì •
                const section = sections.find(s => s.id === editingSectionId);
                if (section) {
                    section.icon = icon;
                    section.title = title;
                    section.subtitle = subtitle;
                    section.color = color;
                    await saveSectionData(section);
                }
            } else {
                // ìƒˆë¡œ ì¶”ê°€
                const newSection = {
                    id: 'section_' + Date.now(),
                    icon,
                    title,
                    subtitle,
                    color,
                    order: sections.length
                };
                await saveSectionData(newSection);
            }

            closeModal('sectionModal');
            await renderSectionsAndNav();
            await renderAllSections();
            updateUI();
        }

        async function deleteSection() {
            if (!editingSectionId) return;
            if (!confirm('ì´ ì„¹ì…˜ê³¼ í¬í•¨ëœ ëª¨ë“  í•­ëª©ì´ ì‚­ì œë©ë‹ˆë‹¤. ê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            // ì„¹ì…˜ì— ì†í•œ í•­ëª©ë“¤ ì‚­ì œ
            const data = await getAllMetadata();
            const itemsToDelete = data[editingSectionId] || [];
            for (const item of itemsToDelete) {
                await deleteMetadata(item.id);
                await deleteFile(item.id);
                await deleteFile(item.id + '_thumb');
            }

            await deleteSectionData(editingSectionId);
            
            closeModal('sectionModal');
            await renderSectionsAndNav();
            await renderAllSections();
            updateUI();
        }

        async function renderSectionsAndNav() {
            const sections = await getSections();
            const data = await getAllMetadata();
            
            // ë„¤ë¹„ê²Œì´ì…˜ ë Œë”ë§ (ì „ì²´ ë²„íŠ¼ í¬í•¨)
            const navContainer = document.getElementById('navTabs');
            const totalCount = sections.reduce((sum, s) => sum + (data[s.id] || []).length, 0);
            
            navContainer.innerHTML = `
                <a href="#" class="nav-tab ${currentFilter === 'all' ? 'active' : ''}" data-filter="all">
                    ğŸ“‹ ì „ì²´ <span class="nav-count">${totalCount}</span>
                </a>
                ${sections.map(section => `
                    <a href="#${section.id}" class="nav-tab ${currentFilter === section.id ? 'active' : ''}" data-filter="${section.id}">
                        ${section.icon} ${section.title.split(' ')[0]} 
                        <span class="nav-count" id="navCount-${section.id}">${(data[section.id] || []).length}</span>
                    </a>
                `).join('')}
            `;

            // ë„¤ë¹„ê²Œì´ì…˜ ì´ë²¤íŠ¸ (í•„í„°ë§)
            navContainer.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function(e) {
                    e.preventDefault();
                    const filter = this.dataset.filter;
                    setFilter(filter);
                    
                    // íŠ¹ì • ì„¹ì…˜ í´ë¦­ ì‹œ ìŠ¤í¬ë¡¤
                    if (filter !== 'all') {
                        document.getElementById(filter)?.scrollIntoView({ behavior: 'smooth' });
                    }
                });
            });

            // ì„¹ì…˜ ë Œë”ë§
            const sectionsContainer = document.getElementById('sectionsContainer');
            sectionsContainer.innerHTML = sections.map(section => `
                <section class="section" id="${section.id}">
                    <div class="section-header">
                        <div class="section-icon ${section.color}">${section.icon}</div>
                        <div>
                            <h2 class="section-title">${section.title} <span class="count" id="sectionCount-${section.id}">(${(data[section.id] || []).length})</span></h2>
                            <p class="section-subtitle">${section.subtitle}</p>
                        </div>
                        <button class="section-edit-btn" onclick="openSectionModal('${section.id}')">âš™ï¸</button>
                    </div>
                    <div class="portfolio-grid" id="grid-${section.id}">
                        <div class="add-card" onclick="openAddModal('${section.id}')">
                            <div class="add-card-icon">+</div>
                            <div class="add-card-text">ìƒˆ í•­ëª© ì¶”ê°€</div>
                        </div>
                    </div>
                </section>
            `).join('');
        }

        // ============ UI ë¡œì§ ============
        function checkSession() {
            isLoggedIn = sessionStorage.getItem('portfolio_session') === 'true';
            updateLoginUI();
        }

        async function setupPassword() {
            const pw = document.getElementById('setupPassword').value;
            const pwConfirm = document.getElementById('setupPasswordConfirm').value;
            const hint = document.getElementById('setupHint').value;
            const errorEl = document.getElementById('setupError');

            if (!pw || pw.length < 4) {
                errorEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.';
                errorEl.classList.add('show');
                return;
            }
            if (pw !== pwConfirm) {
                errorEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                errorEl.classList.add('show');
                return;
            }
            if (!hint) {
                errorEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ íŒíŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            await setAuth(pw, hint);
            isLoggedIn = true;
            sessionStorage.setItem('portfolio_session', 'true');
            closeModal('loginModal');
            updateLoginUI();
            updateUI();
            updateStorageInfo();
            alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤. í¸ì§‘ ëª¨ë“œê°€ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
        }

        async function login() {
            const pw = document.getElementById('loginPassword').value;
            const auth = await getAuth();
            const errorEl = document.getElementById('loginError');

            if (pw === auth?.password) {
                isLoggedIn = true;
                sessionStorage.setItem('portfolio_session', 'true');
                closeModal('loginModal');
                updateLoginUI();
                updateUI();
                updateStorageInfo();
            } else {
                errorEl.textContent = 'ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                errorEl.classList.add('show');
            }
        }

        function logout() {
            isLoggedIn = false;
            sessionStorage.removeItem('portfolio_session');
            updateLoginUI();
            updateUI();
            document.getElementById('storageInfo').classList.remove('show');
        }

        async function showForgotPassword() {
            const auth = await getAuth();
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('forgotForm').style.display = 'block';
            document.getElementById('hintDisplay').textContent = `íŒíŠ¸: "${auth?.hint || 'ì„¤ì •ëœ íŒíŠ¸ ì—†ìŒ'}"`;
        }

        function showLoginForm() {
            document.getElementById('forgotForm').style.display = 'none';
            document.getElementById('loginForm').style.display = 'block';
        }

        async function resetPassword() {
            const auth = await getAuth();
            const hintAnswer = document.getElementById('hintAnswer').value;
            const newPw = document.getElementById('newPassword').value;
            const errorEl = document.getElementById('forgotError');

            if (hintAnswer.toLowerCase() === auth?.hint?.toLowerCase()) {
                if (newPw.length >= 4) {
                    await setAuth(newPw, auth.hint);
                    alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¬ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.');
                    showLoginForm();
                    document.getElementById('loginPassword').value = '';
                } else {
                    errorEl.textContent = 'ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.';
                    errorEl.classList.add('show');
                }
            } else {
                errorEl.textContent = 'íŒíŠ¸ ë‹µë³€ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                errorEl.classList.add('show');
            }
        }

        async function changePassword() {
            const auth = await getAuth();
            const currentPw = document.getElementById('currentPw').value;
            const newPw = document.getElementById('newPw').value;
            const newHint = document.getElementById('newHint').value;
            const errorEl = document.getElementById('settingsError');

            if (currentPw !== auth?.password) {
                errorEl.textContent = 'í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                errorEl.classList.add('show');
                return;
            }

            const finalPw = newPw || auth.password;
            const finalHint = newHint || auth.hint;

            if (newPw && newPw.length < 4) {
                errorEl.textContent = 'ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.';
                errorEl.classList.add('show');
                return;
            }

            await setAuth(finalPw, finalHint);
            alert('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            closeModal('settingsModal');
        }

        async function updateLoginUI() {
            const auth = await getAuth();
            document.getElementById('loginBtn').style.display = isLoggedIn ? 'none' : 'block';
            document.getElementById('logoutBtn').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('settingsBtn').style.display = isLoggedIn ? 'block' : 'none';
            document.getElementById('loggedInStatus').style.display = isLoggedIn ? 'flex' : 'none';

            if (auth) {
                document.getElementById('loginSetupForm').style.display = 'none';
                document.getElementById('loginForm').style.display = 'block';
            } else {
                document.getElementById('loginSetupForm').style.display = 'block';
                document.getElementById('loginForm').style.display = 'none';
            }
        }

        function openModal(id) {
            document.getElementById(id).classList.add('active');
            document.querySelectorAll('.form-error').forEach(el => el.classList.remove('show'));
        }

        function closeModal(id) {
            document.getElementById(id).classList.remove('active');
            if (id === 'addModal') resetAddForm();
            if (id === 'editModal') resetEditForm();
        }

        function openAddModal(category) {
            if (!isLoggedIn) {
                alert('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                openModal('loginModal');
                return;
            }
            const titles = {
                documents: 'ğŸ“„ ìƒˆ ê¸°íšì„œ ì¶”ê°€',
                tools: 'ğŸ› ï¸ ìƒˆ ë„êµ¬ ì¶”ê°€',
                visuals: 'ğŸ¨ ìƒˆ ë¹„ì£¼ì–¼ ì¶”ê°€',
                projects: 'ğŸ“ ìƒˆ í”„ë¡œì íŠ¸ ì¶”ê°€'
            };
            document.getElementById('addModalTitle').textContent = titles[category] || 'ìƒˆ í•­ëª© ì¶”ê°€';
            document.getElementById('addCategory').value = category;
            currentTags = [];
            renderTags('tagsContainer', currentTags, 'current');
            openModal('addModal');
        }

        async function openEditModal(category, itemId) {
            if (!isLoggedIn) return;
            const data = await getAllMetadata();
            const item = data[category].find(i => i.id === itemId);
            if (!item) return;

            document.getElementById('editItemId').value = itemId;
            document.getElementById('editCategory').value = category;
            document.getElementById('editTitle').value = item.title;
            document.getElementById('editDesc').value = item.description;
            document.getElementById('editDate').value = item.date;
            editTags = [...(item.tags || [])];
            editThumbnailChanged = false;
            editThumbnailRemoved = false;
            
            // ê¸°ì¡´ ì¸ë„¤ì¼ ë¡œë“œ
            if (item.hasThumbnail) {
                const thumbnailData = await getFile(itemId + '_thumb');
                if (thumbnailData) {
                    editThumbnail = thumbnailData;
                    document.getElementById('editThumbnailPreviewImg').src = thumbnailData;
                    document.getElementById('editThumbnailPreviewImg').style.display = 'block';
                    document.getElementById('editThumbnailPlaceholder').style.display = 'none';
                    document.getElementById('editThumbnailRemoveBtn').style.display = 'flex';
                } else {
                    resetEditThumbnailUI();
                }
            } else {
                resetEditThumbnailUI();
            }
            
            renderTags('editTagsContainer', editTags, 'edit');
            openModal('editModal');
        }

        function resetEditThumbnailUI() {
            editThumbnail = null;
            document.getElementById('editThumbnailInput').value = '';
            document.getElementById('editThumbnailPreviewImg').style.display = 'none';
            document.getElementById('editThumbnailPlaceholder').style.display = 'flex';
            document.getElementById('editThumbnailRemoveBtn').style.display = 'none';
        }

        function resetAddForm() {
            document.getElementById('itemTitle').value = '';
            document.getElementById('itemDesc').value = '';
            document.getElementById('itemLink').value = '';
            document.getElementById('itemDate').value = '';
            document.getElementById('fileInput').value = '';
            selectedFile = null;
            selectedThumbnail = null;
            currentTags = [];
            document.getElementById('filePreview').classList.remove('show');
            document.getElementById('uploadProgress').classList.remove('show');
            document.getElementById('saveBtn').disabled = false;
            // ì¸ë„¤ì¼ ì´ˆê¸°í™”
            document.getElementById('thumbnailInput').value = '';
            document.getElementById('thumbnailPreviewImg').style.display = 'none';
            document.getElementById('thumbnailPlaceholder').style.display = 'flex';
            document.getElementById('thumbnailRemoveBtn').style.display = 'none';
            renderTags('tagsContainer', currentTags, 'current');
        }

        function resetEditForm() {
            editTags = [];
            editThumbnail = null;
            editThumbnailChanged = false;
            editThumbnailRemoved = false;
        }

        // íŒŒì¼ ì²˜ë¦¬
        function handleFileSelect(event) {
            if (event.target.files.length) handleFile(event.target.files[0]);
        }

        function handleFile(file) {
            if (file.size > MAX_FILE_SIZE) {
                alert(`íŒŒì¼ í¬ê¸°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. ìµœëŒ€ ${formatBytes(MAX_FILE_SIZE)}ê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.`);
                return;
            }

            selectedFile = file;
            const icon = getFileIcon(file.name);
            document.getElementById('filePreviewIcon').textContent = icon;
            document.getElementById('filePreviewName').textContent = file.name;
            document.getElementById('filePreviewSize').textContent = formatBytes(file.size);
            document.getElementById('filePreview').classList.add('show');

            generateKeywords(file);
        }

        function removeFile() {
            selectedFile = null;
            document.getElementById('fileInput').value = '';
            document.getElementById('filePreview').classList.remove('show');
        }

        // ì¸ë„¤ì¼ ì²˜ë¦¬ í•¨ìˆ˜ë“¤
        function handleThumbnailSelect(event) {
            if (event.target.files.length) {
                handleThumbnailFile(event.target.files[0], false);
            }
        }

        function handleEditThumbnailSelect(event) {
            if (event.target.files.length) {
                handleThumbnailFile(event.target.files[0], true);
            }
        }

        function handleThumbnailFile(file, isEdit) {
            if (!file.type.startsWith('image/')) {
                alert('ì´ë¯¸ì§€ íŒŒì¼ë§Œ ì—…ë¡œë“œ ê°€ëŠ¥í•©ë‹ˆë‹¤.');
                return;
            }

            if (file.size > MAX_THUMBNAIL_SIZE) {
                alert('ì¸ë„¤ì¼ ì´ë¯¸ì§€ëŠ” 5MB ì´í•˜ì—¬ì•¼ í•©ë‹ˆë‹¤.');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                if (isEdit) {
                    editThumbnail = e.target.result;
                    editThumbnailChanged = true;
                    editThumbnailRemoved = false;
                    document.getElementById('editThumbnailPreviewImg').src = e.target.result;
                    document.getElementById('editThumbnailPreviewImg').style.display = 'block';
                    document.getElementById('editThumbnailPlaceholder').style.display = 'none';
                    document.getElementById('editThumbnailRemoveBtn').style.display = 'flex';
                } else {
                    selectedThumbnail = e.target.result;
                    document.getElementById('thumbnailPreviewImg').src = e.target.result;
                    document.getElementById('thumbnailPreviewImg').style.display = 'block';
                    document.getElementById('thumbnailPlaceholder').style.display = 'none';
                    document.getElementById('thumbnailRemoveBtn').style.display = 'flex';
                }
            };
            reader.readAsDataURL(file);
        }

        function removeThumbnail() {
            selectedThumbnail = null;
            document.getElementById('thumbnailInput').value = '';
            document.getElementById('thumbnailPreviewImg').style.display = 'none';
            document.getElementById('thumbnailPlaceholder').style.display = 'flex';
            document.getElementById('thumbnailRemoveBtn').style.display = 'none';
        }

        function removeEditThumbnail() {
            editThumbnail = null;
            editThumbnailChanged = true;
            editThumbnailRemoved = true;
            document.getElementById('editThumbnailInput').value = '';
            document.getElementById('editThumbnailPreviewImg').style.display = 'none';
            document.getElementById('editThumbnailPlaceholder').style.display = 'flex';
            document.getElementById('editThumbnailRemoveBtn').style.display = 'none';
        }

        function getFileIcon(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            const icons = {
                pdf: 'ğŸ“‹', html: 'ğŸŒ', htm: 'ğŸŒ',
                png: 'ğŸ–¼ï¸', jpg: 'ğŸ–¼ï¸', jpeg: 'ğŸ–¼ï¸', gif: 'ğŸ–¼ï¸', webp: 'ğŸ–¼ï¸', svg: 'ğŸ–¼ï¸',
                mp4: 'ğŸ¬', mov: 'ğŸ¬', avi: 'ğŸ¬', webm: 'ğŸ¬',
                doc: 'ğŸ“', docx: 'ğŸ“', ppt: 'ğŸ“Š', pptx: 'ğŸ“Š', xls: 'ğŸ“ˆ', xlsx: 'ğŸ“ˆ'
            };
            return icons[ext] || 'ğŸ“„';
        }

        function getFileType(filename) {
            const ext = filename.split('.').pop().toLowerCase();
            if (['pdf'].includes(ext)) return 'pdf';
            if (['html', 'htm'].includes(ext)) return 'html';
            if (['png', 'jpg', 'jpeg', 'gif', 'webp', 'svg'].includes(ext)) return 'image';
            if (['mp4', 'mov', 'avi', 'webm'].includes(ext)) return 'video';
            return 'other';
        }

        function generateKeywords(file) {
            const filename = file.name.replace(/\.[^/.]+$/, '');
            const words = filename.split(/[-_\s]+/).filter(w => w.length > 1);
            const ext = file.name.split('.').pop().toLowerCase();

            const typeKeywords = {
                pdf: ['ë¬¸ì„œ', 'ê¸°íšì„œ'],
                html: ['ì›¹', 'ì¸í„°ë™í‹°ë¸Œ'],
                png: ['ì´ë¯¸ì§€'], jpg: ['ì´ë¯¸ì§€'], jpeg: ['ì´ë¯¸ì§€'], gif: ['ì´ë¯¸ì§€'],
                mp4: ['ì˜ìƒ'], mov: ['ì˜ìƒ'],
                pptx: ['í”„ë ˆì  í…Œì´ì…˜'], ppt: ['í”„ë ˆì  í…Œì´ì…˜'],
                xlsx: ['ìŠ¤í”„ë ˆë“œì‹œíŠ¸'], xls: ['ìŠ¤í”„ë ˆë“œì‹œíŠ¸']
            };

            const autoTags = [...words, ...(typeKeywords[ext] || [])];
            autoTags.forEach(tag => {
                if (tag && !currentTags.includes(tag)) {
                    currentTags.push(tag);
                }
            });
            renderTags('tagsContainer', currentTags, 'current');
        }

        // íƒœê·¸ ì²˜ë¦¬
        function addTag(containerId, inputId, type) {
            const input = document.getElementById(inputId);
            const tag = input.value.trim();
            const tags = type === 'current' ? currentTags : editTags;

            if (tag && !tags.includes(tag)) {
                tags.push(tag);
                renderTags(containerId, tags, type);
            }
            input.value = '';
        }

        function removeTag(index, type) {
            const tags = type === 'current' ? currentTags : editTags;
            const containerId = type === 'current' ? 'tagsContainer' : 'editTagsContainer';
            tags.splice(index, 1);
            renderTags(containerId, tags, type);
        }

        function renderTags(containerId, tags, type) {
            const container = document.getElementById(containerId);
            const inputId = type === 'current' ? 'tagInput' : 'editTagInput';
            container.innerHTML = tags.map((tag, i) => `
                <div class="tag-item">
                    <span>${tag}</span>
                    <button class="tag-remove" onclick="removeTag(${i}, '${type}')">Ã—</button>
                </div>
            `).join('') + `<input type="text" class="tag-input" id="${inputId}" placeholder="í‚¤ì›Œë“œ ì…ë ¥ í›„ Enter">`;

            document.getElementById(inputId).addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    addTag(containerId, inputId, type);
                }
            });
        }

        // í•­ëª© ì €ì¥
        async function saveItem() {
            const category = document.getElementById('addCategory').value;
            const title = document.getElementById('itemTitle').value.trim();
            const desc = document.getElementById('itemDesc').value.trim();
            const link = document.getElementById('itemLink').value.trim();
            const date = document.getElementById('itemDate').value;
            const errorEl = document.getElementById('addError');
            const saveBtn = document.getElementById('saveBtn');

            if (!title) {
                errorEl.textContent = 'ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            if (!selectedFile && !link) {
                errorEl.textContent = 'íŒŒì¼ì„ ì—…ë¡œë“œí•˜ê±°ë‚˜ ë§í¬ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            const itemId = Date.now().toString();
            const newItem = {
                id: itemId,
                category,
                title,
                description: desc,
                date: date || new Date().toISOString().slice(0, 7),
                tags: [...currentTags],
                link: link || null,
                fileType: selectedFile ? getFileType(selectedFile.name) : 'other',
                fileName: selectedFile ? selectedFile.name : null,
                hasFile: !!selectedFile,
                hasThumbnail: !!selectedThumbnail
            };

            saveBtn.disabled = true;

            try {
                // ì¸ë„¤ì¼ ì €ì¥
                if (selectedThumbnail) {
                    await saveFile(itemId + '_thumb', selectedThumbnail);
                }

                // íŒŒì¼ ì €ì¥
                if (selectedFile) {
                    document.getElementById('uploadProgress').classList.add('show');
                    const fileData = await readFileAsBase64(selectedFile);
                    await saveFile(itemId, fileData);
                }

                await saveMetadata(newItem);
                
                closeModal('addModal');
                await renderAllSections();
                updateUI();
                updateStorageInfo();
            } catch (error) {
                errorEl.textContent = 'íŒŒì¼ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
                errorEl.classList.add('show');
                saveBtn.disabled = false;
            }
        }

        function readFileAsBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onprogress = (e) => {
                    if (e.lengthComputable) {
                        const percent = Math.round((e.loaded / e.total) * 100);
                        document.getElementById('progressFill').style.width = percent + '%';
                        document.getElementById('progressText').textContent = `ì—…ë¡œë“œ ì¤‘... ${percent}%`;
                    }
                };

                reader.onload = () => resolve(reader.result);
                reader.onerror = () => reject(reader.error);
                reader.readAsDataURL(file);
            });
        }

        async function updateItem() {
            const itemId = document.getElementById('editItemId').value;
            const category = document.getElementById('editCategory').value;
            const title = document.getElementById('editTitle').value.trim();
            const desc = document.getElementById('editDesc').value.trim();
            const date = document.getElementById('editDate').value;
            const errorEl = document.getElementById('editError');

            if (!title) {
                errorEl.textContent = 'ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
                errorEl.classList.add('show');
                return;
            }

            const data = await getAllMetadata();
            const item = data[category].find(i => i.id === itemId);
            if (item) {
                item.title = title;
                item.description = desc;
                item.date = date;
                item.tags = [...editTags];

                // ì¸ë„¤ì¼ ì—…ë°ì´íŠ¸
                if (editThumbnailChanged) {
                    if (editThumbnailRemoved) {
                        // ì¸ë„¤ì¼ ì‚­ì œ
                        await deleteFile(itemId + '_thumb');
                        item.hasThumbnail = false;
                    } else if (editThumbnail) {
                        // ìƒˆ ì¸ë„¤ì¼ ì €ì¥
                        await saveFile(itemId + '_thumb', editThumbnail);
                        item.hasThumbnail = true;
                    }
                }

                await saveMetadata(item);
            }

            closeModal('editModal');
            await renderAllSections();
            updateStorageInfo();
        }

        async function deleteItem() {
            if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;

            const itemId = document.getElementById('editItemId').value;
            
            await deleteMetadata(itemId);
            await deleteFile(itemId);
            await deleteFile(itemId + '_thumb'); // ì¸ë„¤ì¼ë„ ì‚­ì œ
            
            closeModal('editModal');
            await renderAllSections();
            updateUI();
            updateStorageInfo();
        }

        // ============ ì„¹ì…˜ í•„í„°ë§ ============
        function setFilter(filter) {
            currentFilter = filter;
            updateSectionVisibility();
            updateNavTabsActive();
        }
        
        function updateSectionVisibility() {
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                if (currentFilter === 'all') {
                    section.style.display = 'block';
                } else {
                    section.style.display = section.id === currentFilter ? 'block' : 'none';
                }
            });
            
            // ì„¹ì…˜ ì¶”ê°€ ë²„íŠ¼: ë¡œê·¸ì¸ + ì „ì²´ ë³´ê¸° ì‹œì—ë§Œ í‘œì‹œ
            const addSectionBtn = document.getElementById('addSectionBtn');
            if (addSectionBtn) {
                const shouldShow = currentFilter === 'all' && isLoggedIn;
                addSectionBtn.classList.toggle('show', shouldShow);
            }
        }
        
        function updateNavTabsActive() {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                const tabFilter = tab.dataset.filter;
                tab.classList.toggle('active', tabFilter === currentFilter);
            });
        }

        // ============ ë“œë˜ê·¸ì•¤ë“œë¡­ ìˆœì„œ ë³€ê²½ ============
        function setupDragAndDrop(card, category, itemId) {
            card.setAttribute('draggable', 'true');
            
            card.addEventListener('dragstart', (e) => {
                if (!isLoggedIn) {
                    e.preventDefault();
                    return;
                }
                draggedItem = { element: card, category, itemId };
                card.classList.add('dragging');
                e.dataTransfer.effectAllowed = 'move';
            });
            
            card.addEventListener('dragend', () => {
                card.classList.remove('dragging');
                document.querySelectorAll('.portfolio-card').forEach(c => c.classList.remove('drag-over'));
                draggedItem = null;
            });
            
            card.addEventListener('dragover', (e) => {
                e.preventDefault();
                if (!draggedItem || draggedItem.element === card) return;
                if (draggedItem.category !== category) return;
                card.classList.add('drag-over');
            });
            
            card.addEventListener('dragleave', () => {
                card.classList.remove('drag-over');
            });
            
            card.addEventListener('drop', async (e) => {
                e.preventDefault();
                card.classList.remove('drag-over');
                
                if (!draggedItem || draggedItem.element === card) return;
                if (draggedItem.category !== category) return;
                
                // ìˆœì„œ ë³€ê²½
                const grid = document.getElementById(`grid-${category}`);
                const cards = Array.from(grid.querySelectorAll('.portfolio-card'));
                const draggedIndex = cards.indexOf(draggedItem.element);
                const dropIndex = cards.indexOf(card);
                
                if (draggedIndex < dropIndex) {
                    card.after(draggedItem.element);
                } else {
                    card.before(draggedItem.element);
                }
                
                // ìƒˆ ìˆœì„œ ì €ì¥
                await saveNewOrder(category);
            });
        }
        
        async function saveNewOrder(category) {
            const grid = document.getElementById(`grid-${category}`);
            const cards = Array.from(grid.querySelectorAll('.portfolio-card'));
            const data = await getAllMetadata();
            const items = data[category] || [];
            
            for (let i = 0; i < cards.length; i++) {
                const itemId = cards[i].dataset.itemId;
                const item = items.find(it => it.id === itemId);
                if (item) {
                    item.order = i;
                    await saveMetadata(item);
                }
            }
        }

        // ë Œë”ë§
        async function renderAllSections() {
            const sections = await getSections();
            const data = await getAllMetadata();
            
            sections.forEach(section => {
                renderSection(section.id, data[section.id] || []);
            });
            
            // í•„í„° ìƒíƒœì— ë”°ë¼ ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€
            updateSectionVisibility();
        }

        function renderSection(category, items) {
            const grid = document.getElementById(`grid-${category}`);
            if (!grid) return;
            
            const addCard = grid.querySelector('.add-card');

            grid.querySelectorAll('.portfolio-card').forEach(card => card.remove());

            // order ê¸°ì¤€ ì •ë ¬
            items.sort((a, b) => (a.order || 0) - (b.order || 0));

            items.forEach(item => {
                const card = createCard(item, category);
                grid.insertBefore(card, addCard);
            });

            const countEl = document.getElementById(`sectionCount-${category}`);
            if (countEl) countEl.textContent = `(${items.length})`;
            
            const navCountEl = document.getElementById(`navCount-${category}`);
            if (navCountEl) navCountEl.textContent = items.length;
        }

        function createCard(item, category) {
            const card = document.createElement('div');
            card.className = 'portfolio-card';
            card.dataset.itemId = item.id;
            card.dataset.hasThumbnail = item.hasThumbnail ? 'true' : 'false';
            
            card.innerHTML = `
                <div class="drag-handle ${isLoggedIn ? 'show' : ''}" title="ë“œë˜ê·¸í•˜ì—¬ ìˆœì„œ ë³€ê²½">â‹®â‹®</div>
                <button class="card-edit-btn ${isLoggedIn ? 'show' : ''}" onclick="event.stopPropagation(); openEditModal('${category}', '${item.id}')">âš™ï¸</button>
                <div class="card-link" onclick="openItem('${item.id}', '${item.link || ''}', ${item.hasFile})">
                    <div class="card-thumbnail ${item.fileType}" id="thumb-${item.id}">
                        <span class="thumb-icon">${getFileIcon(item.fileName || 'file.other')}</span>
                        <span class="card-badge ${item.fileType}">${item.fileType.toUpperCase()}</span>
                    </div>
                    <div class="card-content">
                        <h3 class="card-title">${item.title}</h3>
                        <p class="card-description">${item.description || 'ì„¤ëª… ì—†ìŒ'}</p>
                        <div class="card-meta">
                            <span class="card-date">${item.date}</span>
                            <div class="card-tags">
                                ${(item.tags || []).slice(0, 3).map(t => `<span class="card-tag">${t}</span>`).join('')}
                            </div>
                        </div>
                    </div>
                </div>
            `;

            // ì¸ë„¤ì¼ì´ ìˆìœ¼ë©´ ë¹„ë™ê¸°ë¡œ ë¡œë“œ
            if (item.hasThumbnail) {
                loadCardThumbnail(item.id);
            }
            
            // ë“œë˜ê·¸ì•¤ë“œë¡­ ì„¤ì •
            setupDragAndDrop(card, category, item.id);

            return card;
        }

        async function loadCardThumbnail(itemId) {
            const thumbnailData = await getFile(itemId + '_thumb');
            if (thumbnailData) {
                const thumbContainer = document.getElementById(`thumb-${itemId}`);
                if (thumbContainer) {
                    const icon = thumbContainer.querySelector('.thumb-icon');
                    if (icon) icon.style.display = 'none';
                    
                    const img = document.createElement('img');
                    img.src = thumbnailData;
                    img.style.cssText = 'width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0;';
                    thumbContainer.style.position = 'relative';
                    thumbContainer.insertBefore(img, thumbContainer.firstChild);
                }
            }
        }

        async function openItem(id, link, hasFile) {
            if (link) {
                window.open(link, '_blank');
            } else if (hasFile) {
                const fileData = await getFile(id);
                if (fileData) {
                    // Data URIë¥¼ Blobìœ¼ë¡œ ë³€í™˜
                    const blob = dataURItoBlob(fileData);
                    const blobURL = URL.createObjectURL(blob);
                    
                    // Blob URLë¡œ ìƒˆ ì°½ì—ì„œ ì—´ê¸°
                    window.open(blobURL, '_blank');
                    
                    // ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€ë¥¼ ìœ„í•´ ì¼ì • ì‹œê°„ í›„ URL í•´ì œ
                    setTimeout(() => URL.revokeObjectURL(blobURL), 60000);
                }
            }
        }

        // Data URIë¥¼ Blobìœ¼ë¡œ ë³€í™˜í•˜ëŠ” í•¨ìˆ˜
        function dataURItoBlob(dataURI) {
            // Data URI íŒŒì‹±
            const byteString = atob(dataURI.split(',')[1]);
            const mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
            
            // ArrayBuffer ìƒì„±
            const ab = new ArrayBuffer(byteString.length);
            const ia = new Uint8Array(ab);
            
            for (let i = 0; i < byteString.length; i++) {
                ia[i] = byteString.charCodeAt(i);
            }
            
            return new Blob([ab], { type: mimeString });
        }

        function updateUI() {
            // ì¶”ê°€ ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
            document.querySelectorAll('.add-card').forEach(card => {
                card.classList.toggle('show', isLoggedIn);
            });

            // ìˆ˜ì • ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
            document.querySelectorAll('.card-edit-btn').forEach(btn => {
                btn.classList.toggle('show', isLoggedIn);
            });

            // ë“œë˜ê·¸ í•¸ë“¤ í‘œì‹œ/ìˆ¨ê¹€
            document.querySelectorAll('.drag-handle').forEach(handle => {
                handle.classList.toggle('show', isLoggedIn);
            });

            // ì„¹ì…˜ ìˆ˜ì • ë²„íŠ¼ í‘œì‹œ/ìˆ¨ê¹€
            document.querySelectorAll('.section-edit-btn').forEach(btn => {
                btn.classList.toggle('show', isLoggedIn);
            });

            // ì„¹ì…˜ ì¶”ê°€ ë²„íŠ¼ì€ updateSectionVisibilityì—ì„œ ì²˜ë¦¬
            updateSectionVisibility();

            // í”„ë¡œí•„ ì´ë¯¸ì§€ í¸ì§‘ ê°€ëŠ¥ í‘œì‹œ
            const profileImage = document.getElementById('profileImage');
            if (profileImage) profileImage.classList.toggle('editable', isLoggedIn);

            // ìê¸°ì†Œê°œ í¸ì§‘ ê°€ëŠ¥ í‘œì‹œ
            const introText = document.getElementById('introText');
            if (introText) introText.classList.toggle('editable', isLoggedIn);
        }

        function setupEventListeners() {
            document.getElementById('tagInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') { e.preventDefault(); addTag('tagsContainer', 'tagInput', 'current'); }
            });
            document.getElementById('editTagInput').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') { e.preventDefault(); addTag('editTagsContainer', 'editTagInput', 'edit'); }
            });

            const uploadArea = document.getElementById('fileUploadArea');
            uploadArea.addEventListener('dragover', (e) => { e.preventDefault(); uploadArea.classList.add('dragover'); });
            uploadArea.addEventListener('dragleave', () => uploadArea.classList.remove('dragover'));
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('dragover');
                if (e.dataTransfer.files.length) handleFile(e.dataTransfer.files[0]);
            });

            document.getElementById('loginPassword').addEventListener('keydown', (e) => {
                if (e.key === 'Enter') login();
            });

            // í”„ë¡œí•„ ì´ë¯¸ì§€ í´ë¦­
            document.getElementById('profileImage').addEventListener('click', () => {
                if (isLoggedIn) openProfileModal();
            });

            // ìê¸°ì†Œê°œ í´ë¦­
            document.getElementById('introText').addEventListener('click', () => {
                if (isLoggedIn) openIntroModal();
            });
        }

        // ============ ë°±ì—…/ë³µì› ê¸°ëŠ¥ ============
        
        // ëª¨ë“  ë°ì´í„°ë¥¼ JSONìœ¼ë¡œ ë‚´ë³´ë‚´ê¸°
        async function exportAllData() {
            try {
                showBackupStatus('ë°ì´í„° ìˆ˜ì§‘ ì¤‘...', 'info');
                
                const exportData = {
                    version: '1.0',
                    exportDate: new Date().toISOString(),
                    auth: await getAuth(),
                    profile: await getProfile(),
                    intro: await getIntro(),
                    sections: await getSections(),
                    metadata: await getAllMetadataRaw(),
                    files: await getAllFiles()
                };
                
                const jsonString = JSON.stringify(exportData, null, 2);
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `portfolio_backup_${new Date().toISOString().split('T')[0]}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showBackupStatus('âœ… ë°±ì—… íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
            } catch (error) {
                console.error('Export error:', error);
                showBackupStatus('âŒ ë°±ì—… ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        }
        
        // ë©”íƒ€ë°ì´í„° ì§ì ‘ ê°€ì ¸ì˜¤ê¸° (raw)
        async function getAllMetadataRaw() {
            return new Promise((resolve) => {
                const store = getStore(STORES.META);
                const request = store.getAll();
                request.onsuccess = () => resolve(request.result || []);
                request.onerror = () => resolve([]);
            });
        }
        
        // ëª¨ë“  íŒŒì¼ ê°€ì ¸ì˜¤ê¸°
        async function getAllFiles() {
            return new Promise((resolve) => {
                const store = getStore(STORES.FILES);
                const request = store.getAll();
                request.onsuccess = () => resolve(request.result || []);
                request.onerror = () => resolve([]);
            });
        }
        
        // JSONì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function importAllData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            try {
                showBackupStatus('íŒŒì¼ ì½ëŠ” ì¤‘...', 'info');
                
                const text = await file.text();
                const data = JSON.parse(text);
                
                if (!data.version) {
                    throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ë°±ì—… íŒŒì¼ì…ë‹ˆë‹¤.');
                }
                
                const confirmMsg = `ì´ ì‘ì—…ì€ í˜„ì¬ ë°ì´í„°ë¥¼ ëª¨ë‘ ë®ì–´ì”ë‹ˆë‹¤.\n\në°±ì—… ë‚ ì§œ: ${data.exportDate}\n\nê³„ì†í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`;
                if (!confirm(confirmMsg)) {
                    showBackupStatus('ë³µì›ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'info');
                    event.target.value = '';
                    return;
                }
                
                showBackupStatus('ë°ì´í„° ë³µì› ì¤‘...', 'info');
                
                // ì¸ì¦ ì •ë³´ ë³µì›
                if (data.auth) {
                    await setAuth(data.auth.password, data.auth.hint);
                }
                
                // í”„ë¡œí•„ ë³µì›
                if (data.profile) {
                    await saveProfileData(data.profile);
                }
                
                // ìê¸°ì†Œê°œ ë³µì›
                if (data.intro) {
                    await saveIntroData(data.intro);
                }
                
                // ì„¹ì…˜ ë³µì›
                if (data.sections && data.sections.length > 0) {
                    // ê¸°ì¡´ ì„¹ì…˜ ì‚­ì œ
                    const existingSections = await getSections();
                    for (const section of existingSections) {
                        await deleteSectionData(section.id);
                    }
                    // ìƒˆ ì„¹ì…˜ ì €ì¥
                    for (const section of data.sections) {
                        await saveSectionData(section);
                    }
                }
                
                // ë©”íƒ€ë°ì´í„° ë³µì›
                if (data.metadata && data.metadata.length > 0) {
                    for (const item of data.metadata) {
                        await saveMetadata(item);
                    }
                }
                
                // íŒŒì¼ ë³µì›
                if (data.files && data.files.length > 0) {
                    for (const file of data.files) {
                        await saveFile(file.id, file.data);
                    }
                }
                
                showBackupStatus('âœ… ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤! í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤...', 'success');
                
                setTimeout(() => {
                    location.reload();
                }, 1500);
                
            } catch (error) {
                console.error('Import error:', error);
                showBackupStatus('âŒ ë³µì› ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
            
            event.target.value = '';
        }
        
        // ë°ì´í„°ê°€ í¬í•¨ëœ ë…ë¦½í˜• HTML ë‹¤ìš´ë¡œë“œ
        async function downloadStandaloneHTML() {
            try {
                showBackupStatus('HTML íŒŒì¼ ìƒì„± ì¤‘... (ëŒ€ìš©ëŸ‰ íŒŒì¼ì€ ì‹œê°„ì´ ê±¸ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤)', 'info');
                
                // í˜„ì¬ í˜ì´ì§€ì˜ HTML ê°€ì ¸ì˜¤ê¸°
                let htmlContent = document.documentElement.outerHTML;
                
                // ë°ì´í„° ìˆ˜ì§‘
                const exportData = {
                    version: '1.0',
                    exportDate: new Date().toISOString(),
                    auth: await getAuth(),
                    profile: await getProfile(),
                    intro: await getIntro(),
                    sections: await getSections(),
                    metadata: await getAllMetadataRaw(),
                    files: await getAllFiles()
                };
                
                // ì´ˆê¸°í™” ë°ì´í„°ë¥¼ ì‚½ì…í•  ìŠ¤í¬ë¦½íŠ¸ ìƒì„± (ë¬¸ìì—´ ì—°ê²° ë°©ì‹)
                const scriptOpen = '<' + 'script>';
                const scriptClose = '</' + 'script>';
                const bodyClose = '</' + 'body>';
                
                const initDataScript = '\n' + scriptOpen + '\n' +
                    '// ì„ë² ë”©ëœ ì´ˆê¸° ë°ì´í„° (ìë™ ìƒì„±ë¨)\n' +
                    'const EMBEDDED_DATA = ' + JSON.stringify(exportData) + ';\n\n' +
                    '// IndexedDB ì´ˆê¸°í™” ì‹œ ì„ë² ë”©ëœ ë°ì´í„° ë¡œë“œ\n' +
                    'const originalInitDB = initDB;\n' +
                    'initDB = async function() {\n' +
                    '    await originalInitDB();\n' +
                    '    const existingAuth = await getAuth();\n' +
                    '    if (!existingAuth && EMBEDDED_DATA.auth) {\n' +
                    '        console.log("Loading embedded data...");\n' +
                    '        if (EMBEDDED_DATA.auth) { await setAuth(EMBEDDED_DATA.auth.password, EMBEDDED_DATA.auth.hint); }\n' +
                    '        if (EMBEDDED_DATA.profile) { await saveProfileData(EMBEDDED_DATA.profile); }\n' +
                    '        if (EMBEDDED_DATA.intro) { await saveIntroData(EMBEDDED_DATA.intro); }\n' +
                    '        if (EMBEDDED_DATA.sections) { for (const s of EMBEDDED_DATA.sections) { await saveSectionData(s); } }\n' +
                    '        if (EMBEDDED_DATA.metadata) { for (const m of EMBEDDED_DATA.metadata) { await saveMetadata(m); } }\n' +
                    '        if (EMBEDDED_DATA.files) { for (const f of EMBEDDED_DATA.files) { await saveFile(f.id, f.data); } }\n' +
                    '        console.log("Embedded data loaded successfully!");\n' +
                    '    }\n' +
                    '};\n' +
                    scriptClose + '\n' + bodyClose;
                
                // </body> íƒœê·¸ ì•ì— ìŠ¤í¬ë¦½íŠ¸ ì‚½ì…
                htmlContent = htmlContent.replace(/<\/body>/i, initDataScript);
                
                // DOCTYPE ì¶”ê°€
                const fullHTML = '<!DOCTYPE html>\n' + htmlContent;
                
                // íŒŒì¼ ë‹¤ìš´ë¡œë“œ
                const blob = new Blob([fullHTML], { type: 'text/html;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = 'portfolio_standalone_' + new Date().toISOString().split('T')[0] + '.html';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                showBackupStatus('âœ… ë…ë¦½í˜• HTMLì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤! ì´ íŒŒì¼ì„ Netlifyì— ì—…ë¡œë“œí•˜ì„¸ìš”.', 'success');
                
            } catch (error) {
                console.error('HTML export error:', error);
                showBackupStatus('âŒ HTML ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message, 'error');
            }
        }
        
        // ë°±ì—… ìƒíƒœ í‘œì‹œ
        function showBackupStatus(message, type) {
            const statusEl = document.getElementById('backupStatus');
            statusEl.style.display = 'block';
            statusEl.textContent = message;
            
            switch(type) {
                case 'success':
                    statusEl.style.background = 'var(--pastel-green-light)';
                    statusEl.style.color = 'var(--pastel-green-dark)';
                    statusEl.style.border = '1px solid var(--pastel-green)';
                    break;
                case 'error':
                    statusEl.style.background = 'var(--pastel-red-light)';
                    statusEl.style.color = 'var(--pastel-red-dark)';
                    statusEl.style.border = '1px solid var(--pastel-red)';
                    break;
                default:
                    statusEl.style.background = 'var(--pastel-blue-light)';
                    statusEl.style.color = 'var(--pastel-blue-dark)';
                    statusEl.style.border = '1px solid var(--pastel-blue)';
            }
        }

        // ì´ˆê¸°í™”
        async function init() {
            await initDB();
            checkSession();
            await loadProfile();
            await loadIntro();
            await renderSectionsAndNav();
            await renderAllSections();
            setupEventListeners();
            updateUI();
            updateStorageInfo();
        }

        async function updateStorageInfo() {
            if (!isLoggedIn) return;
            
            try {
                const estimate = await navigator.storage.estimate();
                const usedMB = (estimate.usage / (1024 * 1024)).toFixed(2);
                document.getElementById('storageUsed').textContent = usedMB + ' MB';
                document.getElementById('storageInfo').classList.add('show');
            } catch (e) {
                console.log('Storage estimate not supported');
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>